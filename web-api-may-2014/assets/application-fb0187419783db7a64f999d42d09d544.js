/*!
 * jQuery JavaScript Library v1.10.0
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-05-24T18:39Z
 */
!function(e,t){function n(e){var t=e.length,n=dt.type(e);return dt.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function i(e){var t=_t[e]={};return dt.each(e.match(ht)||[],function(e,n){t[n]=!0}),t}function s(e,n,i,s){if(dt.acceptData(e)){var o,a,r=dt.expando,l=e.nodeType,c=l?dt.cache:e,d=l?e[r]:e[r]&&r;if(d&&c[d]&&(s||c[d].data)||i!==t||"string"!=typeof n)return d||(d=l?e[r]=tt.pop()||dt.guid++:r),c[d]||(c[d]=l?{}:{toJSON:dt.noop}),("object"==typeof n||"function"==typeof n)&&(s?c[d]=dt.extend(c[d],n):c[d].data=dt.extend(c[d].data,n)),a=c[d],s||(a.data||(a.data={}),a=a.data),i!==t&&(a[dt.camelCase(n)]=i),"string"==typeof n?(o=a[n],null==o&&(o=a[dt.camelCase(n)])):o=a,o}}function o(e,t,n){if(dt.acceptData(e)){var i,s,o=e.nodeType,a=o?dt.cache:e,l=o?e[dt.expando]:dt.expando;if(a[l]){if(t&&(i=n?a[l]:a[l].data)){dt.isArray(t)?t=t.concat(dt.map(t,dt.camelCase)):t in i?t=[t]:(t=dt.camelCase(t),t=t in i?[t]:t.split(" ")),s=t.length;for(;s--;)delete i[t[s]];if(n?!r(i):!dt.isEmptyObject(i))return}(n||(delete a[l].data,r(a[l])))&&(o?dt.cleanData([e],!0):dt.support.deleteExpando||a!=a.window?delete a[l]:a[l]=null)}}}function a(e,n,i){if(i===t&&1===e.nodeType){var s="data-"+n.replace(Ct,"-$1").toLowerCase();if(i=e.getAttribute(s),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:Lt.test(i)?dt.parseJSON(i):i}catch(o){}dt.data(e,n,i)}else i=t}return i}function r(e){var t;for(t in e)if(("data"!==t||!dt.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function l(){return!0}function c(){return!1}function d(){try{return K.activeElement}catch(e){}}function u(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function h(e,t,n){if(dt.isFunction(t))return dt.grep(e,function(e,i){return!!t.call(e,i,e)!==n});if(t.nodeType)return dt.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(jt.test(t))return dt.filter(t,e,n);t=dt.filter(t,e)}return dt.grep(e,function(e){return dt.inArray(e,t)>=0!==n})}function p(e){var t=Yt.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}function f(e,t){return dt.nodeName(e,"table")&&dt.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function m(e){return e.type=(null!==dt.find.attr(e,"type"))+"/"+e.type,e}function g(e){var t=on.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function v(e,t){for(var n,i=0;null!=(n=e[i]);i++)dt._data(n,"globalEval",!t||dt._data(t[i],"globalEval"))}function y(e,t){if(1===t.nodeType&&dt.hasData(e)){var n,i,s,o=dt._data(e),a=dt._data(t,o),r=o.events;if(r){delete a.handle,a.events={};for(n in r)for(i=0,s=r[n].length;s>i;i++)dt.event.add(t,n,r[n][i])}a.data&&(a.data=dt.extend({},a.data))}}function b(e,t){var n,i,s;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!dt.support.noCloneEvent&&t[dt.expando]){s=dt._data(t);for(i in s.events)dt.removeEvent(t,i,s.handle);t.removeAttribute(dt.expando)}"script"===n&&t.text!==e.text?(m(t).text=e.text,g(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),dt.support.html5Clone&&e.innerHTML&&!dt.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&tn.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}function S(e,n){var i,s,o=0,a=typeof e.getElementsByTagName!==G?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==G?e.querySelectorAll(n||"*"):t;if(!a)for(a=[],i=e.childNodes||e;null!=(s=i[o]);o++)!n||dt.nodeName(s,n)?a.push(s):dt.merge(a,S(s,n));return n===t||n&&dt.nodeName(e,n)?dt.merge([e],a):a}function E(e){tn.test(e.type)&&(e.defaultChecked=e.checked)}function k(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),i=t,s=_n.length;s--;)if(t=_n[s]+n,t in e)return t;return i}function T(e,t){return e=t||e,"none"===dt.css(e,"display")||!dt.contains(e.ownerDocument,e)}function w(e,t){for(var n,i,s,o=[],a=0,r=e.length;r>a;a++)i=e[a],i.style&&(o[a]=dt._data(i,"olddisplay"),n=i.style.display,t?(o[a]||"none"!==n||(i.style.display=""),""===i.style.display&&T(i)&&(o[a]=dt._data(i,"olddisplay",I(i.nodeName)))):o[a]||(s=T(i),(n&&"none"!==n||!s)&&dt._data(i,"olddisplay",s?n:dt.css(i,"display"))));for(a=0;r>a;a++)i=e[a],i.style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?o[a]||"":"none"));return e}function _(e,t,n){var i=yn.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function L(e,t,n,i,s){for(var o=n===(i?"border":"content")?4:"width"===t?1:0,a=0;4>o;o+=2)"margin"===n&&(a+=dt.css(e,n+wn[o],!0,s)),i?("content"===n&&(a-=dt.css(e,"padding"+wn[o],!0,s)),"margin"!==n&&(a-=dt.css(e,"border"+wn[o]+"Width",!0,s))):(a+=dt.css(e,"padding"+wn[o],!0,s),"padding"!==n&&(a+=dt.css(e,"border"+wn[o]+"Width",!0,s)));return a}function C(e,t,n){var i=!0,s="width"===t?e.offsetWidth:e.offsetHeight,o=un(e),a=dt.support.boxSizing&&"border-box"===dt.css(e,"boxSizing",!1,o);if(0>=s||null==s){if(s=hn(e,t,o),(0>s||null==s)&&(s=e.style[t]),bn.test(s))return s;i=a&&(dt.support.boxSizingReliable||s===e.style[t]),s=parseFloat(s)||0}return s+L(e,t,n||(a?"border":"content"),i,o)+"px"}function I(e){var t=K,n=En[e];return n||(n=x(e,t),"none"!==n&&n||(dn=(dn||dt("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(dn[0].contentWindow||dn[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=x(e,t),dn.detach()),En[e]=n),n}function x(e,t){var n=dt(t.createElement(e)).appendTo(t.body),i=dt.css(n[0],"display");return n.remove(),i}function A(e,t,n,i){var s;if(dt.isArray(t))dt.each(t,function(t,s){n||Cn.test(e)?i(e,s):A(e+"["+("object"==typeof s?t:"")+"]",s,n,i)});else if(n||"object"!==dt.type(t))i(e,t);else for(s in t)A(e+"["+s+"]",t[s],n,i)}function D(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,s=0,o=t.toLowerCase().match(ht)||[];if(dt.isFunction(n))for(;i=o[s++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function R(e,t,n,i){function s(r){var l;return o[r]=!0,dt.each(e[r]||[],function(e,r){var c=r(t,n,i);return"string"!=typeof c||a||o[c]?a?!(l=c):void 0:(t.dataTypes.unshift(c),s(c),!1)}),l}var o={},a=e===zn;return s(t.dataTypes[0])||!o["*"]&&s("*")}function O(e,n){var i,s,o=dt.ajaxSettings.flatOptions||{};for(s in n)n[s]!==t&&((o[s]?e:i||(i={}))[s]=n[s]);return i&&dt.extend(!0,e,i),e}function N(e,n,i){for(var s,o,a,r,l=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),o===t&&(o=e.mimeType||n.getResponseHeader("Content-Type"));if(o)for(r in l)if(l[r]&&l[r].test(o)){c.unshift(r);break}if(c[0]in i)a=c[0];else{for(r in i){if(!c[0]||e.converters[r+" "+c[0]]){a=r;break}s||(s=r)}a=a||s}return a?(a!==c[0]&&c.unshift(a),i[a]):void 0}function M(e,t,n,i){var s,o,a,r,l,c={},d=e.dataTypes.slice();if(d[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(o=d.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=d.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(a=c[l+" "+o]||c["* "+o],!a)for(s in c)if(r=s.split(" "),r[1]===o&&(a=c[l+" "+r[0]]||c["* "+r[0]])){a===!0?a=c[s]:c[s]!==!0&&(o=r[0],d.unshift(r[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(u){return{state:"parsererror",error:a?u:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}function P(){try{return new e.XMLHttpRequest}catch(t){}}function $(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function B(){return setTimeout(function(){Qn=t}),Qn=dt.now()}function H(e,t,n){for(var i,s=(oi[t]||[]).concat(oi["*"]),o=0,a=s.length;a>o;o++)if(i=s[o].call(n,t,e))return i}function F(e,t,n){var i,s,o=0,a=si.length,r=dt.Deferred().always(function(){delete l.elem}),l=function(){if(s)return!1;for(var t=Qn||B(),n=Math.max(0,c.startTime+c.duration-t),i=n/c.duration||0,o=1-i,a=0,l=c.tweens.length;l>a;a++)c.tweens[a].run(o);return r.notifyWith(e,[c,o,n]),1>o&&l?n:(r.resolveWith(e,[c]),!1)},c=r.promise({elem:e,props:dt.extend({},t),opts:dt.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Qn||B(),duration:n.duration,tweens:[],createTween:function(t,n){var i=dt.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var n=0,i=t?c.tweens.length:0;if(s)return this;for(s=!0;i>n;n++)c.tweens[n].run(1);return t?r.resolveWith(e,[c,t]):r.rejectWith(e,[c,t]),this}}),d=c.props;for(U(d,c.opts.specialEasing);a>o;o++)if(i=si[o].call(c,e,d,c.opts))return i;return dt.map(d,H,c),dt.isFunction(c.opts.start)&&c.opts.start.call(e,c),dt.fx.timer(dt.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function U(e,t){var n,i,s,o,a;for(n in e)if(i=dt.camelCase(n),s=t[i],o=e[n],dt.isArray(o)&&(s=o[1],o=e[n]=o[0]),n!==i&&(e[i]=o,delete e[n]),a=dt.cssHooks[i],a&&"expand"in a){o=a.expand(o),delete e[i];for(n in o)n in e||(e[n]=o[n],t[n]=s)}else t[i]=s}function j(e,t,n){var i,s,o,a,r,l,c=this,d={},u=e.style,h=e.nodeType&&T(e),p=dt._data(e,"fxshow");n.queue||(r=dt._queueHooks(e,"fx"),null==r.unqueued&&(r.unqueued=0,l=r.empty.fire,r.empty.fire=function(){r.unqueued||l()}),r.unqueued++,c.always(function(){c.always(function(){r.unqueued--,dt.queue(e,"fx").length||r.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[u.overflow,u.overflowX,u.overflowY],"inline"===dt.css(e,"display")&&"none"===dt.css(e,"float")&&(dt.support.inlineBlockNeedsLayout&&"inline"!==I(e.nodeName)?u.zoom=1:u.display="inline-block")),n.overflow&&(u.overflow="hidden",dt.support.shrinkWrapBlocks||c.always(function(){u.overflow=n.overflow[0],u.overflowX=n.overflow[1],u.overflowY=n.overflow[2]}));for(i in t)if(s=t[i],ti.exec(s)){if(delete t[i],o=o||"toggle"===s,s===(h?"hide":"show"))continue;d[i]=p&&p[i]||dt.style(e,i)}if(!dt.isEmptyObject(d)){p?"hidden"in p&&(h=p.hidden):p=dt._data(e,"fxshow",{}),o&&(p.hidden=!h),h?dt(e).show():c.done(function(){dt(e).hide()}),c.done(function(){var t;dt._removeData(e,"fxshow");for(t in d)dt.style(e,t,d[t])});for(i in d)a=H(h?p[i]:0,i,c),i in p||(p[i]=a.start,h&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}}function V(e,t,n,i,s){return new V.prototype.init(e,t,n,i,s)}function z(e,t){var n,i={height:e},s=0;for(t=t?1:0;4>s;s+=2-t)n=wn[s],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function W(e){return dt.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var Y,X,G=typeof t,J=e.location,K=e.document,q=K.documentElement,Z=e.jQuery,Q=e.$,et={},tt=[],nt="1.10.0",it=tt.concat,st=tt.push,ot=tt.slice,at=tt.indexOf,rt=et.toString,lt=et.hasOwnProperty,ct=nt.trim,dt=function(e,t){return new dt.fn.init(e,t,X)},ut=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ht=/\S+/g,pt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ft=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,mt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,gt=/^[\],:{}\s]*$/,vt=/(?:^|:|,)(?:\s*\[)+/g,yt=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,bt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,St=/^-ms-/,Et=/-([\da-z])/gi,kt=function(e,t){return t.toUpperCase()},Tt=function(e){(K.addEventListener||"load"===e.type||"complete"===K.readyState)&&(wt(),dt.ready())},wt=function(){K.addEventListener?(K.removeEventListener("DOMContentLoaded",Tt,!1),e.removeEventListener("load",Tt,!1)):(K.detachEvent("onreadystatechange",Tt),e.detachEvent("onload",Tt))};dt.fn=dt.prototype={jquery:nt,constructor:dt,init:function(e,n,i){var s,o;if(!e)return this;if("string"==typeof e){if(s="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:ft.exec(e),!s||!s[1]&&n)return!n||n.jquery?(n||i).find(e):this.constructor(n).find(e);if(s[1]){if(n=n instanceof dt?n[0]:n,dt.merge(this,dt.parseHTML(s[1],n&&n.nodeType?n.ownerDocument||n:K,!0)),mt.test(s[1])&&dt.isPlainObject(n))for(s in n)dt.isFunction(this[s])?this[s](n[s]):this.attr(s,n[s]);return this}if(o=K.getElementById(s[2]),o&&o.parentNode){if(o.id!==s[2])return i.find(e);this.length=1,this[0]=o}return this.context=K,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):dt.isFunction(e)?i.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),dt.makeArray(e,this))},selector:"",length:0,toArray:function(){return ot.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=dt.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return dt.each(this,e,t)},ready:function(e){return dt.ready.promise().done(e),this},slice:function(){return this.pushStack(ot.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(dt.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:st,sort:[].sort,splice:[].splice},dt.fn.init.prototype=dt.fn,dt.extend=dt.fn.extend=function(){var e,n,i,s,o,a,r=arguments[0]||{},l=1,c=arguments.length,d=!1;for("boolean"==typeof r&&(d=r,r=arguments[1]||{},l=2),"object"==typeof r||dt.isFunction(r)||(r={}),c===l&&(r=this,--l);c>l;l++)if(null!=(o=arguments[l]))for(s in o)e=r[s],i=o[s],r!==i&&(d&&i&&(dt.isPlainObject(i)||(n=dt.isArray(i)))?(n?(n=!1,a=e&&dt.isArray(e)?e:[]):a=e&&dt.isPlainObject(e)?e:{},r[s]=dt.extend(d,a,i)):i!==t&&(r[s]=i));return r},dt.extend({expando:"jQuery"+(nt+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===dt&&(e.$=Q),t&&e.jQuery===dt&&(e.jQuery=Z),dt},isReady:!1,readyWait:1,holdReady:function(e){e?dt.readyWait++:dt.ready(!0)},ready:function(e){if(e===!0?!--dt.readyWait:!dt.isReady){if(!K.body)return setTimeout(dt.ready);dt.isReady=!0,e!==!0&&--dt.readyWait>0||(Y.resolveWith(K,[dt]),dt.fn.trigger&&dt(K).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===dt.type(e)},isArray:Array.isArray||function(e){return"array"===dt.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?et[rt.call(e)]||"object":typeof e},isPlainObject:function(e){var n;if(!e||"object"!==dt.type(e)||e.nodeType||dt.isWindow(e))return!1;try{if(e.constructor&&!lt.call(e,"constructor")&&!lt.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}if(dt.support.ownLast)for(n in e)return lt.call(e,n);for(n in e);return n===t||lt.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||K;var i=mt.exec(e),s=!n&&[];return i?[t.createElement(i[1])]:(i=dt.buildFragment([e],t,s),s&&dt(s).remove(),dt.merge([],i.childNodes))},parseJSON:function(t){return e.JSON&&e.JSON.parse?e.JSON.parse(t):null===t?t:"string"==typeof t&&(t=dt.trim(t),t&&gt.test(t.replace(yt,"@").replace(bt,"]").replace(vt,"")))?new Function("return "+t)():void dt.error("Invalid JSON: "+t)},parseXML:function(n){var i,s;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(s=new DOMParser,i=s.parseFromString(n,"text/xml")):(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(n))}catch(o){i=t}return i&&i.documentElement&&!i.getElementsByTagName("parsererror").length||dt.error("Invalid XML: "+n),i},noop:function(){},globalEval:function(t){t&&dt.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(St,"ms-").replace(Et,kt)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var s,o=0,a=e.length,r=n(e);if(i){if(r)for(;a>o&&(s=t.apply(e[o],i),s!==!1);o++);else for(o in e)if(s=t.apply(e[o],i),s===!1)break}else if(r)for(;a>o&&(s=t.call(e[o],o,e[o]),s!==!1);o++);else for(o in e)if(s=t.call(e[o],o,e[o]),s===!1)break;return e},trim:ct&&!ct.call("\ufeff\xa0")?function(e){return null==e?"":ct.call(e)}:function(e){return null==e?"":(e+"").replace(pt,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(n(Object(e))?dt.merge(i,"string"==typeof e?[e]:e):st.call(i,e)),i},inArray:function(e,t,n){var i;if(t){if(at)return at.call(t,e,n);for(i=t.length,n=n?0>n?Math.max(0,i+n):n:0;i>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var i=n.length,s=e.length,o=0;if("number"==typeof i)for(;i>o;o++)e[s++]=n[o];else for(;n[o]!==t;)e[s++]=n[o++];return e.length=s,e},grep:function(e,t,n){var i,s=[],o=0,a=e.length;for(n=!!n;a>o;o++)i=!!t(e[o],o),n!==i&&s.push(e[o]);return s},map:function(e,t,i){var s,o=0,a=e.length,r=n(e),l=[];if(r)for(;a>o;o++)s=t(e[o],o,i),null!=s&&(l[l.length]=s);else for(o in e)s=t(e[o],o,i),null!=s&&(l[l.length]=s);return it.apply([],l)},guid:1,proxy:function(e,n){var i,s,o;return"string"==typeof n&&(o=e[n],n=e,e=o),dt.isFunction(e)?(i=ot.call(arguments,2),s=function(){return e.apply(n||this,i.concat(ot.call(arguments)))},s.guid=e.guid=e.guid||dt.guid++,s):t},access:function(e,n,i,s,o,a,r){var l=0,c=e.length,d=null==i;if("object"===dt.type(i)){o=!0;for(l in i)dt.access(e,n,l,i[l],!0,a,r)}else if(s!==t&&(o=!0,dt.isFunction(s)||(r=!0),d&&(r?(n.call(e,s),n=null):(d=n,n=function(e,t,n){return d.call(dt(e),n)})),n))for(;c>l;l++)n(e[l],i,r?s:s.call(e[l],l,n(e[l],i)));return o?e:d?n.call(e):c?n(e[0],i):a},now:function(){return(new Date).getTime()},swap:function(e,t,n,i){var s,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];s=n.apply(e,i||[]);for(o in t)e.style[o]=a[o];return s}}),dt.ready.promise=function(t){if(!Y)if(Y=dt.Deferred(),"complete"===K.readyState)setTimeout(dt.ready);else if(K.addEventListener)K.addEventListener("DOMContentLoaded",Tt,!1),e.addEventListener("load",Tt,!1);else{K.attachEvent("onreadystatechange",Tt),e.attachEvent("onload",Tt);var n=!1;try{n=null==e.frameElement&&K.documentElement}catch(i){}n&&n.doScroll&&!function s(){if(!dt.isReady){try{n.doScroll("left")}catch(e){return setTimeout(s,50)}wt(),dt.ready()}}()}return Y.promise(t)},dt.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){et["[object "+t+"]"]=t.toLowerCase()}),X=dt(K),/*!
 * Sizzle CSS Selector Engine v1.9.4-pre
 * http://sizzlejs.com/
 *
 * Copyright 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-05-15
 */
function(e,t){function n(e,t,n,i){var s,o,a,r,l,c,d,u,h,p;if((t?t.ownerDocument||t:z)!==P&&M(t),t=t||P,n=n||[],!e||"string"!=typeof e)return n;if(1!==(r=t.nodeType)&&9!==r)return[];if(B&&!i){if(s=Tt.exec(e))if(a=s[1]){if(9===r){if(o=t.getElementById(a),!o||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&j(t,o)&&o.id===a)return n.push(o),n}else{if(s[2])return st.apply(n,t.getElementsByTagName(e)),n;if((a=s[3])&&C.getElementsByClassName&&t.getElementsByClassName)return st.apply(n,t.getElementsByClassName(a)),n}if(C.qsa&&(!H||!H.test(e))){if(u=d=V,h=t,p=9===r&&e,1===r&&"object"!==t.nodeName.toLowerCase()){for(c=m(e),(d=t.getAttribute("id"))?u=d.replace(Lt,"\\$&"):t.setAttribute("id",u),u="[id='"+u+"'] ",l=c.length;l--;)c[l]=u+g(c[l]);h=vt.test(e)&&t.parentNode||t,p=c.join(",")}if(p)try{return st.apply(n,h.querySelectorAll(p)),n}catch(f){}finally{d||t.removeAttribute("id")}}}return w(e.replace(ft,"$1"),t,n,i)}function i(e){return kt.test(e+"")}function s(){function e(n,i){return t.push(n+=" ")>x.cacheLength&&delete e[t.shift()],e[n]=i}var t=[];return e}function o(e){return e[V]=!0,e}function a(e){var t=P.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function r(e,t,n){e=e.split("|");for(var i,s=e.length,o=n?null:t;s--;)(i=x.attrHandle[e[s]])&&i!==t||(x.attrHandle[e[s]]=o)}function l(e,t){var n=e.getAttributeNode(t);return n&&n.specified?n.value:e[t]===!0?t.toLowerCase():null}function c(e,t){return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}function d(e){return"input"===e.nodeName.toLowerCase()?e.defaultValue:void 0}function u(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||Q)-(~e.sourceIndex||Q);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function h(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function p(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function f(e){return o(function(t){return t=+t,o(function(n,i){for(var s,o=e([],n.length,t),a=o.length;a--;)n[s=o[a]]&&(n[s]=!(i[s]=n[s]))})})}function m(e,t){var i,s,o,a,r,l,c,d=G[e+" "];if(d)return t?0:d.slice(0);for(r=e,l=[],c=x.preFilter;r;){(!i||(s=mt.exec(r)))&&(s&&(r=r.slice(s[0].length)||r),l.push(o=[])),i=!1,(s=gt.exec(r))&&(i=s.shift(),o.push({value:i,type:s[0].replace(ft," ")}),r=r.slice(i.length));for(a in x.filter)!(s=Et[a].exec(r))||c[a]&&!(s=c[a](s))||(i=s.shift(),o.push({value:i,type:a,matches:s}),r=r.slice(i.length));if(!i)break}return t?r.length:r?n.error(e):G(e,l).slice(0)}function g(e){for(var t=0,n=e.length,i="";n>t;t++)i+=e[t].value;return i}function v(e,t,n){var i=t.dir,s=n&&"parentNode"===i,o=Y++;return t.first?function(t,n,o){for(;t=t[i];)if(1===t.nodeType||s)return e(t,n,o)}:function(t,n,a){var r,l,c,d=W+" "+o;if(a){for(;t=t[i];)if((1===t.nodeType||s)&&e(t,n,a))return!0}else for(;t=t[i];)if(1===t.nodeType||s)if(c=t[V]||(t[V]={}),(l=c[i])&&l[0]===d){if((r=l[1])===!0||r===I)return r===!0}else if(l=c[i]=[d],l[1]=e(t,n,a)||I,l[1]===!0)return!0}}function y(e){return e.length>1?function(t,n,i){for(var s=e.length;s--;)if(!e[s](t,n,i))return!1;return!0}:e[0]}function b(e,t,n,i,s){for(var o,a=[],r=0,l=e.length,c=null!=t;l>r;r++)(o=e[r])&&(!n||n(o,i,s))&&(a.push(o),c&&t.push(r));return a}function S(e,t,n,i,s,a){return i&&!i[V]&&(i=S(i)),s&&!s[V]&&(s=S(s,a)),o(function(o,a,r,l){var c,d,u,h=[],p=[],f=a.length,m=o||T(t||"*",r.nodeType?[r]:r,[]),g=!e||!o&&t?m:b(m,h,e,r,l),v=n?s||(o?e:f||i)?[]:a:g;if(n&&n(g,v,r,l),i)for(c=b(v,p),i(c,[],r,l),d=c.length;d--;)(u=c[d])&&(v[p[d]]=!(g[p[d]]=u));if(o){if(s||e){if(s){for(c=[],d=v.length;d--;)(u=v[d])&&c.push(g[d]=u);s(null,v=[],c,l)}for(d=v.length;d--;)(u=v[d])&&(c=s?at.call(o,u):h[d])>-1&&(o[c]=!(a[c]=u))}}else v=b(v===a?v.splice(f,v.length):v),s?s(null,a,v,l):st.apply(a,v)})}function E(e){for(var t,n,i,s=e.length,o=x.relative[e[0].type],a=o||x.relative[" "],r=o?1:0,l=v(function(e){return e===t},a,!0),c=v(function(e){return at.call(t,e)>-1},a,!0),d=[function(e,n,i){return!o&&(i||n!==O)||((t=n).nodeType?l(e,n,i):c(e,n,i))}];s>r;r++)if(n=x.relative[e[r].type])d=[v(y(d),n)];else{if(n=x.filter[e[r].type].apply(null,e[r].matches),n[V]){for(i=++r;s>i&&!x.relative[e[i].type];i++);return S(r>1&&y(d),r>1&&g(e.slice(0,r-1).concat({value:" "===e[r-2].type?"*":""})).replace(ft,"$1"),n,i>r&&E(e.slice(r,i)),s>i&&E(e=e.slice(i)),s>i&&g(e))}d.push(n)}return y(d)}function k(e,t){var i=0,s=t.length>0,a=e.length>0,r=function(o,r,l,c,d){var u,h,p,f=[],m=0,g="0",v=o&&[],y=null!=d,S=O,E=o||a&&x.find.TAG("*",d&&r.parentNode||r),k=W+=null==S?1:Math.random()||.1;for(y&&(O=r!==P&&r,I=i);null!=(u=E[g]);g++){if(a&&u){for(h=0;p=e[h++];)if(p(u,r,l)){c.push(u);break}y&&(W=k,I=++i)}s&&((u=!p&&u)&&m--,o&&v.push(u))}if(m+=g,s&&g!==m){for(h=0;p=t[h++];)p(v,f,r,l);if(o){if(m>0)for(;g--;)v[g]||f[g]||(f[g]=nt.call(c));f=b(f)}st.apply(c,f),y&&!o&&f.length>0&&m+t.length>1&&n.uniqueSort(c)}return y&&(W=k,O=S),v};return s?o(r):r}function T(e,t,i){for(var s=0,o=t.length;o>s;s++)n(e,t[s],i);return i}function w(e,t,n,i){var s,o,a,r,l,c=m(e);if(!i&&1===c.length){if(o=c[0]=c[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&C.getById&&9===t.nodeType&&B&&x.relative[o[1].type]){if(t=(x.find.ID(a.matches[0].replace(Ct,It),t)||[])[0],!t)return n;e=e.slice(o.shift().value.length)}for(s=Et.needsContext.test(e)?0:o.length;s--&&(a=o[s],!x.relative[r=a.type]);)if((l=x.find[r])&&(i=l(a.matches[0].replace(Ct,It),vt.test(o[0].type)&&t.parentNode||t))){if(o.splice(s,1),e=i.length&&g(o),!e)return st.apply(n,i),n;break}}return R(e,c)(i,t,!B,n,vt.test(e)),n}function _(){}var L,C,I,x,A,D,R,O,N,M,P,$,B,H,F,U,j,V="sizzle"+-new Date,z=e.document,W=0,Y=0,X=s(),G=s(),J=s(),K=!1,q=function(){return 0},Z=typeof t,Q=1<<31,et={}.hasOwnProperty,tt=[],nt=tt.pop,it=tt.push,st=tt.push,ot=tt.slice,at=tt.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},rt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",lt="[\\x20\\t\\r\\n\\f]",ct="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ut=ct.replace("w","w#"),ht="\\["+lt+"*("+ct+")"+lt+"*(?:([*^$|!~]?=)"+lt+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ut+")|)|)"+lt+"*\\]",pt=":("+ct+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ht.replace(3,8)+")*)|.*)\\)|)",ft=new RegExp("^"+lt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+lt+"+$","g"),mt=new RegExp("^"+lt+"*,"+lt+"*"),gt=new RegExp("^"+lt+"*([>+~]|"+lt+")"+lt+"*"),vt=new RegExp(lt+"*[+~]"),yt=new RegExp("="+lt+"*([^\\]'\"]*)"+lt+"*\\]","g"),bt=new RegExp(pt),St=new RegExp("^"+ut+"$"),Et={ID:new RegExp("^#("+ct+")"),CLASS:new RegExp("^\\.("+ct+")"),TAG:new RegExp("^("+ct.replace("w","w*")+")"),ATTR:new RegExp("^"+ht),PSEUDO:new RegExp("^"+pt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+lt+"*(even|odd|(([+-]|)(\\d*)n|)"+lt+"*(?:([+-]|)"+lt+"*(\\d+)|))"+lt+"*\\)|)","i"),bool:new RegExp("^(?:"+rt+")$","i"),needsContext:new RegExp("^"+lt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+lt+"*((?:-\\d)?\\d*)"+lt+"*\\)|)(?=[^-]|$)","i")},kt=/^[^{]+\{\s*\[native \w/,Tt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,wt=/^(?:input|select|textarea|button)$/i,_t=/^h\d$/i,Lt=/'|\\/g,Ct=new RegExp("\\\\([\\da-f]{1,6}"+lt+"?|("+lt+")|.)","ig"),It=function(e,t,n){var i="0x"+t-65536;return i!==i||n?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)};try{st.apply(tt=ot.call(z.childNodes),z.childNodes),tt[z.childNodes.length].nodeType}catch(xt){st={apply:tt.length?function(e,t){it.apply(e,ot.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}D=n.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},C=n.support={},M=n.setDocument=function(e){var t=e?e.ownerDocument||e:z;return t!==P&&9===t.nodeType&&t.documentElement?(P=t,$=t.documentElement,B=!D(t),C.attributes=a(function(e){return e.innerHTML="<a href='#'></a>",r("type|href|height|width",c,"#"===e.firstChild.getAttribute("href")),r(rt,l,null==e.getAttribute("disabled")),e.className="i",!e.getAttribute("className")}),C.input=a(function(e){return e.innerHTML="<input>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}),r("value",d,C.attributes&&C.input),C.getElementsByTagName=a(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),C.getElementsByClassName=a(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),C.getById=a(function(e){return $.appendChild(e).id=V,!t.getElementsByName||!t.getElementsByName(V).length}),C.getById?(x.find.ID=function(e,t){if(typeof t.getElementById!==Z&&B){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},x.filter.ID=function(e){var t=e.replace(Ct,It);return function(e){return e.getAttribute("id")===t}}):(delete x.find.ID,x.filter.ID=function(e){var t=e.replace(Ct,It);return function(e){var n=typeof e.getAttributeNode!==Z&&e.getAttributeNode("id");return n&&n.value===t}}),x.find.TAG=C.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==Z?t.getElementsByTagName(e):void 0}:function(e,t){var n,i=[],s=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[s++];)1===n.nodeType&&i.push(n);return i}return o},x.find.CLASS=C.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==Z&&B?t.getElementsByClassName(e):void 0},F=[],H=[],(C.qsa=i(t.querySelectorAll))&&(a(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||H.push("\\["+lt+"*(?:value|"+rt+")"),e.querySelectorAll(":checked").length||H.push(":checked")}),a(function(e){var n=t.createElement("input");n.setAttribute("type","hidden"),e.appendChild(n).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&H.push("[*^$]="+lt+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||H.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),H.push(",.*:")})),(C.matchesSelector=i(U=$.webkitMatchesSelector||$.mozMatchesSelector||$.oMatchesSelector||$.msMatchesSelector))&&a(function(e){C.disconnectedMatch=U.call(e,"div"),U.call(e,"[s!='']:x"),F.push("!=",pt)}),H=H.length&&new RegExp(H.join("|")),F=F.length&&new RegExp(F.join("|")),j=i($.contains)||$.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},C.sortDetached=a(function(e){return 1&e.compareDocumentPosition(t.createElement("div"))}),q=$.compareDocumentPosition?function(e,n){if(e===n)return K=!0,0;var i=n.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(n);return i?1&i||!C.sortDetached&&n.compareDocumentPosition(e)===i?e===t||j(z,e)?-1:n===t||j(z,n)?1:N?at.call(N,e)-at.call(N,n):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,n){var i,s=0,o=e.parentNode,a=n.parentNode,r=[e],l=[n];if(e===n)return K=!0,0;if(!o||!a)return e===t?-1:n===t?1:o?-1:a?1:N?at.call(N,e)-at.call(N,n):0;if(o===a)return u(e,n);for(i=e;i=i.parentNode;)r.unshift(i);for(i=n;i=i.parentNode;)l.unshift(i);for(;r[s]===l[s];)s++;return s?u(r[s],l[s]):r[s]===z?-1:l[s]===z?1:0},t):P},n.matches=function(e,t){return n(e,null,null,t)},n.matchesSelector=function(e,t){if((e.ownerDocument||e)!==P&&M(e),t=t.replace(yt,"='$1']"),!(!C.matchesSelector||!B||F&&F.test(t)||H&&H.test(t)))try{var i=U.call(e,t);if(i||C.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(s){}return n(t,P,null,[e]).length>0},n.contains=function(e,t){return(e.ownerDocument||e)!==P&&M(e),j(e,t)},n.attr=function(e,n){(e.ownerDocument||e)!==P&&M(e);var i=x.attrHandle[n.toLowerCase()],s=i&&et.call(x.attrHandle,n.toLowerCase())?i(e,n,!B):t;return s===t?C.attributes||!B?e.getAttribute(n):(s=e.getAttributeNode(n))&&s.specified?s.value:null:s},n.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},n.uniqueSort=function(e){var t,n=[],i=0,s=0;if(K=!C.detectDuplicates,N=!C.sortStable&&e.slice(0),e.sort(q),K){for(;t=e[s++];)t===e[s]&&(i=n.push(s));for(;i--;)e.splice(n[i],1)}return e},A=n.getText=function(e){var t,n="",i=0,s=e.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=A(e)}else if(3===s||4===s)return e.nodeValue}else for(;t=e[i];i++)n+=A(t);return n},x=n.selectors={cacheLength:50,createPseudo:o,match:Et,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Ct,It),e[3]=(e[4]||e[5]||"").replace(Ct,It),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||n.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&n.error(e[0]),e},PSEUDO:function(e){var n,i=!e[5]&&e[2];return Et.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:i&&bt.test(i)&&(n=m(i,!0))&&(n=i.indexOf(")",i.length-n)-i.length)&&(e[0]=e[0].slice(0,n),e[2]=i.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Ct,It).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=X[e+" "];return t||(t=new RegExp("(^|"+lt+")"+e+"("+lt+"|$)"))&&X(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==Z&&e.getAttribute("class")||"")})},ATTR:function(e,t,i){return function(s){var o=n.attr(s,e);return null==o?"!="===t:t?(o+="","="===t?o===i:"!="===t?o!==i:"^="===t?i&&0===o.indexOf(i):"*="===t?i&&o.indexOf(i)>-1:"$="===t?i&&o.slice(-i.length)===i:"~="===t?(" "+o+" ").indexOf(i)>-1:"|="===t?o===i||o.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,n,i,s){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),r="of-type"===t;return 1===i&&0===s?function(e){return!!e.parentNode}:function(t,n,l){var c,d,u,h,p,f,m=o!==a?"nextSibling":"previousSibling",g=t.parentNode,v=r&&t.nodeName.toLowerCase(),y=!l&&!r;if(g){if(o){for(;m;){for(u=t;u=u[m];)if(r?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;f=m="only"===e&&!f&&"nextSibling"}return!0}if(f=[a?g.firstChild:g.lastChild],a&&y){for(d=g[V]||(g[V]={}),c=d[e]||[],p=c[0]===W&&c[1],h=c[0]===W&&c[2],u=p&&g.childNodes[p];u=++p&&u&&u[m]||(h=p=0)||f.pop();)if(1===u.nodeType&&++h&&u===t){d[e]=[W,p,h];break}}else if(y&&(c=(t[V]||(t[V]={}))[e])&&c[0]===W)h=c[1];else for(;(u=++p&&u&&u[m]||(h=p=0)||f.pop())&&((r?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++h||(y&&((u[V]||(u[V]={}))[e]=[W,h]),u!==t)););return h-=s,h===i||h%i===0&&h/i>=0}}},PSEUDO:function(e,t){var i,s=x.pseudos[e]||x.setFilters[e.toLowerCase()]||n.error("unsupported pseudo: "+e);return s[V]?s(t):s.length>1?(i=[e,e,"",t],x.setFilters.hasOwnProperty(e.toLowerCase())?o(function(e,n){for(var i,o=s(e,t),a=o.length;a--;)i=at.call(e,o[a]),e[i]=!(n[i]=o[a])}):function(e){return s(e,0,i)}):s}},pseudos:{not:o(function(e){var t=[],n=[],i=R(e.replace(ft,"$1"));return i[V]?o(function(e,t,n,s){for(var o,a=i(e,null,s,[]),r=e.length;r--;)(o=a[r])&&(e[r]=!(t[r]=o))}):function(e,s,o){return t[0]=e,i(t,null,o,n),!n.pop()}}),has:o(function(e){return function(t){return n(e,t).length>0}}),contains:o(function(e){return function(t){return(t.textContent||t.innerText||A(t)).indexOf(e)>-1}}),lang:o(function(e){return St.test(e||"")||n.error("unsupported lang: "+e),e=e.replace(Ct,It).toLowerCase(),function(t){var n;do if(n=B?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===$},focus:function(e){return e===P.activeElement&&(!P.hasFocus||P.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!x.pseudos.empty(e)},header:function(e){return _t.test(e.nodeName)},input:function(e){return wt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:f(function(){return[0]}),last:f(function(e,t){return[t-1]}),eq:f(function(e,t,n){return[0>n?n+t:n]}),even:f(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:f(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:f(function(e,t,n){for(var i=0>n?n+t:n;--i>=0;)e.push(i);return e}),gt:f(function(e,t,n){for(var i=0>n?n+t:n;++i<t;)e.push(i);return e})}};for(L in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[L]=h(L);for(L in{submit:!0,reset:!0})x.pseudos[L]=p(L);R=n.compile=function(e,t){var n,i=[],s=[],o=J[e+" "];if(!o){for(t||(t=m(e)),n=t.length;n--;)o=E(t[n]),o[V]?i.push(o):s.push(o);o=J(e,k(s,i))}return o},x.pseudos.nth=x.pseudos.eq,_.prototype=x.filters=x.pseudos,x.setFilters=new _,C.sortStable=V.split("").sort(q).join("")===V,M(),[0,0].sort(q),C.detectDuplicates=K,dt.find=n,dt.expr=n.selectors,dt.expr[":"]=dt.expr.pseudos,dt.unique=n.uniqueSort,dt.text=n.getText,dt.isXMLDoc=n.isXML,dt.contains=n.contains}(e);var _t={};dt.Callbacks=function(e){e="string"==typeof e?_t[e]||i(e):dt.extend({},e);var n,s,o,a,r,l,c=[],d=!e.once&&[],u=function(t){for(s=e.memory&&t,o=!0,r=l||0,l=0,a=c.length,n=!0;c&&a>r;r++)if(c[r].apply(t[0],t[1])===!1&&e.stopOnFalse){s=!1;break}n=!1,c&&(d?d.length&&u(d.shift()):s?c=[]:h.disable())},h={add:function(){if(c){var t=c.length;!function i(t){dt.each(t,function(t,n){var s=dt.type(n);"function"===s?e.unique&&h.has(n)||c.push(n):n&&n.length&&"string"!==s&&i(n)})}(arguments),n?a=c.length:s&&(l=t,u(s))}return this},remove:function(){return c&&dt.each(arguments,function(e,t){for(var i;(i=dt.inArray(t,c,i))>-1;)c.splice(i,1),n&&(a>=i&&a--,r>=i&&r--)}),this},has:function(e){return e?dt.inArray(e,c)>-1:!(!c||!c.length)},empty:function(){return c=[],a=0,this},disable:function(){return c=d=s=t,this},disabled:function(){return!c},lock:function(){return d=t,s||h.disable(),this},locked:function(){return!d},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!c||o&&!d||(n?d.push(t):u(t)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!o}};return h},dt.extend({Deferred:function(e){var t=[["resolve","done",dt.Callbacks("once memory"),"resolved"],["reject","fail",dt.Callbacks("once memory"),"rejected"],["notify","progress",dt.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var e=arguments;return dt.Deferred(function(n){dt.each(t,function(t,o){var a=o[0],r=dt.isFunction(e[t])&&e[t];s[o[1]](function(){var e=r&&r.apply(this,arguments);e&&dt.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===i?n.promise():this,r?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?dt.extend(e,i):i}},s={};return i.pipe=i.then,dt.each(t,function(e,o){var a=o[2],r=o[3];i[o[1]]=a.add,r&&a.add(function(){n=r},t[1^e][2].disable,t[2][2].lock),s[o[0]]=function(){return s[o[0]+"With"](this===s?i:this,arguments),this},s[o[0]+"With"]=a.fireWith}),i.promise(s),e&&e.call(s,s),s},when:function(e){var t,n,i,s=0,o=ot.call(arguments),a=o.length,r=1!==a||e&&dt.isFunction(e.promise)?a:0,l=1===r?e:dt.Deferred(),c=function(e,n,i){return function(s){n[e]=this,i[e]=arguments.length>1?ot.call(arguments):s,i===t?l.notifyWith(n,i):--r||l.resolveWith(n,i)}};if(a>1)for(t=new Array(a),n=new Array(a),i=new Array(a);a>s;s++)o[s]&&dt.isFunction(o[s].promise)?o[s].promise().done(c(s,i,o)).fail(l.reject).progress(c(s,n,t)):--r;return r||l.resolveWith(i,o),l.promise()}}),dt.support=function(t){var n,i,s,o,a,r,l,c,d,u=K.createElement("div");if(u.setAttribute("className","t"),u.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=u.getElementsByTagName("*")||[],i=u.getElementsByTagName("a")[0],!i||!i.style||!n.length)return t;o=K.createElement("select"),r=o.appendChild(K.createElement("option")),s=u.getElementsByTagName("input")[0],i.style.cssText="top:1px;float:left;opacity:.5",t.getSetAttribute="t"!==u.className,t.leadingWhitespace=3===u.firstChild.nodeType,t.tbody=!u.getElementsByTagName("tbody").length,t.htmlSerialize=!!u.getElementsByTagName("link").length,t.style=/top/.test(i.getAttribute("style")),t.hrefNormalized="/a"===i.getAttribute("href"),t.opacity=/^0.5/.test(i.style.opacity),t.cssFloat=!!i.style.cssFloat,t.checkOn=!!s.value,t.optSelected=r.selected,t.enctype=!!K.createElement("form").enctype,t.html5Clone="<:nav></:nav>"!==K.createElement("nav").cloneNode(!0).outerHTML,t.inlineBlockNeedsLayout=!1,t.shrinkWrapBlocks=!1,t.pixelPosition=!1,t.deleteExpando=!0,t.noCloneEvent=!0,t.reliableMarginRight=!0,t.boxSizingReliable=!0,s.checked=!0,t.noCloneChecked=s.cloneNode(!0).checked,o.disabled=!0,t.optDisabled=!r.disabled;try{delete u.test}catch(h){t.deleteExpando=!1}s=K.createElement("input"),s.setAttribute("value",""),t.input=""===s.getAttribute("value"),s.value="t",s.setAttribute("type","radio"),t.radioValue="t"===s.value,s.setAttribute("checked","t"),s.setAttribute("name","t"),a=K.createDocumentFragment(),a.appendChild(s),t.appendChecked=s.checked,t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,u.attachEvent&&(u.attachEvent("onclick",function(){t.noCloneEvent=!1}),u.cloneNode(!0).click());for(d in{submit:!0,change:!0,focusin:!0})u.setAttribute(l="on"+d,"t"),t[d+"Bubbles"]=l in e||u.attributes[l].expando===!1;u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===u.style.backgroundClip;for(d in dt(t))break;return t.ownLast="0"!==d,dt(function(){var n,i,s,o="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",a=K.getElementsByTagName("body")[0];a&&(n=K.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(u),u.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=u.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===s[0].offsetHeight,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=c&&0===s[0].offsetHeight,u.innerHTML="",u.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",dt.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===u.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(u,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(u,null)||{width:"4px"}).width,i=u.appendChild(K.createElement("div")),i.style.cssText=u.style.cssText=o,i.style.marginRight=i.style.width="0",u.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(i,null)||{}).marginRight)),typeof u.style.zoom!==G&&(u.innerHTML="",u.style.cssText=o+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===u.offsetWidth,u.style.display="block",u.innerHTML="<div></div>",u.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==u.offsetWidth,t.inlineBlockNeedsLayout&&(a.style.zoom=1)),a.removeChild(n),n=u=s=i=null)}),n=o=a=r=i=s=null,t}({});var Lt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Ct=/([A-Z])/g;dt.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?dt.cache[e[dt.expando]]:e[dt.expando],!!e&&!r(e)},data:function(e,t,n){return s(e,t,n)},removeData:function(e,t){return o(e,t)},_data:function(e,t,n){return s(e,t,n,!0)},_removeData:function(e,t){return o(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&dt.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),dt.fn.extend({data:function(e,n){var i,s,o=null,r=0,l=this[0];if(e===t){if(this.length&&(o=dt.data(l),1===l.nodeType&&!dt._data(l,"parsedAttrs"))){for(i=l.attributes;r<i.length;r++)s=i[r].name,0===s.indexOf("data-")&&(s=dt.camelCase(s.slice(5)),a(l,s,o[s]));dt._data(l,"parsedAttrs",!0)}return o}return"object"==typeof e?this.each(function(){dt.data(this,e)}):arguments.length>1?this.each(function(){dt.data(this,e,n)}):l?a(l,e,dt.data(l,e)):null},removeData:function(e){return this.each(function(){dt.removeData(this,e)})}}),dt.extend({queue:function(e,t,n){var i;return e?(t=(t||"fx")+"queue",i=dt._data(e,t),n&&(!i||dt.isArray(n)?i=dt._data(e,t,dt.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=dt.queue(e,t),i=n.length,s=n.shift(),o=dt._queueHooks(e,t),a=function(){dt.dequeue(e,t)};"inprogress"===s&&(s=n.shift(),i--),o.cur=s,s&&("fx"===t&&n.unshift("inprogress"),delete o.stop,s.call(e,a,o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return dt._data(e,n)||dt._data(e,n,{empty:dt.Callbacks("once memory").add(function(){dt._removeData(e,t+"queue"),dt._removeData(e,n)})})}}),dt.fn.extend({queue:function(e,n){var i=2;return"string"!=typeof e&&(n=e,e="fx",i--),arguments.length<i?dt.queue(this[0],e):n===t?this:this.each(function(){var t=dt.queue(this,e,n);dt._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&dt.dequeue(this,e)})},dequeue:function(e){return this.each(function(){dt.dequeue(this,e)})},delay:function(e,t){return e=dt.fx?dt.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var i=setTimeout(t,e);n.stop=function(){clearTimeout(i)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var i,s=1,o=dt.Deferred(),a=this,r=this.length,l=function(){--s||o.resolveWith(a,[a])};for("string"!=typeof e&&(n=e,e=t),e=e||"fx";r--;)i=dt._data(a[r],e+"queueHooks"),i&&i.empty&&(s++,i.empty.add(l));return l(),o.promise(n)}});var It,xt,At=/[\t\r\n\f]/g,Dt=/\r/g,Rt=/^(?:input|select|textarea|button|object)$/i,Ot=/^(?:a|area)$/i,Nt=/^(?:checked|selected)$/i,Mt=dt.support.getSetAttribute,Pt=dt.support.input;dt.fn.extend({attr:function(e,t){return dt.access(this,dt.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){dt.removeAttr(this,e)})},prop:function(e,t){return dt.access(this,dt.prop,e,t,arguments.length>1)},removeProp:function(e){return e=dt.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,i,s,o,a=0,r=this.length,l="string"==typeof e&&e;if(dt.isFunction(e))return this.each(function(t){dt(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(ht)||[];r>a;a++)if(n=this[a],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(At," "):" ")){for(o=0;s=t[o++];)i.indexOf(" "+s+" ")<0&&(i+=s+" ");n.className=dt.trim(i)}return this},removeClass:function(e){var t,n,i,s,o,a=0,r=this.length,l=0===arguments.length||"string"==typeof e&&e;if(dt.isFunction(e))return this.each(function(t){dt(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(ht)||[];r>a;a++)if(n=this[a],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(At," "):"")){for(o=0;s=t[o++];)for(;i.indexOf(" "+s+" ")>=0;)i=i.replace(" "+s+" "," ");n.className=e?dt.trim(i):""}return this},toggleClass:function(e,t){var n=typeof e,i="boolean"==typeof t;return this.each(dt.isFunction(e)?function(n){dt(this).toggleClass(e.call(this,n,this.className,t),t)}:function(){if("string"===n)for(var s,o=0,a=dt(this),r=t,l=e.match(ht)||[];s=l[o++];)r=i?r:!a.hasClass(s),a[r?"addClass":"removeClass"](s);else(n===G||"boolean"===n)&&(this.className&&dt._data(this,"__className__",this.className),this.className=this.className||e===!1?"":dt._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(At," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,i,s,o=this[0];{if(arguments.length)return s=dt.isFunction(e),this.each(function(n){var o;1===this.nodeType&&(o=s?e.call(this,n,dt(this).val()):e,null==o?o="":"number"==typeof o?o+="":dt.isArray(o)&&(o=dt.map(o,function(e){return null==e?"":e+""})),i=dt.valHooks[this.type]||dt.valHooks[this.nodeName.toLowerCase()],i&&"set"in i&&i.set(this,o,"value")!==t||(this.value=o))});if(o)return i=dt.valHooks[o.type]||dt.valHooks[o.nodeName.toLowerCase()],i&&"get"in i&&(n=i.get(o,"value"))!==t?n:(n=o.value,"string"==typeof n?n.replace(Dt,""):null==n?"":n)}}}),dt.extend({valHooks:{option:{get:function(e){var t=dt.find.attr(e,"value");return null!=t?t:e.text}},select:{get:function(e){for(var t,n,i=e.options,s=e.selectedIndex,o="select-one"===e.type||0>s,a=o?null:[],r=o?s+1:i.length,l=0>s?r:o?s:0;r>l;l++)if(n=i[l],!(!n.selected&&l!==s||(dt.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&dt.nodeName(n.parentNode,"optgroup"))){if(t=dt(n).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var n,i,s=e.options,o=dt.makeArray(t),a=s.length;a--;)i=s[a],(i.selected=dt.inArray(dt(i).val(),o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}},attr:function(e,n,i){var s,o,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return typeof e.getAttribute===G?dt.prop(e,n,i):(1===a&&dt.isXMLDoc(e)||(n=n.toLowerCase(),s=dt.attrHooks[n]||(dt.expr.match.bool.test(n)?xt:It)),i===t?s&&"get"in s&&null!==(o=s.get(e,n))?o:(o=dt.find.attr(e,n),null==o?t:o):null!==i?s&&"set"in s&&(o=s.set(e,i,n))!==t?o:(e.setAttribute(n,i+""),i):void dt.removeAttr(e,n))},removeAttr:function(e,t){var n,i,s=0,o=t&&t.match(ht);if(o&&1===e.nodeType)for(;n=o[s++];)i=dt.propFix[n]||n,dt.expr.match.bool.test(n)?Pt&&Mt||!Nt.test(n)?e[i]=!1:e[dt.camelCase("default-"+n)]=e[i]=!1:dt.attr(e,n,""),e.removeAttribute(Mt?n:i)},attrHooks:{type:{set:function(e,t){if(!dt.support.radioValue&&"radio"===t&&dt.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,n,i){var s,o,a,r=e.nodeType;if(e&&3!==r&&8!==r&&2!==r)return a=1!==r||!dt.isXMLDoc(e),a&&(n=dt.propFix[n]||n,o=dt.propHooks[n]),i!==t?o&&"set"in o&&(s=o.set(e,i,n))!==t?s:e[n]=i:o&&"get"in o&&null!==(s=o.get(e,n))?s:e[n]},propHooks:{tabIndex:{get:function(e){var t=dt.find.attr(e,"tabindex");return t?parseInt(t,10):Rt.test(e.nodeName)||Ot.test(e.nodeName)&&e.href?0:-1}}}}),xt={set:function(e,t,n){return t===!1?dt.removeAttr(e,n):Pt&&Mt||!Nt.test(n)?e.setAttribute(!Mt&&dt.propFix[n]||n,n):e[dt.camelCase("default-"+n)]=e[n]=!0,n}},dt.each(dt.expr.match.bool.source.match(/\w+/g),function(e,n){var i=dt.expr.attrHandle[n]||dt.find.attr;dt.expr.attrHandle[n]=Pt&&Mt||!Nt.test(n)?function(e,n,s){var o=dt.expr.attrHandle[n],a=s?t:(dt.expr.attrHandle[n]=t)!=i(e,n,s)?n.toLowerCase():null;return dt.expr.attrHandle[n]=o,a}:function(e,n,i){return i?t:e[dt.camelCase("default-"+n)]?n.toLowerCase():null}}),Pt&&Mt||(dt.attrHooks.value={set:function(e,t,n){return dt.nodeName(e,"input")?void(e.defaultValue=t):It&&It.set(e,t,n)}}),Mt||(It={set:function(e,n,i){var s=e.getAttributeNode(i);return s||e.setAttributeNode(s=e.ownerDocument.createAttribute(i)),s.value=n+="","value"===i||n===e.getAttribute(i)?n:t}},dt.expr.attrHandle.id=dt.expr.attrHandle.name=dt.expr.attrHandle.coords=function(e,n,i){var s;return i?t:(s=e.getAttributeNode(n))&&""!==s.value?s.value:null},dt.valHooks.button={get:function(e,n){var i=e.getAttributeNode(n);return i&&i.specified?i.value:t},set:It.set},dt.attrHooks.contenteditable={set:function(e,t,n){It.set(e,""===t?!1:t,n)}},dt.each(["width","height"],function(e,t){dt.attrHooks[t]={set:function(e,n){return""===n?(e.setAttribute(t,"auto"),n):void 0}}})),dt.support.hrefNormalized||dt.each(["href","src"],function(e,t){dt.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),dt.support.style||(dt.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),dt.support.optSelected||(dt.propHooks.selected={get:function(e){var t=e.parentNode;
return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),dt.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){dt.propFix[this.toLowerCase()]=this}),dt.support.enctype||(dt.propFix.enctype="encoding"),dt.each(["radio","checkbox"],function(){dt.valHooks[this]={set:function(e,t){return dt.isArray(t)?e.checked=dt.inArray(dt(e).val(),t)>=0:void 0}},dt.support.checkOn||(dt.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var $t=/^(?:input|select|textarea)$/i,Bt=/^key/,Ht=/^(?:mouse|contextmenu)|click/,Ft=/^(?:focusinfocus|focusoutblur)$/,Ut=/^([^.]*)(?:\.(.+)|)$/;dt.event={global:{},add:function(e,n,i,s,o){var a,r,l,c,d,u,h,p,f,m,g,v=dt._data(e);if(v){for(i.handler&&(c=i,i=c.handler,o=c.selector),i.guid||(i.guid=dt.guid++),(r=v.events)||(r=v.events={}),(u=v.handle)||(u=v.handle=function(e){return typeof dt===G||e&&dt.event.triggered===e.type?t:dt.event.dispatch.apply(u.elem,arguments)},u.elem=e),n=(n||"").match(ht)||[""],l=n.length;l--;)a=Ut.exec(n[l])||[],f=g=a[1],m=(a[2]||"").split(".").sort(),f&&(d=dt.event.special[f]||{},f=(o?d.delegateType:d.bindType)||f,d=dt.event.special[f]||{},h=dt.extend({type:f,origType:g,data:s,handler:i,guid:i.guid,selector:o,needsContext:o&&dt.expr.match.needsContext.test(o),namespace:m.join(".")},c),(p=r[f])||(p=r[f]=[],p.delegateCount=0,d.setup&&d.setup.call(e,s,m,u)!==!1||(e.addEventListener?e.addEventListener(f,u,!1):e.attachEvent&&e.attachEvent("on"+f,u))),d.add&&(d.add.call(e,h),h.handler.guid||(h.handler.guid=i.guid)),o?p.splice(p.delegateCount++,0,h):p.push(h),dt.event.global[f]=!0);e=null}},remove:function(e,t,n,i,s){var o,a,r,l,c,d,u,h,p,f,m,g=dt.hasData(e)&&dt._data(e);if(g&&(d=g.events)){for(t=(t||"").match(ht)||[""],c=t.length;c--;)if(r=Ut.exec(t[c])||[],p=m=r[1],f=(r[2]||"").split(".").sort(),p){for(u=dt.event.special[p]||{},p=(i?u.delegateType:u.bindType)||p,h=d[p]||[],r=r[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=h.length;o--;)a=h[o],!s&&m!==a.origType||n&&n.guid!==a.guid||r&&!r.test(a.namespace)||i&&i!==a.selector&&("**"!==i||!a.selector)||(h.splice(o,1),a.selector&&h.delegateCount--,u.remove&&u.remove.call(e,a));l&&!h.length&&(u.teardown&&u.teardown.call(e,f,g.handle)!==!1||dt.removeEvent(e,p,g.handle),delete d[p])}else for(p in d)dt.event.remove(e,p+t[c],n,i,!0);dt.isEmptyObject(d)&&(delete g.handle,dt._removeData(e,"events"))}},trigger:function(n,i,s,o){var a,r,l,c,d,u,h,p=[s||K],f=lt.call(n,"type")?n.type:n,m=lt.call(n,"namespace")?n.namespace.split("."):[];if(l=u=s=s||K,3!==s.nodeType&&8!==s.nodeType&&!Ft.test(f+dt.event.triggered)&&(f.indexOf(".")>=0&&(m=f.split("."),f=m.shift(),m.sort()),r=f.indexOf(":")<0&&"on"+f,n=n[dt.expando]?n:new dt.Event(f,"object"==typeof n&&n),n.isTrigger=o?2:3,n.namespace=m.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=s),i=null==i?[n]:dt.makeArray(i,[n]),d=dt.event.special[f]||{},o||!d.trigger||d.trigger.apply(s,i)!==!1)){if(!o&&!d.noBubble&&!dt.isWindow(s)){for(c=d.delegateType||f,Ft.test(c+f)||(l=l.parentNode);l;l=l.parentNode)p.push(l),u=l;u===(s.ownerDocument||K)&&p.push(u.defaultView||u.parentWindow||e)}for(h=0;(l=p[h++])&&!n.isPropagationStopped();)n.type=h>1?c:d.bindType||f,a=(dt._data(l,"events")||{})[n.type]&&dt._data(l,"handle"),a&&a.apply(l,i),a=r&&l[r],a&&dt.acceptData(l)&&a.apply&&a.apply(l,i)===!1&&n.preventDefault();if(n.type=f,!o&&!n.isDefaultPrevented()&&(!d._default||d._default.apply(p.pop(),i)===!1)&&dt.acceptData(s)&&r&&s[f]&&!dt.isWindow(s)){u=s[r],u&&(s[r]=null),dt.event.triggered=f;try{s[f]()}catch(g){}dt.event.triggered=t,u&&(s[r]=u)}return n.result}},dispatch:function(e){e=dt.event.fix(e);var n,i,s,o,a,r=[],l=ot.call(arguments),c=(dt._data(this,"events")||{})[e.type]||[],d=dt.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!d.preDispatch||d.preDispatch.call(this,e)!==!1){for(r=dt.event.handlers.call(this,e,c),n=0;(o=r[n++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,a=0;(s=o.handlers[a++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(s.namespace))&&(e.handleObj=s,e.data=s.data,i=((dt.event.special[s.origType]||{}).handle||s.handler).apply(o.elem,l),i!==t&&(e.result=i)===!1&&(e.preventDefault(),e.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,e),e.result}},handlers:function(e,n){var i,s,o,a,r=[],l=n.delegateCount,c=e.target;if(l&&c.nodeType&&(!e.button||"click"!==e.type))for(;c!=this;c=c.parentNode||this)if(1===c.nodeType&&(c.disabled!==!0||"click"!==e.type)){for(o=[],a=0;l>a;a++)s=n[a],i=s.selector+" ",o[i]===t&&(o[i]=s.needsContext?dt(i,this).index(c)>=0:dt.find(i,this,null,[c]).length),o[i]&&o.push(s);o.length&&r.push({elem:c,handlers:o})}return l<n.length&&r.push({elem:this,handlers:n.slice(l)}),r},fix:function(e){if(e[dt.expando])return e;var t,n,i,s=e.type,o=e,a=this.fixHooks[s];for(a||(this.fixHooks[s]=a=Ht.test(s)?this.mouseHooks:Bt.test(s)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,e=new dt.Event(o),t=i.length;t--;)n=i[t],e[n]=o[n];return e.target||(e.target=o.srcElement||K),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,a.filter?a.filter(e,o):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var i,s,o,a=n.button,r=n.fromElement;return null==e.pageX&&null!=n.clientX&&(s=e.target.ownerDocument||K,o=s.documentElement,i=s.body,e.pageX=n.clientX+(o&&o.scrollLeft||i&&i.scrollLeft||0)-(o&&o.clientLeft||i&&i.clientLeft||0),e.pageY=n.clientY+(o&&o.scrollTop||i&&i.scrollTop||0)-(o&&o.clientTop||i&&i.clientTop||0)),!e.relatedTarget&&r&&(e.relatedTarget=r===e.target?n.toElement:r),e.which||a===t||(e.which=1&a?1:2&a?3:4&a?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==d()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===d()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return dt.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(e){return dt.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){var s=dt.extend(new dt.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?dt.event.trigger(s,null,t):dt.event.dispatch.call(t,s),s.isDefaultPrevented()&&n.preventDefault()}},dt.removeEvent=K.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var i="on"+t;e.detachEvent&&(typeof e[i]===G&&(e[i]=null),e.detachEvent(i,n))},dt.Event=function(e,t){return this instanceof dt.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?l:c):this.type=e,t&&dt.extend(this,t),this.timeStamp=e&&e.timeStamp||dt.now(),void(this[dt.expando]=!0)):new dt.Event(e,t)},dt.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=l,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=l,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},dt.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){dt.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,s=e.relatedTarget,o=e.handleObj;return(!s||s!==i&&!dt.contains(i,s))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),dt.support.submitBubbles||(dt.event.special.submit={setup:function(){return dt.nodeName(this,"form")?!1:void dt.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,i=dt.nodeName(n,"input")||dt.nodeName(n,"button")?n.form:t;i&&!dt._data(i,"submitBubbles")&&(dt.event.add(i,"submit._submit",function(e){e._submit_bubble=!0}),dt._data(i,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&dt.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return dt.nodeName(this,"form")?!1:void dt.event.remove(this,"._submit")}}),dt.support.changeBubbles||(dt.event.special.change={setup:function(){return $t.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(dt.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),dt.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),dt.event.simulate("change",this,e,!0)})),!1):void dt.event.add(this,"beforeactivate._change",function(e){var t=e.target;$t.test(t.nodeName)&&!dt._data(t,"changeBubbles")&&(dt.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||dt.event.simulate("change",this.parentNode,e,!0)}),dt._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return dt.event.remove(this,"._change"),!$t.test(this.nodeName)}}),dt.support.focusinBubbles||dt.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,i=function(e){dt.event.simulate(t,e.target,dt.event.fix(e),!0)};dt.event.special[t]={setup:function(){0===n++&&K.addEventListener(e,i,!0)},teardown:function(){0===--n&&K.removeEventListener(e,i,!0)}}}),dt.fn.extend({on:function(e,n,i,s,o){var a,r;if("object"==typeof e){"string"!=typeof n&&(i=i||n,n=t);for(a in e)this.on(a,n,i,e[a],o);return this}if(null==i&&null==s?(s=n,i=n=t):null==s&&("string"==typeof n?(s=i,i=t):(s=i,i=n,n=t)),s===!1)s=c;else if(!s)return this;return 1===o&&(r=s,s=function(e){return dt().off(e),r.apply(this,arguments)},s.guid=r.guid||(r.guid=dt.guid++)),this.each(function(){dt.event.add(this,e,s,i,n)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,n,i){var s,o;if(e&&e.preventDefault&&e.handleObj)return s=e.handleObj,dt(e.delegateTarget).off(s.namespace?s.origType+"."+s.namespace:s.origType,s.selector,s.handler),this;if("object"==typeof e){for(o in e)this.off(o,n,e[o]);return this}return(n===!1||"function"==typeof n)&&(i=n,n=t),i===!1&&(i=c),this.each(function(){dt.event.remove(this,e,i,n)})},trigger:function(e,t){return this.each(function(){dt.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?dt.event.trigger(e,t,n,!0):void 0}});var jt=/^.[^:#\[\.,]*$/,Vt=/^(?:parents|prev(?:Until|All))/,zt=dt.expr.match.needsContext,Wt={children:!0,contents:!0,next:!0,prev:!0};dt.fn.extend({find:function(e){var t,n=[],i=this,s=i.length;if("string"!=typeof e)return this.pushStack(dt(e).filter(function(){for(t=0;s>t;t++)if(dt.contains(i[t],this))return!0}));for(t=0;s>t;t++)dt.find(e,i[t],n);return n=this.pushStack(s>1?dt.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t,n=dt(e,this),i=n.length;return this.filter(function(){for(t=0;i>t;t++)if(dt.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(h(this,e||[],!0))},filter:function(e){return this.pushStack(h(this,e||[],!1))},is:function(e){return!!h(this,"string"==typeof e&&zt.test(e)?dt(e):e||[],!1).length},closest:function(e,t){for(var n,i=0,s=this.length,o=[],a=zt.test(e)||"string"!=typeof e?dt(e,t||this.context):0;s>i;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&dt.find.matchesSelector(n,e))){n=o.push(n);break}return this.pushStack(o.length>1?dt.unique(o):o)},index:function(e){return e?"string"==typeof e?dt.inArray(this[0],dt(e)):dt.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?dt(e,t):dt.makeArray(e&&e.nodeType?[e]:e),i=dt.merge(this.get(),n);return this.pushStack(dt.unique(i))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),dt.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return dt.dir(e,"parentNode")},parentsUntil:function(e,t,n){return dt.dir(e,"parentNode",n)},next:function(e){return u(e,"nextSibling")},prev:function(e){return u(e,"previousSibling")},nextAll:function(e){return dt.dir(e,"nextSibling")},prevAll:function(e){return dt.dir(e,"previousSibling")},nextUntil:function(e,t,n){return dt.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return dt.dir(e,"previousSibling",n)},siblings:function(e){return dt.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return dt.sibling(e.firstChild)},contents:function(e){return dt.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:dt.merge([],e.childNodes)}},function(e,t){dt.fn[e]=function(n,i){var s=dt.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(s=dt.filter(i,s)),this.length>1&&(Wt[e]||(s=dt.unique(s)),Vt.test(e)&&(s=s.reverse())),this.pushStack(s)}}),dt.extend({filter:function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?dt.find.matchesSelector(i,e)?[i]:[]:dt.find.matches(e,dt.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,n,i){for(var s=[],o=e[n];o&&9!==o.nodeType&&(i===t||1!==o.nodeType||!dt(o).is(i));)1===o.nodeType&&s.push(o),o=o[n];return s},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var Yt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Xt=/ jQuery\d+="(?:null|\d+)"/g,Gt=new RegExp("<(?:"+Yt+")[\\s/>]","i"),Jt=/^\s+/,Kt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,qt=/<([\w:]+)/,Zt=/<tbody/i,Qt=/<|&#?\w+;/,en=/<(?:script|style|link)/i,tn=/^(?:checkbox|radio)$/i,nn=/checked\s*(?:[^=]|=\s*.checked.)/i,sn=/^$|\/(?:java|ecma)script/i,on=/^true\/(.*)/,an=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,rn={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:dt.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},ln=p(K),cn=ln.appendChild(K.createElement("div"));rn.optgroup=rn.option,rn.tbody=rn.tfoot=rn.colgroup=rn.caption=rn.thead,rn.th=rn.td,dt.fn.extend({text:function(e){return dt.access(this,function(e){return e===t?dt.text(this):this.empty().append((this[0]&&this[0].ownerDocument||K).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=f(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=f(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,i=e?dt.filter(e,this):this,s=0;null!=(n=i[s]);s++)t||1!==n.nodeType||dt.cleanData(S(n)),n.parentNode&&(t&&dt.contains(n.ownerDocument,n)&&v(S(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&dt.cleanData(S(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&dt.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return dt.clone(this,e,t)})},html:function(e){return dt.access(this,function(e){var n=this[0]||{},i=0,s=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(Xt,""):t;if(!("string"!=typeof e||en.test(e)||!dt.support.htmlSerialize&&Gt.test(e)||!dt.support.leadingWhitespace&&Jt.test(e)||rn[(qt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Kt,"<$1></$2>");try{for(;s>i;i++)n=this[i]||{},1===n.nodeType&&(dt.cleanData(S(n,!1)),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=dt.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var i=e[t++],s=e[t++];s&&(i&&i.parentNode!==s&&(i=this.nextSibling),dt(this).remove(),s.insertBefore(n,i))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=it.apply([],e);var i,s,o,a,r,l,c=0,d=this.length,u=this,h=d-1,p=e[0],f=dt.isFunction(p);if(f||!(1>=d||"string"!=typeof p||dt.support.checkClone)&&nn.test(p))return this.each(function(i){var s=u.eq(i);f&&(e[0]=p.call(this,i,s.html())),s.domManip(e,t,n)});if(d&&(l=dt.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=l.firstChild,1===l.childNodes.length&&(l=i),i)){for(a=dt.map(S(l,"script"),m),o=a.length;d>c;c++)s=l,c!==h&&(s=dt.clone(s,!0,!0),o&&dt.merge(a,S(s,"script"))),t.call(this[c],s,c);if(o)for(r=a[a.length-1].ownerDocument,dt.map(a,g),c=0;o>c;c++)s=a[c],sn.test(s.type||"")&&!dt._data(s,"globalEval")&&dt.contains(r,s)&&(s.src?dt._evalUrl(s.src):dt.globalEval((s.text||s.textContent||s.innerHTML||"").replace(an,"")));l=i=null}return this}}),dt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){dt.fn[e]=function(e){for(var n,i=0,s=[],o=dt(e),a=o.length-1;a>=i;i++)n=i===a?this:this.clone(!0),dt(o[i])[t](n),st.apply(s,n.get());return this.pushStack(s)}}),dt.extend({clone:function(e,t,n){var i,s,o,a,r,l=dt.contains(e.ownerDocument,e);if(dt.support.html5Clone||dt.isXMLDoc(e)||!Gt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(cn.innerHTML=e.outerHTML,cn.removeChild(o=cn.firstChild)),!(dt.support.noCloneEvent&&dt.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||dt.isXMLDoc(e)))for(i=S(o),r=S(e),a=0;null!=(s=r[a]);++a)i[a]&&b(s,i[a]);if(t)if(n)for(r=r||S(e),i=i||S(o),a=0;null!=(s=r[a]);a++)y(s,i[a]);else y(e,o);return i=S(o,"script"),i.length>0&&v(i,!l&&S(e,"script")),i=r=s=null,o},buildFragment:function(e,t,n,i){for(var s,o,a,r,l,c,d,u=e.length,h=p(t),f=[],m=0;u>m;m++)if(o=e[m],o||0===o)if("object"===dt.type(o))dt.merge(f,o.nodeType?[o]:o);else if(Qt.test(o)){for(r=r||h.appendChild(t.createElement("div")),l=(qt.exec(o)||["",""])[1].toLowerCase(),d=rn[l]||rn._default,r.innerHTML=d[1]+o.replace(Kt,"<$1></$2>")+d[2],s=d[0];s--;)r=r.lastChild;if(!dt.support.leadingWhitespace&&Jt.test(o)&&f.push(t.createTextNode(Jt.exec(o)[0])),!dt.support.tbody)for(o="table"!==l||Zt.test(o)?"<table>"!==d[1]||Zt.test(o)?0:r:r.firstChild,s=o&&o.childNodes.length;s--;)dt.nodeName(c=o.childNodes[s],"tbody")&&!c.childNodes.length&&o.removeChild(c);for(dt.merge(f,r.childNodes),r.textContent="";r.firstChild;)r.removeChild(r.firstChild);r=h.lastChild}else f.push(t.createTextNode(o));for(r&&h.removeChild(r),dt.support.appendChecked||dt.grep(S(f,"input"),E),m=0;o=f[m++];)if((!i||-1===dt.inArray(o,i))&&(a=dt.contains(o.ownerDocument,o),r=S(h.appendChild(o),"script"),a&&v(r),n))for(s=0;o=r[s++];)sn.test(o.type||"")&&n.push(o);return r=null,h},cleanData:function(e,t){for(var n,i,s,o,a=0,r=dt.expando,l=dt.cache,c=dt.support.deleteExpando,d=dt.event.special;null!=(n=e[a]);a++)if((t||dt.acceptData(n))&&(s=n[r],o=s&&l[s])){if(o.events)for(i in o.events)d[i]?dt.event.remove(n,i):dt.removeEvent(n,i,o.handle);l[s]&&(delete l[s],c?delete n[r]:typeof n.removeAttribute!==G?n.removeAttribute(r):n[r]=null,tt.push(s))}},_evalUrl:function(e){return dt.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),dt.fn.extend({wrapAll:function(e){if(dt.isFunction(e))return this.each(function(t){dt(this).wrapAll(e.call(this,t))});if(this[0]){var t=dt(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return this.each(dt.isFunction(e)?function(t){dt(this).wrapInner(e.call(this,t))}:function(){var t=dt(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=dt.isFunction(e);return this.each(function(n){dt(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){dt.nodeName(this,"body")||dt(this).replaceWith(this.childNodes)}).end()}});var dn,un,hn,pn=/alpha\([^)]*\)/i,fn=/opacity\s*=\s*([^)]*)/,mn=/^(top|right|bottom|left)$/,gn=/^(none|table(?!-c[ea]).+)/,vn=/^margin/,yn=new RegExp("^("+ut+")(.*)$","i"),bn=new RegExp("^("+ut+")(?!px)[a-z%]+$","i"),Sn=new RegExp("^([+-])=("+ut+")","i"),En={BODY:"block"},kn={position:"absolute",visibility:"hidden",display:"block"},Tn={letterSpacing:0,fontWeight:400},wn=["Top","Right","Bottom","Left"],_n=["Webkit","O","Moz","ms"];dt.fn.extend({css:function(e,n){return dt.access(this,function(e,n,i){var s,o,a={},r=0;if(dt.isArray(n)){for(o=un(e),s=n.length;s>r;r++)a[n[r]]=dt.css(e,n[r],!1,o);return a}return i!==t?dt.style(e,n,i):dt.css(e,n)},e,n,arguments.length>1)},show:function(){return w(this,!0)},hide:function(){return w(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:T(this))?dt(this).show():dt(this).hide()})}}),dt.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=hn(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":dt.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,i,s){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,r,l=dt.camelCase(n),c=e.style;if(n=dt.cssProps[l]||(dt.cssProps[l]=k(c,l)),r=dt.cssHooks[n]||dt.cssHooks[l],i===t)return r&&"get"in r&&(o=r.get(e,!1,s))!==t?o:c[n];if(a=typeof i,"string"===a&&(o=Sn.exec(i))&&(i=(o[1]+1)*o[2]+parseFloat(dt.css(e,n)),a="number"),!(null==i||"number"===a&&isNaN(i)||("number"!==a||dt.cssNumber[l]||(i+="px"),dt.support.clearCloneStyle||""!==i||0!==n.indexOf("background")||(c[n]="inherit"),r&&"set"in r&&(i=r.set(e,i,s))===t)))try{c[n]=i}catch(d){}}},css:function(e,n,i,s){var o,a,r,l=dt.camelCase(n);return n=dt.cssProps[l]||(dt.cssProps[l]=k(e.style,l)),r=dt.cssHooks[n]||dt.cssHooks[l],r&&"get"in r&&(a=r.get(e,!0,i)),a===t&&(a=hn(e,n,s)),"normal"===a&&n in Tn&&(a=Tn[n]),""===i||i?(o=parseFloat(a),i===!0||dt.isNumeric(o)?o||0:a):a}}),e.getComputedStyle?(un=function(t){return e.getComputedStyle(t,null)},hn=function(e,n,i){var s,o,a,r=i||un(e),l=r?r.getPropertyValue(n)||r[n]:t,c=e.style;return r&&(""!==l||dt.contains(e.ownerDocument,e)||(l=dt.style(e,n)),bn.test(l)&&vn.test(n)&&(s=c.width,o=c.minWidth,a=c.maxWidth,c.minWidth=c.maxWidth=c.width=l,l=r.width,c.width=s,c.minWidth=o,c.maxWidth=a)),l}):K.documentElement.currentStyle&&(un=function(e){return e.currentStyle},hn=function(e,n,i){var s,o,a,r=i||un(e),l=r?r[n]:t,c=e.style;return null==l&&c&&c[n]&&(l=c[n]),bn.test(l)&&!mn.test(n)&&(s=c.left,o=e.runtimeStyle,a=o&&o.left,a&&(o.left=e.currentStyle.left),c.left="fontSize"===n?"1em":l,l=c.pixelLeft+"px",c.left=s,a&&(o.left=a)),""===l?"auto":l}),dt.each(["height","width"],function(e,t){dt.cssHooks[t]={get:function(e,n,i){return n?0===e.offsetWidth&&gn.test(dt.css(e,"display"))?dt.swap(e,kn,function(){return C(e,t,i)}):C(e,t,i):void 0},set:function(e,n,i){var s=i&&un(e);return _(e,n,i?L(e,t,i,dt.support.boxSizing&&"border-box"===dt.css(e,"boxSizing",!1,s),s):0)}}}),dt.support.opacity||(dt.cssHooks.opacity={get:function(e,t){return fn.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,i=e.currentStyle,s=dt.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=i&&i.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===dt.trim(o.replace(pn,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||i&&!i.filter)||(n.filter=pn.test(o)?o.replace(pn,s):o+" "+s)}}),dt(function(){dt.support.reliableMarginRight||(dt.cssHooks.marginRight={get:function(e,t){return t?dt.swap(e,{display:"inline-block"},hn,[e,"marginRight"]):void 0}}),!dt.support.pixelPosition&&dt.fn.position&&dt.each(["top","left"],function(e,t){dt.cssHooks[t]={get:function(e,n){return n?(n=hn(e,t),bn.test(n)?dt(e).position()[t]+"px":n):void 0}}})}),dt.expr&&dt.expr.filters&&(dt.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!dt.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||dt.css(e,"display"))},dt.expr.filters.visible=function(e){return!dt.expr.filters.hidden(e)}),dt.each({margin:"",padding:"",border:"Width"},function(e,t){dt.cssHooks[e+t]={expand:function(n){for(var i=0,s={},o="string"==typeof n?n.split(" "):[n];4>i;i++)s[e+wn[i]+t]=o[i]||o[i-2]||o[0];return s}},vn.test(e)||(dt.cssHooks[e+t].set=_)});var Ln=/%20/g,Cn=/\[\]$/,In=/\r?\n/g,xn=/^(?:submit|button|image|reset|file)$/i,An=/^(?:input|select|textarea|keygen)/i;dt.fn.extend({serialize:function(){return dt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=dt.prop(this,"elements");return e?dt.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!dt(this).is(":disabled")&&An.test(this.nodeName)&&!xn.test(e)&&(this.checked||!tn.test(e))}).map(function(e,t){var n=dt(this).val();return null==n?null:dt.isArray(n)?dt.map(n,function(e){return{name:t.name,value:e.replace(In,"\r\n")}}):{name:t.name,value:n.replace(In,"\r\n")}}).get()}}),dt.param=function(e,n){var i,s=[],o=function(e,t){t=dt.isFunction(t)?t():null==t?"":t,s[s.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=dt.ajaxSettings&&dt.ajaxSettings.traditional),dt.isArray(e)||e.jquery&&!dt.isPlainObject(e))dt.each(e,function(){o(this.name,this.value)});else for(i in e)A(i,e[i],n,o);return s.join("&").replace(Ln,"+")},dt.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){dt.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),dt.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Dn,Rn,On=dt.now(),Nn=/\?/,Mn=/#.*$/,Pn=/([?&])_=[^&]*/,$n=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Bn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Hn=/^(?:GET|HEAD)$/,Fn=/^\/\//,Un=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,jn=dt.fn.load,Vn={},zn={},Wn="*/".concat("*");try{Rn=J.href}catch(Yn){Rn=K.createElement("a"),Rn.href="",Rn=Rn.href}Dn=Un.exec(Rn.toLowerCase())||[],dt.fn.load=function(e,n,i){if("string"!=typeof e&&jn)return jn.apply(this,arguments);var s,o,a,r=this,l=e.indexOf(" ");return l>=0&&(s=e.slice(l,e.length),e=e.slice(0,l)),dt.isFunction(n)?(i=n,n=t):n&&"object"==typeof n&&(a="POST"),r.length>0&&dt.ajax({url:e,type:a,dataType:"html",data:n}).done(function(e){o=arguments,r.html(s?dt("<div>").append(dt.parseHTML(e)).find(s):e)}).complete(i&&function(e,t){r.each(i,o||[e.responseText,t,e])}),this},dt.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){dt.fn[t]=function(e){return this.on(t,e)}}),dt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Rn,type:"GET",isLocal:Bn.test(Dn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Wn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":dt.parseJSON,"text xml":dt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?O(O(e,dt.ajaxSettings),t):O(dt.ajaxSettings,e)},ajaxPrefilter:D(Vn),ajaxTransport:D(zn),ajax:function(e,n){function i(e,n,i,s){var o,u,y,b,E,T=n;2!==S&&(S=2,l&&clearTimeout(l),d=t,r=s||"",k.readyState=e>0?4:0,o=e>=200&&300>e||304===e,i&&(b=N(h,k,i)),b=M(h,b,k,o),o?(h.ifModified&&(E=k.getResponseHeader("Last-Modified"),E&&(dt.lastModified[a]=E),E=k.getResponseHeader("etag"),E&&(dt.etag[a]=E)),204===e||"HEAD"===h.type?T="nocontent":304===e?T="notmodified":(T=b.state,u=b.data,y=b.error,o=!y)):(y=T,(e||!T)&&(T="error",0>e&&(e=0))),k.status=e,k.statusText=(n||T)+"",o?m.resolveWith(p,[u,T,k]):m.rejectWith(p,[k,T,y]),k.statusCode(v),v=t,c&&f.trigger(o?"ajaxSuccess":"ajaxError",[k,h,o?u:y]),g.fireWith(p,[k,T]),c&&(f.trigger("ajaxComplete",[k,h]),--dt.active||dt.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=t),n=n||{};var s,o,a,r,l,c,d,u,h=dt.ajaxSetup({},n),p=h.context||h,f=h.context&&(p.nodeType||p.jquery)?dt(p):dt.event,m=dt.Deferred(),g=dt.Callbacks("once memory"),v=h.statusCode||{},y={},b={},S=0,E="canceled",k={readyState:0,getResponseHeader:function(e){var t;if(2===S){if(!u)for(u={};t=$n.exec(r);)u[t[1].toLowerCase()]=t[2];t=u[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===S?r:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return S||(e=b[n]=b[n]||e,y[e]=t),this},overrideMimeType:function(e){return S||(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>S)for(t in e)v[t]=[v[t],e[t]];else k.always(e[k.status]);return this},abort:function(e){var t=e||E;return d&&d.abort(t),i(0,t),this}};if(m.promise(k).complete=g.add,k.success=k.done,k.error=k.fail,h.url=((e||h.url||Rn)+"").replace(Mn,"").replace(Fn,Dn[1]+"//"),h.type=n.method||n.type||h.method||h.type,h.dataTypes=dt.trim(h.dataType||"*").toLowerCase().match(ht)||[""],null==h.crossDomain&&(s=Un.exec(h.url.toLowerCase()),h.crossDomain=!(!s||s[1]===Dn[1]&&s[2]===Dn[2]&&(s[3]||("http:"===s[1]?"80":"443"))===(Dn[3]||("http:"===Dn[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=dt.param(h.data,h.traditional)),R(Vn,h,n,k),2===S)return k;c=h.global,c&&0===dt.active++&&dt.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!Hn.test(h.type),a=h.url,h.hasContent||(h.data&&(a=h.url+=(Nn.test(a)?"&":"?")+h.data,delete h.data),h.cache===!1&&(h.url=Pn.test(a)?a.replace(Pn,"$1_="+On++):a+(Nn.test(a)?"&":"?")+"_="+On++)),h.ifModified&&(dt.lastModified[a]&&k.setRequestHeader("If-Modified-Since",dt.lastModified[a]),dt.etag[a]&&k.setRequestHeader("If-None-Match",dt.etag[a])),(h.data&&h.hasContent&&h.contentType!==!1||n.contentType)&&k.setRequestHeader("Content-Type",h.contentType),k.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+Wn+"; q=0.01":""):h.accepts["*"]);for(o in h.headers)k.setRequestHeader(o,h.headers[o]);if(h.beforeSend&&(h.beforeSend.call(p,k,h)===!1||2===S))return k.abort();E="abort";for(o in{success:1,error:1,complete:1})k[o](h[o]);if(d=R(zn,h,n,k)){k.readyState=1,c&&f.trigger("ajaxSend",[k,h]),h.async&&h.timeout>0&&(l=setTimeout(function(){k.abort("timeout")},h.timeout));try{S=1,d.send(y,i)}catch(T){if(!(2>S))throw T;i(-1,T)}}else i(-1,"No Transport");return k},getJSON:function(e,t,n){return dt.get(e,t,n,"json")},getScript:function(e,n){return dt.get(e,t,n,"script")}}),dt.each(["get","post"],function(e,n){dt[n]=function(e,i,s,o){return dt.isFunction(i)&&(o=o||s,s=i,i=t),dt.ajax({url:e,type:n,dataType:o,data:i,success:s})}}),dt.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return dt.globalEval(e),e}}}),dt.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),dt.ajaxTransport("script",function(e){if(e.crossDomain){var n,i=K.head||dt("head")[0]||K.documentElement;
return{send:function(t,s){n=K.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||s(200,"success"))},i.insertBefore(n,i.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var Xn=[],Gn=/(=)\?(?=&|$)|\?\?/;dt.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Xn.pop()||dt.expando+"_"+On++;return this[e]=!0,e}}),dt.ajaxPrefilter("json jsonp",function(n,i,s){var o,a,r,l=n.jsonp!==!1&&(Gn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Gn.test(n.data)&&"data");return l||"jsonp"===n.dataTypes[0]?(o=n.jsonpCallback=dt.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,l?n[l]=n[l].replace(Gn,"$1"+o):n.jsonp!==!1&&(n.url+=(Nn.test(n.url)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return r||dt.error(o+" was not called"),r[0]},n.dataTypes[0]="json",a=e[o],e[o]=function(){r=arguments},s.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=i.jsonpCallback,Xn.push(o)),r&&dt.isFunction(a)&&a(r[0]),r=a=t}),"script"):void 0});var Jn,Kn,qn=0,Zn=e.ActiveXObject&&function(){var e;for(e in Jn)Jn[e](t,!0)};dt.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&P()||$()}:P,Kn=dt.ajaxSettings.xhr(),dt.support.cors=!!Kn&&"withCredentials"in Kn,Kn=dt.support.ajax=!!Kn,Kn&&dt.ajaxTransport(function(n){if(!n.crossDomain||dt.support.cors){var i;return{send:function(s,o){var a,r,l=n.xhr();if(n.username?l.open(n.type,n.url,n.async,n.username,n.password):l.open(n.type,n.url,n.async),n.xhrFields)for(r in n.xhrFields)l[r]=n.xhrFields[r];n.mimeType&&l.overrideMimeType&&l.overrideMimeType(n.mimeType),n.crossDomain||s["X-Requested-With"]||(s["X-Requested-With"]="XMLHttpRequest");try{for(r in s)l.setRequestHeader(r,s[r])}catch(c){}l.send(n.hasContent&&n.data||null),i=function(e,s){var r,c,d,u;try{if(i&&(s||4===l.readyState))if(i=t,a&&(l.onreadystatechange=dt.noop,Zn&&delete Jn[a]),s)4!==l.readyState&&l.abort();else{u={},r=l.status,c=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(u.text=l.responseText);try{d=l.statusText}catch(h){d=""}r||!n.isLocal||n.crossDomain?1223===r&&(r=204):r=u.text?200:404}}catch(p){s||o(-1,p)}u&&o(r,d,u,c)},n.async?4===l.readyState?setTimeout(i):(a=++qn,Zn&&(Jn||(Jn={},dt(e).unload(Zn)),Jn[a]=i),l.onreadystatechange=i):i()},abort:function(){i&&i(t,!0)}}}});var Qn,ei,ti=/^(?:toggle|show|hide)$/,ni=new RegExp("^(?:([+-])=|)("+ut+")([a-z%]*)$","i"),ii=/queueHooks$/,si=[j],oi={"*":[function(e,t){var n=this.createTween(e,t),i=n.cur(),s=ni.exec(t),o=s&&s[3]||(dt.cssNumber[e]?"":"px"),a=(dt.cssNumber[e]||"px"!==o&&+i)&&ni.exec(dt.css(n.elem,e)),r=1,l=20;if(a&&a[3]!==o){o=o||a[3],s=s||[],a=+i||1;do r=r||".5",a/=r,dt.style(n.elem,e,a+o);while(r!==(r=n.cur()/i)&&1!==r&&--l)}return s&&(n.unit=o,n.start=+a||+i||0,n.end=s[1]?a+(s[1]+1)*s[2]:+s[2]),n}]};dt.Animation=dt.extend(F,{tweener:function(e,t){dt.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,i=0,s=e.length;s>i;i++)n=e[i],oi[n]=oi[n]||[],oi[n].unshift(t)},prefilter:function(e,t){t?si.unshift(e):si.push(e)}}),dt.Tween=V,V.prototype={constructor:V,init:function(e,t,n,i,s,o){this.elem=e,this.prop=n,this.easing=s||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(dt.cssNumber[n]?"":"px")},cur:function(){var e=V.propHooks[this.prop];return e&&e.get?e.get(this):V.propHooks._default.get(this)},run:function(e){var t,n=V.propHooks[this.prop];return this.pos=t=this.options.duration?dt.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):V.propHooks._default.set(this),this}},V.prototype.init.prototype=V.prototype,V.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=dt.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){dt.fx.step[e.prop]?dt.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[dt.cssProps[e.prop]]||dt.cssHooks[e.prop])?dt.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},V.propHooks.scrollTop=V.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},dt.each(["toggle","show","hide"],function(e,t){var n=dt.fn[t];dt.fn[t]=function(e,i,s){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(z(t,!0),e,i,s)}}),dt.fn.extend({fadeTo:function(e,t,n,i){return this.filter(T).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var s=dt.isEmptyObject(e),o=dt.speed(t,n,i),a=function(){var t=F(this,dt.extend({},e),o);a.finish=function(){t.stop(!0)},(s||dt._data(this,"finish"))&&t.stop(!0)};return a.finish=a,s||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,n,i){var s=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=dt.timers,a=dt._data(this);if(n)a[n]&&a[n].stop&&s(a[n]);else for(n in a)a[n]&&a[n].stop&&ii.test(n)&&s(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(i),t=!1,o.splice(n,1));(t||!i)&&dt.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=dt._data(this),i=n[e+"queue"],s=n[e+"queueHooks"],o=dt.timers,a=i?i.length:0;for(n.finish=!0,dt.queue(this,e,[]),s&&s.cur&&s.cur.finish&&s.cur.finish.call(this),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),dt.each({slideDown:z("show"),slideUp:z("hide"),slideToggle:z("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){dt.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),dt.speed=function(e,t,n){var i=e&&"object"==typeof e?dt.extend({},e):{complete:n||!n&&t||dt.isFunction(e)&&e,duration:e,easing:n&&t||t&&!dt.isFunction(t)&&t};return i.duration=dt.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in dt.fx.speeds?dt.fx.speeds[i.duration]:dt.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){dt.isFunction(i.old)&&i.old.call(this),i.queue&&dt.dequeue(this,i.queue)},i},dt.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},dt.timers=[],dt.fx=V.prototype.init,dt.fx.tick=function(){var e,n=dt.timers,i=0;for(Qn=dt.now();i<n.length;i++)e=n[i],e()||n[i]!==e||n.splice(i--,1);n.length||dt.fx.stop(),Qn=t},dt.fx.timer=function(e){e()&&dt.timers.push(e)&&dt.fx.start()},dt.fx.interval=13,dt.fx.start=function(){ei||(ei=setInterval(dt.fx.tick,dt.fx.interval))},dt.fx.stop=function(){clearInterval(ei),ei=null},dt.fx.speeds={slow:600,fast:200,_default:400},dt.fx.step={},dt.expr&&dt.expr.filters&&(dt.expr.filters.animated=function(e){return dt.grep(dt.timers,function(t){return e===t.elem}).length}),dt.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){dt.offset.setOffset(this,e,t)});var n,i,s={top:0,left:0},o=this[0],a=o&&o.ownerDocument;if(a)return n=a.documentElement,dt.contains(n,o)?(typeof o.getBoundingClientRect!==G&&(s=o.getBoundingClientRect()),i=W(a),{top:s.top+(i.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(i.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):s},dt.offset={setOffset:function(e,t,n){var i=dt.css(e,"position");"static"===i&&(e.style.position="relative");var s,o,a=dt(e),r=a.offset(),l=dt.css(e,"top"),c=dt.css(e,"left"),d=("absolute"===i||"fixed"===i)&&dt.inArray("auto",[l,c])>-1,u={},h={};d?(h=a.position(),s=h.top,o=h.left):(s=parseFloat(l)||0,o=parseFloat(c)||0),dt.isFunction(t)&&(t=t.call(e,n,r)),null!=t.top&&(u.top=t.top-r.top+s),null!=t.left&&(u.left=t.left-r.left+o),"using"in t?t.using.call(e,u):a.css(u)}},dt.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},i=this[0];return"fixed"===dt.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),dt.nodeName(e[0],"html")||(n=e.offset()),n.top+=dt.css(e[0],"borderTopWidth",!0),n.left+=dt.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-dt.css(i,"marginTop",!0),left:t.left-n.left-dt.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||q;e&&!dt.nodeName(e,"html")&&"static"===dt.css(e,"position");)e=e.offsetParent;return e||q})}}),dt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var i=/Y/.test(n);dt.fn[e]=function(s){return dt.access(this,function(e,s,o){var a=W(e);return o===t?a?n in a?a[n]:a.document.documentElement[s]:e[s]:void(a?a.scrollTo(i?dt(a).scrollLeft():o,i?o:dt(a).scrollTop()):e[s]=o)},e,s,arguments.length,null)}}),dt.each({Height:"height",Width:"width"},function(e,n){dt.each({padding:"inner"+e,content:n,"":"outer"+e},function(i,s){dt.fn[s]=function(s,o){var a=arguments.length&&(i||"boolean"!=typeof s),r=i||(s===!0||o===!0?"margin":"border");return dt.access(this,function(n,i,s){var o;return dt.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+e],o["scroll"+e],n.body["offset"+e],o["offset"+e],o["client"+e])):s===t?dt.css(n,i,r):dt.style(n,i,s,r)},n,a?s:t,a,null)}})}),dt.fn.size=function(){return this.length},dt.fn.andSelf=dt.fn.addBack,"object"==typeof module&&"object"==typeof module.exports?module.exports=dt:(e.jQuery=e.$=dt,"function"==typeof define&&define.amd&&define("jquery",[],function(){return dt}))}(window),function(e,t){e.rails!==t&&e.error("jquery-ujs has already been loaded!");var n;e.rails=n={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",buttonClickSelector:"button[data-remote]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(t){var n=e('meta[name="csrf-token"]').attr("content");n&&t.setRequestHeader("X-CSRF-Token",n)},fire:function(t,n,i){var s=e.Event(n);return t.trigger(s,i),s.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e.attr("href")},handleRemote:function(i){var s,o,a,r,l,c,d,u;if(n.fire(i,"ajax:before")){if(r=i.data("cross-domain"),l=r===t?null:r,c=i.data("with-credentials")||null,d=i.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType,i.is("form")){s=i.attr("method"),o=i.attr("action"),a=i.serializeArray();var h=i.data("ujs:submit-button");h&&(a.push(h),i.data("ujs:submit-button",null))}else i.is(n.inputChangeSelector)?(s=i.data("method"),o=i.data("url"),a=i.serialize(),i.data("params")&&(a=a+"&"+i.data("params"))):i.is(n.buttonClickSelector)?(s=i.data("method")||"get",o=i.data("url"),a=i.serialize(),i.data("params")&&(a=a+"&"+i.data("params"))):(s=i.data("method"),o=n.href(i),a=i.data("params")||null);u={type:s||"GET",data:a,dataType:d,beforeSend:function(e,s){return s.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+s.accepts.script),n.fire(i,"ajax:beforeSend",[e,s])},success:function(e,t,n){i.trigger("ajax:success",[e,t,n])},complete:function(e,t){i.trigger("ajax:complete",[e,t])},error:function(e,t,n){i.trigger("ajax:error",[e,t,n])},crossDomain:l},c&&(u.xhrFields={withCredentials:c}),o&&(u.url=o);var p=n.ajax(u);return i.trigger("ajax:send",p),p}return!1},handleMethod:function(i){var s=n.href(i),o=i.data("method"),a=i.attr("target"),r=e("meta[name=csrf-token]").attr("content"),l=e("meta[name=csrf-param]").attr("content"),c=e('<form method="post" action="'+s+'"></form>'),d='<input name="_method" value="'+o+'" type="hidden" />';l!==t&&r!==t&&(d+='<input name="'+l+'" value="'+r+'" type="hidden" />'),a&&c.attr("target",a),c.hide().append(d).appendTo("body"),c.submit()},disableFormElements:function(t){t.find(n.disableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with",t[n]()),t[n](t.data("disable-with")),t.prop("disabled",!0)})},enableFormElements:function(t){t.find(n.enableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with")&&t[n](t.data("ujs:enable-with")),t.prop("disabled",!1)})},allowAction:function(e){var t,i=e.data("confirm"),s=!1;return i?(n.fire(e,"confirm")&&(s=n.confirm(i),t=n.fire(e,"confirm:complete",[s])),s&&t):!0},blankInputs:function(t,n,i){var s,o,a=e(),r=n||"input,textarea",l=t.find(r);return l.each(function(){if(s=e(this),o=s.is("input[type=checkbox],input[type=radio]")?s.is(":checked"):s.val(),!o==!i){if(s.is("input[type=radio]")&&l.filter('input[type=radio]:checked[name="'+s.attr("name")+'"]').length)return!0;a=a.add(s)}}),a.length?a:!1},nonBlankInputs:function(e,t){return n.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},disableElement:function(e){e.data("ujs:enable-with",e.html()),e.html(e.data("disable-with")),e.bind("click.railsDisable",function(e){return n.stopEverything(e)})},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.unbind("click.railsDisable")}},n.fire(e(document),"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,i){e.crossDomain||n.CSRFProtection(i)}),e(document).delegate(n.linkDisableSelector,"ajax:complete",function(){n.enableElement(e(this))}),e(document).delegate(n.linkClickSelector,"click.rails",function(i){var s=e(this),o=s.data("method"),a=s.data("params");if(!n.allowAction(s))return n.stopEverything(i);if(s.is(n.linkDisableSelector)&&n.disableElement(s),s.data("remote")!==t){if(!(!i.metaKey&&!i.ctrlKey||o&&"GET"!==o||a))return!0;var r=n.handleRemote(s);return r===!1?n.enableElement(s):r.error(function(){n.enableElement(s)}),!1}return s.data("method")?(n.handleMethod(s),!1):void 0}),e(document).delegate(n.buttonClickSelector,"click.rails",function(t){var i=e(this);return n.allowAction(i)?(n.handleRemote(i),!1):n.stopEverything(t)}),e(document).delegate(n.inputChangeSelector,"change.rails",function(t){var i=e(this);return n.allowAction(i)?(n.handleRemote(i),!1):n.stopEverything(t)}),e(document).delegate(n.formSubmitSelector,"submit.rails",function(i){var s=e(this),o=s.data("remote")!==t,a=n.blankInputs(s,n.requiredInputSelector),r=n.nonBlankInputs(s,n.fileInputSelector);if(!n.allowAction(s))return n.stopEverything(i);if(a&&s.attr("novalidate")==t&&n.fire(s,"ajax:aborted:required",[a]))return n.stopEverything(i);if(o){if(r){setTimeout(function(){n.disableFormElements(s)},13);var l=n.fire(s,"ajax:aborted:file",[r]);return l||setTimeout(function(){n.enableFormElements(s)},13),l}return n.handleRemote(s),!1}setTimeout(function(){n.disableFormElements(s)},13)}),e(document).delegate(n.formInputClickSelector,"click.rails",function(t){var i=e(this);if(!n.allowAction(i))return n.stopEverything(t);var s=i.attr("name"),o=s?{name:s,value:i.val()}:null;i.closest("form").data("ujs:submit-button",o)}),e(document).delegate(n.formSubmitSelector,"ajax:beforeSend.rails",function(t){this==t.target&&n.disableFormElements(e(this))}),e(document).delegate(n.formSubmitSelector,"ajax:complete.rails",function(t){this==t.target&&n.enableFormElements(e(this))}),e(function(){var t=e("meta[name=csrf-token]").attr("content"),n=e("meta[name=csrf-param]").attr("content");e('form input[name="'+n+'"]').val(t)}))}(jQuery),/**
 * Debounce and throttle function's decorator plugin 1.0.5
 *
 * Copyright (c) 2009 Filatov Dmitry (alpha@zforms.ru)
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 */
function(e){e.extend({debounce:function(e,t,n,i){3==arguments.length&&"boolean"!=typeof n&&(i=n,n=!1);var s;return function(){var o=arguments;i=i||this,n&&!s&&e.apply(i,o),clearTimeout(s),s=setTimeout(function(){n||e.apply(i,o),s=null},t)}},throttle:function(e,t,n){var i,s,o;return function(){s=arguments,o=!0,n=n||this,i||function(){o?(e.apply(n,s),o=!1,i=setTimeout(arguments.callee,t)):i=null}()}}})}(jQuery),function(){var e,t,n,i,s,o,a,r,l,c,d,u,h,p,f,m,g,v,y,b=[].slice,S=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};e=jQuery,e.payment={},e.payment.fn={},e.fn.payment=function(){var t,n;return n=arguments[0],t=2<=arguments.length?b.call(arguments,1):[],e.payment.fn[n].apply(this,t)},s=/(\d{1,4})/g,i=[{type:"maestro",pattern:/^(5018|5020|5038|6304|6759|676[1-3])/,format:s,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"dinersclub",pattern:/^(36|38|30[0-5])/,format:s,length:[14],cvcLength:[3],luhn:!0},{type:"laser",pattern:/^(6706|6771|6709)/,format:s,length:[16,17,18,19],cvcLength:[3],luhn:!0},{type:"jcb",pattern:/^35/,format:s,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^62/,format:s,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:s,length:[16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[1-5]/,format:s,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"visa",pattern:/^4/,format:s,length:[13,14,15,16],cvcLength:[3],luhn:!0}],t=function(e){var t,n,s;for(e=(e+"").replace(/\D/g,""),n=0,s=i.length;s>n;n++)if(t=i[n],t.pattern.test(e))return t},n=function(e){var t,n,s;for(n=0,s=i.length;s>n;n++)if(t=i[n],t.type===e)return t},h=function(e){var t,n,i,s,o,a;for(i=!0,s=0,n=(e+"").split("").reverse(),o=0,a=n.length;a>o;o++)t=n[o],t=parseInt(t,10),(i=!i)&&(t*=2),t>9&&(t-=9),s+=t;return s%10===0},u=function(e){var t;return null!=e.prop("selectionStart")&&e.prop("selectionStart")!==e.prop("selectionEnd")?!0:("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)&&"function"==typeof t.createRange?t.createRange().text:void 0)?!0:!1},p=function(t){return setTimeout(function(){var n,i;return n=e(t.currentTarget),i=n.val(),i=e.payment.formatCardNumber(i),n.val(i)})},r=function(n){var i,s,o,a,r,l,c;return o=String.fromCharCode(n.which),!/^\d+$/.test(o)||(i=e(n.currentTarget),c=i.val(),s=t(c+o),a=(c.replace(/\D/g,"")+o).length,l=16,s&&(l=s.length[s.length.length-1]),a>=l||null!=i.prop("selectionStart")&&i.prop("selectionStart")!==c.length)?void 0:(r=s&&"amex"===s.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/,r.test(c)?(n.preventDefault(),i.val(c+" "+o)):r.test(c+o)?(n.preventDefault(),i.val(c+o+" ")):void 0)},o=function(t){var n,i;return n=e(t.currentTarget),i=n.val(),t.meta||null!=n.prop("selectionStart")&&n.prop("selectionStart")!==i.length?void 0:8===t.which&&/\s\d?$/.test(i)?(t.preventDefault(),n.val(i.replace(/\s\d?$/,""))):void 0},l=function(t){var n,i,s;return i=String.fromCharCode(t.which),/^\d+$/.test(i)?(n=e(t.currentTarget),s=n.val()+i,/^\d$/.test(s)&&"0"!==s&&"1"!==s?(t.preventDefault(),n.val("0"+s+" / ")):/^\d\d$/.test(s)?(t.preventDefault(),n.val(""+s+" / ")):void 0):void 0},c=function(t){var n,i,s;return i=String.fromCharCode(t.which),/^\d+$/.test(i)?(n=e(t.currentTarget),s=n.val(),/^\d\d$/.test(s)?n.val(""+s+" / "):void 0):void 0},d=function(t){var n,i,s;return i=String.fromCharCode(t.which),"/"===i?(n=e(t.currentTarget),s=n.val(),/^\d$/.test(s)&&"0"!==s?n.val("0"+s+" / "):void 0):void 0},a=function(t){var n,i;if(!t.meta&&(n=e(t.currentTarget),i=n.val(),8===t.which&&(null==n.prop("selectionStart")||n.prop("selectionStart")===i.length)))return/\s\/\s?\d?$/.test(i)?(t.preventDefault(),n.val(i.replace(/\s\/\s?\d?$/,""))):void 0},v=function(e){var t;return e.metaKey||e.ctrlKey?!0:32===e.which?!1:0===e.which?!0:e.which<33?!0:(t=String.fromCharCode(e.which),!!/[\d\s]/.test(t))},m=function(n){var i,s,o,a;return i=e(n.currentTarget),o=String.fromCharCode(n.which),/^\d+$/.test(o)&&!u(i)?(a=(i.val()+o).replace(/\D/g,""),s=t(a),s?a.length<=s.length[s.length.length-1]:a.length<=16):void 0},g=function(t){var n,i,s;return n=e(t.currentTarget),i=String.fromCharCode(t.which),/^\d+$/.test(i)&&!u(n)?(s=n.val()+i,s=s.replace(/\D/g,""),s.length>6?!1:void 0):void 0},f=function(t){var n,i,s;return n=e(t.currentTarget),i=String.fromCharCode(t.which),/^\d+$/.test(i)?(s=n.val()+i,s.length<=4):void 0},y=function(t){var n,s,o,a,r;return n=e(t.currentTarget),r=n.val(),a=e.payment.cardType(r)||"unknown",n.hasClass(a)?void 0:(s=function(){var e,t,n;for(n=[],e=0,t=i.length;t>e;e++)o=i[e],n.push(o.type);return n}(),n.removeClass("unknown"),n.removeClass(s.join(" ")),n.addClass(a),n.toggleClass("identified","unknown"!==a),n.trigger("payment.cardType",a))},e.payment.fn.formatCardCVC=function(){return this.payment("restrictNumeric"),this.on("keypress",f),this},e.payment.fn.formatCardExpiry=function(){return this.payment("restrictNumeric"),this.on("keypress",g),this.on("keypress",l),this.on("keypress",d),this.on("keypress",c),this.on("keydown",a),this},e.payment.fn.formatCardNumber=function(){return this.payment("restrictNumeric"),this.on("keypress",m),this.on("keypress",r),this.on("keydown",o),this.on("keyup",y),this.on("paste",p),this},e.payment.fn.restrictNumeric=function(){return this.on("keypress",v),this},e.payment.fn.cardExpiryVal=function(){return e.payment.cardExpiryVal(e(this).val())},e.payment.cardExpiryVal=function(e){var t,n,i,s;return e=e.replace(/\s/g,""),s=e.split("/",2),t=s[0],i=s[1],2===(null!=i?i.length:void 0)&&/^\d+$/.test(i)&&(n=(new Date).getFullYear(),n=n.toString().slice(0,2),i=n+i),t=parseInt(t,10),i=parseInt(i,10),{month:t,year:i}},e.payment.validateCardNumber=function(e){var n,i;return e=(e+"").replace(/\s+|-/g,""),/^\d+$/.test(e)?(n=t(e),n?(i=e.length,S.call(n.length,i)>=0&&(n.luhn===!1||h(e))):!1):!1},e.payment.validateCardExpiry=function(t,n){var i,s,o,a;return"object"==typeof t&&"month"in t&&(a=t,t=a.month,n=a.year),t&&n?(t=e.trim(t),n=e.trim(n),/^\d+$/.test(t)&&/^\d+$/.test(n)&&parseInt(t,10)<=12?(2===n.length&&(o=(new Date).getFullYear(),o=o.toString().slice(0,2),n=o+n),s=new Date(n,t),i=new Date,s.setMonth(s.getMonth()-1),s.setMonth(s.getMonth()+1,1),s>i):!1):!1},e.payment.validateCardCVC=function(t,i){var s,o;return t=e.trim(t),/^\d+$/.test(t)?i?(s=t.length,S.call(null!=(o=n(i))?o.cvcLength:void 0,s)>=0):t.length>=3&&t.length<=4:!1},e.payment.cardType=function(e){var n;return e?(null!=(n=t(e))?n.type:void 0)||null:null},e.payment.formatCardNumber=function(e){var n,i,s,o;return(n=t(e))?(s=n.length[n.length.length-1],e=e.replace(/\D/g,""),e=e.slice(0,+s+1||9e9),n.format.global?null!=(o=e.match(n.format))?o.join(" "):void 0:(i=n.format.exec(e),null!=i&&i.shift(),null!=i?i.join(" "):void 0)):e}}.call(this),function(){var e=!1,t=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(n){function i(){!e&&this.init&&this.init.apply(this,arguments)}var s=this.prototype;e=!0;var o=new this;e=!1;for(var a in n)o[a]="function"==typeof n[a]&&"function"==typeof s[a]&&t.test(n[a])?function(e,t){return function(){var n=this._super;this._super=s[e];var i=t.apply(this,arguments);return this._super=n,i}}(a,n[a]):n[a];return i.prototype=o,i.constructor=i,i.extend=arguments.callee,i}}(),// -- kriskowal Kris Kowal Copyright (C) 2009-2010 MIT License
// -- tlrobinson Tom Robinson Copyright (C) 2009-2010 MIT License (Narwhal Project)
// -- dantman Daniel Friesen Copyright(C) 2010 XXX No License Specified
// -- fschaefer Florian Schäfer Copyright (C) 2010 MIT License
// -- Irakli Gozalishvili Copyright (C) 2010 MIT License
/*!
    Copyright (c) 2009, 280 North Inc. http://280north.com/
    MIT License. http://github.com/280north/narwhal/blob/master/README.md
*/
function(e){"function"==typeof define?define(function(){e()}):e()}(function(e){if(!Function.prototype.bind){var t=Array.prototype.slice;Function.prototype.bind=function(){function e(){if(this instanceof e){var s=Object.create(n.prototype);return n.apply(s,i.concat(t.call(arguments))),s}return n.call.apply(n,i.concat(t.call(arguments)))}var n=this;if("function"!=typeof n.apply||"function"!=typeof n.call)return new TypeError;var i=t.call(arguments);return e.length="function"==typeof n?Math.max(n.length-i.length,0):0,e}}var n,i,s,o,a,r=Function.prototype.call,l=Object.prototype,c=r.bind(l.hasOwnProperty);(a=c(l,"__defineGetter__"))&&(n=r.bind(l.__defineGetter__),i=r.bind(l.__defineSetter__),s=r.bind(l.__lookupGetter__),o=r.bind(l.__lookupSetter__)),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var n=+this.length,i=0;n>i;i++)i in this&&e.call(t,this[i],i,this)}),Array.prototype.map||(Array.prototype.map=function(e,t){var n=+this.length;if("function"!=typeof e)throw new TypeError;for(var i=Array(n),s=0;n>s;s++)s in this&&(i[s]=e.call(t,this[s],s,this));return i}),Array.prototype.filter||(Array.prototype.filter=function(e,t){for(var n=[],i=0;i<this.length;i++)e.call(t,this[i])&&n.push(this[i]);return n}),Array.prototype.every||(Array.prototype.every=function(e,t){for(var n=0;n<this.length;n++)if(!e.call(t,this[n]))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(e,t){for(var n=0;n<this.length;n++)if(e.call(t,this[n]))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(e){var t=+this.length;if("function"!=typeof e)throw new TypeError;if(0===t&&1===arguments.length)throw new TypeError;var n=0;if(arguments.length>=2)var i=arguments[1];else for(;;){if(n in this){i=this[n++];break}if(++n>=t)throw new TypeError}for(;t>n;n++)n in this&&(i=e.call(null,i,this[n],n,this));return i}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(e){var t=+this.length;if("function"!=typeof e)throw new TypeError;if(0===t&&1===arguments.length)throw new TypeError;var n;if(t-=1,arguments.length>=2)n=arguments[1];else for(;;){if(t in this){n=this[t--];break}if(--t<0)throw new TypeError}for(;t>=0;t--)t in this&&(n=e.call(null,n,this[t],t,this));return n}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n=this.length;if(!n)return-1;var i=t||0;if(i>=n)return-1;for(0>i&&(i+=n);n>i;i++)if(i in this&&e===this[i])return i;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(e,t){var n=this.length;if(!n)return-1;var i=t||n;for(0>i&&(i+=n),i=Math.min(i,n-1);i>=0;i--)if(i in this&&e===this[i])return i;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.__proto__||e.constructor.prototype}),Object.getOwnPropertyDescriptor||(Object.getOwnPropertyDescriptor=function(t,n){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("Object.getOwnPropertyDescriptor called on a non-object: "+t);if(!c(t,n))return e;var i,r,d;if(i={enumerable:!0,configurable:!0},a){var u=t.__proto__;if(t.__proto__=l,r=s(t,n),d=o(t,n),t.__proto__=u,r||d)return r&&(i.get=r),d&&(i.set=d),i}return i.value=t[n],i}),Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(e){return Object.keys(e)}),Object.create||(Object.create=function(e,t){var n;if(null===e)n={__proto__:null};else{if("object"!=typeof e)throw new TypeError("typeof prototype["+typeof e+"] != 'object'");n=function(){},n.prototype=e,n=new n,n.__proto__=e}return"undefined"!=typeof t&&Object.defineProperties(n,t),n}),Object.defineProperty||(Object.defineProperty=function(e,t,r){if("object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object.defineProperty called on non-object: "+e);if("object"!=typeof r||null===r)throw new TypeError("Property description must be an object: "+r);if(c(r,"value"))a&&(s(e,t)||o(e,t))&&(e.__proto__=l,delete e[t]),e[t]=r.value;else{if(!a)throw new TypeError("getters & setters can not be defined on this javascript engine");c(r,"get")&&n(e,t,r.get),c(r,"set")&&i(e,t,r.set)}return e}),Object.defineProperties||(Object.defineProperties=function(e,t){for(var n in t)c(t,n)&&Object.defineProperty(e,n,t[n]);return e}),Object.seal||(Object.seal=function(e){return e}),Object.freeze||(Object.freeze=function(e){return e});try{Object.freeze(function(){})}catch(d){Object.freeze=function(e){return function(t){return"function"==typeof t?t:e(t)}}(Object.freeze)}if(Object.preventExtensions||(Object.preventExtensions=function(e){return e}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(){return!0}),!Object.keys){var u,h=!0,p=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],f=p.length;for(u in{toString:null})h=!1;Object.keys=function v(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on a non-object");var t,v=[];for(t in e)c(e,t)&&v.push(t);if(h)for(t=0;f>t;t++){var n=p[t];c(e,n)&&v.push(n)}return v}}if(Date.prototype.toISOString||(Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+(this.getUTCMonth()+1)+"-"+this.getUTCDate()+"T"+this.getUTCHours()+":"+this.getUTCMinutes()+":"+this.getUTCSeconds()+"Z"}),Date.now||(Date.now=function(){return(new Date).getTime()}),Date.prototype.toJSON||(Date.prototype.toJSON=function(){if("function"!=typeof this.toISOString)throw new TypeError;return this.toISOString()}),isNaN(Date.parse("T00:00"))&&(Date=function(t){var n,i=function(e,n,s,o,a,r,l){var c=arguments.length;return this instanceof t?(c=1===c&&String(e)===e?new t(i.parse(e)):c>=7?new t(e,n,s,o,a,r,l):c>=6?new t(e,n,s,o,a,r):c>=5?new t(e,n,s,o,a):c>=4?new t(e,n,s,o):c>=3?new t(e,n,s):c>=2?new t(e,n):c>=1?new t(e):new t,c.constructor=i,c):t.apply(this,arguments)},s=RegExp("^(?:((?:[+-]\\d\\d)?\\d\\d\\d\\d)(?:-(\\d\\d)(?:-(\\d\\d))?)?)?(?:T(\\d\\d):(\\d\\d)(?::(\\d\\d)(?:\\.(\\d\\d\\d))?)?)?(?:Z|([+-])(\\d\\d):(\\d\\d))?$");for(n in t)i[n]=t[n];return i.now=t.now,i.UTC=t.UTC,i.prototype=t.prototype,i.prototype.constructor=i,i.parse=function(n){var i=s.exec(n);if(i){i.shift();for(var o=i[0]===e,a=0;10>a;a++)7!==a&&(i[a]=+(i[a]||(3>a?1:0)),1===a&&i[a]--);return o?1e3*(60*(60*i[3]+i[4])+i[5])+i[6]:(o=6e4*(60*i[8]+i[9]),"-"===i[6]&&(o=-o),t.UTC.apply(this,i.slice(0,7))+o)}return t.parse.apply(this,arguments)},i}(Date)),!String.prototype.trim){var m=/^\s\s*/,g=/\s\s*$/;String.prototype.trim=function(){return String(this).replace(m,"").replace(g,"")}}}),"undefined"==typeof document||"classList"in document.createElement("a")||!function(e){var t="classList",n="prototype",i=(e.HTMLElement||e.Element)[n],s=Object,o=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},a=Array[n].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1},r=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},l=function(e,t){if(""===t)throw new r("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new r("INVALID_CHARACTER_ERR","String contains an invalid character");return a.call(e,t)},c=function(e){for(var t=o.call(e.className),n=t?t.split(/\s+/):[],i=0,s=n.length;s>i;i++)this.push(n[i]);this._updateClassName=function(){e.className=this.toString()}},d=c[n]=[],u=function(){return new c(this)};if(r[n]=Error[n],d.item=function(e){return this[e]||null},d.contains=function(e){return e+="",-1!==l(this,e)},d.add=function(e){e+="",-1===l(this,e)&&(this.push(e),this._updateClassName())},d.remove=function(e){e+="";var t=l(this,e);-1!==t&&(this.splice(t,1),this._updateClassName())},d.toggle=function(e){e+="",-1===l(this,e)?this.add(e):this.remove(e)},d.toString=function(){return this.join(" ")},s.defineProperty){var h={get:u,enumerable:!0,configurable:!0};try{s.defineProperty(i,t,h)}catch(p){-2146823252===p.number&&(h.enumerable=!1,s.defineProperty(i,t,h))}}else s[n].__defineGetter__&&i.__defineGetter__(t,u)}(self),/**
    Head JS     The only script in your <HEAD>
    Copyright   Tero Piirainen (tipiirai)
    License     MIT / http://bit.ly/mit-license
    Version     0.96

    http://headjs.com
*/
function(e){function t(){p||(p=!0,l(m,function(e){u(e)}))}function n(t,n){var i=e.createElement("script");i.type="text/"+(t.type||"javascript"),i.src=t.src||t,i.async=!1,i.onreadystatechange=i.onload=function(){var e=i.readyState;!n.done&&(!e||/loaded|complete/.test(e))&&(n.done=!0,n())},(e.body||f).appendChild(i)}function i(e,t){return e.state==_?t&&t():e.state==w?E.ready(e.name,t):e.state==T?e.onpreload.push(function(){i(e,t)}):(e.state=w,void n(e.url,function(){e.state=_,t&&t(),l(v[e.name],function(e){u(e)}),a()&&p&&l(v.ALL,function(e){u(e)})}))}function s(e){void 0===e.state&&(e.state=T,e.onpreload=[],n({src:e.url,type:"cache"},function(){o(e)}))}function o(e){e.state=k,l(e.onpreload,function(e){e.call()})}function a(e){e=e||y;var t;for(var n in e){if(e.hasOwnProperty(n)&&e[n].state!=_)return!1;t=!0}return t}function r(e){return"[object Function]"==Object.prototype.toString.call(e)}function l(e,t){if(e){"object"==typeof e&&(e=[].slice.call(e));for(var n=0;n<e.length;n++)t.call(e,e[n],n)}}function c(e){var t;if("object"==typeof e)for(var n in e)e[n]&&(t={name:n,url:e[n]});else t={name:d(e),url:e};var i=y[t.name];return i&&i.url===t.url?i:(y[t.name]=t,t)}function d(e){var t=e.split("/"),n=t[t.length-1],i=n.indexOf("?");return-1!=i?n.substring(0,i):n}function u(e){e._done||(e(),e._done=1)}var h,p,f=e.documentElement,m=[],g=[],v={},y={},b=e.createElement("script").async===!0||"MozAppearance"in e.documentElement.style||window.opera,S=window.head_conf&&head_conf.head||"head",E=window[S]=window[S]||function(){E.ready.apply(null,arguments)},k=1,T=2,w=3,_=4;if(E.js=b?function(){var e=arguments,t=e[e.length-1],n={};return r(t)||(t=null),l(e,function(s,o){s!=t&&(s=c(s),n[s.name]=s,i(s,t&&o==e.length-2?function(){a(n)&&u(t)}:null))}),E}:function(){var e=arguments,t=[].slice.call(e,1),n=t[0];return h?(n?(l(t,function(e){r(e)||s(c(e))}),i(c(e[0]),r(n)?n:function(){E.js.apply(null,t)})):i(c(e[0])),E):(g.push(function(){E.js.apply(null,e)}),E)},E.ready=function(t,n){if(t==e)return p?u(n):m.push(n),E;if(r(t)&&(n=t,t="ALL"),"string"!=typeof t||!r(n))return E;var i=y[t];if(i&&i.state==_||"ALL"==t&&a()&&p)return u(n),E;var s=v[t];return s?s.push(n):s=v[t]=[n],E},E.ready(e,function(){a()&&l(v.ALL,function(e){u(e)}),E.feature&&E.feature("domloaded",!0)}),window.addEventListener)e.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1);else if(window.attachEvent){e.attachEvent("onreadystatechange",function(){"complete"===e.readyState&&t()});var L=1;try{L=window.frameElement}catch(C){}!L&&f.doScroll&&function(){try{f.doScroll("left"),t()}catch(e){return void setTimeout(arguments.callee,1)}}(),window.attachEvent("onload",t)}!e.readyState&&e.addEventListener&&(e.readyState="loading",e.addEventListener("DOMContentLoaded",handler=function(){e.removeEventListener("DOMContentLoaded",handler,!1),e.readyState="complete"},!1)),setTimeout(function(){h=!0,l(g,function(e){e()})},300)}(document),function(e){function t(e,t,n,i,s){this._listener=t,this._isOnce=n,this.context=i,this._signal=e,this._priority=s||0}var n={VERSION:"0.6.1"};t.prototype={active:!0,execute:function(e){var t;return this.active&&(t=this._listener.apply(this.context,e),this._isOnce&&this.detach()),t},detach:function(){return this._signal.remove(this._listener)},getListener:function(){return this._listener},dispose:function(){this.detach(),this._destroy()},_destroy:function(){delete this._signal,delete this._isOnce,delete this._listener,delete this.context},isOnce:function(){return this._isOnce},toString:function(){return"[SignalBinding isOnce: "+this._isOnce+", active: "+this.active+"]"}},n.Signal=function(){this._bindings=[]},n.Signal.prototype={_shouldPropagate:!0,active:!0,_registerListener:function(e,n,i,s){if("function"!=typeof e)throw new Error("listener is a required param of add() and addOnce() and should be a Function.");var o,a=this._indexOfListener(e);if(-1!==a){if(o=this._bindings[a],o.isOnce()!==n)throw new Error("You cannot add"+(n?"":"Once")+"() then add"+(n?"Once":"")+"() the same listener without removing the relationship first.")}else o=new t(this,e,n,i,s),this._addBinding(o);return o},_addBinding:function(e){var t=this._bindings.length;do--t;while(this._bindings[t]&&e._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,e)},_indexOfListener:function(e){for(var t=this._bindings.length;t--;)if(this._bindings[t]._listener===e)return t;return-1},add:function(e,t,n){return this._registerListener(e,!1,t,n)},addOnce:function(e,t,n){return this._registerListener(e,!0,t,n)},remove:function(e){if("function"!=typeof e)throw new Error("listener is a required param of remove() and should be a Function.");var t=this._indexOfListener(e);return-1!==t&&(this._bindings[t]._destroy(),this._bindings.splice(t,1)),e},removeAll:function(){for(var e=this._bindings.length;e--;)this._bindings[e]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var e=Array.prototype.slice.call(arguments),t=this._bindings.slice(),n=this._bindings.length;this._shouldPropagate=!0;do n--;while(t[n]&&this._shouldPropagate&&t[n].execute(e)!==!1)}},dispose:function(){this.removeAll(),delete this._bindings},toString:function(){return"[Signal active: "+this.active+" numListeners: "+this.getNumListeners()+"]"}},e.signals=n}(window||global||this);var JSON;JSON||(JSON={}),function(){"use strict";function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,i,s,o,a,r=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(l)){for(o=l.length,n=0;o>n;n+=1)a[n]=str(n,l)||"null";return s=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+r+"]":"["+a.join(",")+"]",gap=r,s}if(rep&&"object"==typeof rep)for(o=rep.length,n=0;o>n;n+=1)"string"==typeof rep[n]&&(i=rep[n],s=str(i,l),s&&a.push(quote(i)+(gap?": ":":")+s));else for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(s=str(i,l),s&&a.push(quote(i)+(gap?": ":":")+s));return s=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+r+"}":"{"+a.join(",")+"}",gap=r,s}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;n>i;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,i,s=e[t];if(s&&"object"==typeof s)for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(i=walk(s,n),void 0!==i?s[n]=i:delete s[n]);return reviver.call(e,t,s)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(e){function t(e,t){return function(n){return l(e.call(this,n),t)}}function n(e,t){return function(n){return this.lang().ordinal(e.call(this,n),t)}}function i(){}function s(e){a(this,e)}function o(e){var t=e.years||e.year||e.y||0,n=e.months||e.month||e.M||0,i=e.weeks||e.week||e.w||0,s=e.days||e.day||e.d||0,o=e.hours||e.hour||e.h||0,a=e.minutes||e.minute||e.m||0,r=e.seconds||e.second||e.s||0,l=e.milliseconds||e.millisecond||e.ms||0;this._input=e,this._milliseconds=+l+1e3*r+6e4*a+36e5*o,this._days=+s+7*i,this._months=+n+12*t,this._data={},this._bubble()}function a(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function r(e){return 0>e?Math.ceil(e):Math.floor(e)}function l(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n}function c(e,t,n,i){var s,o,a=t._milliseconds,r=t._days,l=t._months;a&&e._d.setTime(+e._d+a*n),(r||l)&&(s=e.minute(),o=e.hour()),r&&e.date(e.date()+r*n),l&&e.month(e.month()+l*n),a&&!i&&$.updateOffset(e),(r||l)&&(e.minute(s),e.hour(o))}function d(e){return"[object Array]"===Object.prototype.toString.call(e)}function u(e,t){var n,i=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),o=0;for(n=0;i>n;n++)~~e[n]!==~~t[n]&&o++;return o+s}function h(e){return e?lt[e]||e.toLowerCase().replace(/(.)s$/,"$1"):e}function p(e,t){return t.abbr=e,U[e]||(U[e]=new i),U[e].set(t),U[e]}function f(e){delete U[e]}function m(e){if(!e)return $.fn._lang;if(!U[e]&&j)try{require("./lang/"+e)}catch(t){return $.fn._lang}return U[e]||$.fn._lang}function g(e){return e.match(/\[.*\]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function v(e){var t,n,i=e.match(W);for(t=0,n=i.length;n>t;t++)i[t]=ht[i[t]]?ht[i[t]]:g(i[t]);return function(s){var o="";for(t=0;n>t;t++)o+=i[t]instanceof Function?i[t].call(s,e):i[t];return o}}function y(e,t){return t=b(t,e.lang()),ct[t]||(ct[t]=v(t)),ct[t](e)}function b(e,t){function n(e){return t.longDateFormat(e)||e}for(var i=5;i--&&(Y.lastIndex=0,Y.test(e));)e=e.replace(Y,n);return e}function S(e,t){switch(e){case"DDDD":return J;case"YYYY":return K;case"YYYYY":return q;case"S":case"SS":case"SSS":case"DDD":return G;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Z;case"a":case"A":return m(t._l)._meridiemParse;case"X":return tt;case"Z":case"ZZ":return Q;case"T":return et;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return X;default:return new RegExp(e.replace("\\",""))}}function E(e){var t=(Q.exec(e)||[])[0],n=(t+"").match(ot)||["-",0,0],i=+(60*n[1])+~~n[2];return"+"===n[0]?-i:i}function k(e,t,n){var i,s=n._a;switch(e){case"M":case"MM":null!=t&&(s[1]=~~t-1);break;case"MMM":case"MMMM":i=m(n._l).monthsParse(t),null!=i?s[1]=i:n._isValid=!1;break;case"D":case"DD":null!=t&&(s[2]=~~t);break;case"DDD":case"DDDD":null!=t&&(s[1]=0,s[2]=~~t);break;case"YY":s[0]=~~t+(~~t>68?1900:2e3);break;case"YYYY":case"YYYYY":s[0]=~~t;break;case"a":case"A":n._isPm=m(n._l).isPM(t);break;case"H":case"HH":case"h":case"hh":s[3]=~~t;break;case"m":case"mm":s[4]=~~t;break;case"s":case"ss":s[5]=~~t;break;case"S":case"SS":case"SSS":s[6]=~~(1e3*("0."+t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=E(t)}null==t&&(n._isValid=!1)}function T(e){var t,n,i,s=[];if(!e._d){for(i=_(e),t=0;3>t&&null==e._a[t];++t)e._a[t]=s[t]=i[t];for(;7>t;t++)e._a[t]=s[t]=null==e._a[t]?2===t?1:0:e._a[t];s[3]+=~~((e._tzm||0)/60),s[4]+=~~((e._tzm||0)%60),n=new Date(0),e._useUTC?(n.setUTCFullYear(s[0],s[1],s[2]),n.setUTCHours(s[3],s[4],s[5],s[6])):(n.setFullYear(s[0],s[1],s[2]),n.setHours(s[3],s[4],s[5],s[6])),e._d=n}}function w(e){var t=e._i;e._d||(e._a=[t.years||t.year||t.y,t.months||t.month||t.M,t.days||t.day||t.d,t.hours||t.hour||t.h,t.minutes||t.minute||t.m,t.seconds||t.second||t.s,t.milliseconds||t.millisecond||t.ms],T(e))}function _(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function L(e){var t,n,i,s=m(e._l),o=""+e._i;for(i=b(e._f,s).match(W),e._a=[],t=0;t<i.length;t++)n=(S(i[t],e).exec(o)||[])[0],n&&(o=o.slice(o.indexOf(n)+n.length)),ht[i[t]]&&k(i[t],n,e);o&&(e._il=o),e._isPm&&e._a[3]<12&&(e._a[3]+=12),e._isPm===!1&&12===e._a[3]&&(e._a[3]=0),T(e)}function C(e){var t,n,i,o,r,l=99;for(o=0;o<e._f.length;o++)t=a({},e),t._f=e._f[o],L(t),n=new s(t),r=u(t._a,n.toArray()),n._il&&(r+=n._il.length),l>r&&(l=r,i=n);a(e,i)}function I(e){var t,n=e._i,i=nt.exec(n);if(i){for(e._f="YYYY-MM-DD"+(i[2]||" "),t=0;4>t;t++)if(st[t][1].exec(n)){e._f+=st[t][0];break}Q.exec(n)&&(e._f+=" Z"),L(e)}else e._d=new Date(n)}function x(t){var n=t._i,i=V.exec(n);n===e?t._d=new Date:i?t._d=new Date(+i[1]):"string"==typeof n?I(t):d(n)?(t._a=n.slice(0),T(t)):n instanceof Date?t._d=new Date(+n):"object"==typeof n?w(t):t._d=new Date(n)}function A(e,t,n,i,s){return s.relativeTime(t||1,!!n,e,i)}function D(e,t,n){var i=F(Math.abs(e)/1e3),s=F(i/60),o=F(s/60),a=F(o/24),r=F(a/365),l=45>i&&["s",i]||1===s&&["m"]||45>s&&["mm",s]||1===o&&["h"]||22>o&&["hh",o]||1===a&&["d"]||25>=a&&["dd",a]||45>=a&&["M"]||345>a&&["MM",F(a/30)]||1===r&&["y"]||["yy",r];return l[2]=t,l[3]=e>0,l[4]=n,A.apply({},l)}function R(e,t,n){var i,s=n-t,o=n-e.day();return o>s&&(o-=7),s-7>o&&(o+=7),i=$(e).add("d",o),{week:Math.ceil(i.dayOfYear()/7),year:i.year()}}function O(e){var t=e._i,n=e._f;return null===t||""===t?null:("string"==typeof t&&(e._i=t=m().preparse(t)),$.isMoment(t)?(e=a({},t),e._d=new Date(+t._d)):n?d(n)?C(e):L(e):x(e),new s(e))}function N(e,t){$.fn[e]=$.fn[e+"s"]=function(e){var n=this._isUTC?"UTC":"";return null!=e?(this._d["set"+n+t](e),$.updateOffset(this),this):this._d["get"+n+t]()}}function M(e){$.duration.fn[e]=function(){return this._data[e]}}function P(e,t){$.duration.fn["as"+e]=function(){return+this/t}}for(var $,B,H="2.2.1",F=Math.round,U={},j="undefined"!=typeof module&&module.exports,V=/^\/?Date\((\-?\d+)/i,z=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)\:(\d+)\.?(\d{3})?/,W=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,Y=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,X=/\d\d?/,G=/\d{1,3}/,J=/\d{3}/,K=/\d{1,4}/,q=/[+\-]?\d{1,6}/,Z=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Q=/Z|[\+\-]\d\d:?\d\d/i,et=/T/i,tt=/[\+\-]?\d+(\.\d{1,3})?/,nt=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,it="YYYY-MM-DDTHH:mm:ssZ",st=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],ot=/([\+\-]|\d\d)/gi,at="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),rt={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},lt={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",w:"week",W:"isoweek",M:"month",y:"year"},ct={},dt="DDD w W M D d".split(" "),ut="M D H h m s w W".split(" "),ht={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return l(this.year()%100,2)},YYYY:function(){return l(this.year(),4)},YYYYY:function(){return l(this.year(),5)},gg:function(){return l(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return l(this.weekYear(),5)},GG:function(){return l(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return l(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return l(~~(this.milliseconds()/10),2)},SSS:function(){return l(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+l(~~(e/60),2)+":"+l(~~e%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+l(~~(10*e/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}};dt.length;)B=dt.pop(),ht[B+"o"]=n(ht[B],B);for(;ut.length;)B=ut.pop(),ht[B+B]=t(ht[B],2);for(ht.DDDD=t(ht.DDD,3),a(i.prototype,{set:function(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,n,i;for(this._monthsParse||(this._monthsParse=[]),t=0;12>t;t++)if(this._monthsParse[t]||(n=$.utc([2e3,t]),i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=new RegExp(i.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,n,i;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(n=$([2e3,1]).day(t),i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(i.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return"function"==typeof n?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,i){var s=this._relativeTime[n];return"function"==typeof s?s(e,t,n,i):s.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return R(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6}}),$=function(e,t,n){return O({_i:e,_f:t,_l:n,_isUTC:!1})},$.utc=function(e,t,n){return O({_useUTC:!0,_isUTC:!0,_l:n,_i:e,_f:t}).utc()},$.unix=function(e){return $(1e3*e)},$.duration=function(e,t){var n,i,s=$.isDuration(e),a="number"==typeof e,r=s?e._input:a?{}:e,l=z.exec(e);return a?t?r[t]=e:r.milliseconds=e:l&&(n="-"===l[1]?-1:1,r={y:0,d:~~l[2]*n,h:~~l[3]*n,m:~~l[4]*n,s:~~l[5]*n,ms:~~l[6]*n}),i=new o(r),s&&e.hasOwnProperty("_lang")&&(i._lang=e._lang),i},$.version=H,$.defaultFormat=it,$.updateOffset=function(){},$.lang=function(e,t){return e?(e=e.toLowerCase(),e=e.replace("_","-"),t?p(e,t):null===t?(f(e),e="en"):U[e]||m(e),void($.duration.fn._lang=$.fn._lang=m(e))):$.fn._lang._abbr},$.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),m(e)},$.isMoment=function(e){return e instanceof s},$.isDuration=function(e){return e instanceof o},a($.fn=s.prototype,{clone:function(){return $(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return y($(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return null==this._isValid&&(this._isValid=this._a?!u(this._a,(this._isUTC?$.utc(this._a):$(this._a)).toArray()):!isNaN(this._d.getTime())),!!this._isValid},invalidAt:function(){var e,t=this._a,n=(this._isUTC?$.utc(this._a):$(this._a)).toArray();for(e=6;e>=0&&t[e]===n[e];--e);return e},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(e){var t=y(this,e||$.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var n;return n="string"==typeof e?$.duration(+t,e):$.duration(e,t),c(this,n,1),this},subtract:function(e,t){var n;return n="string"==typeof e?$.duration(+t,e):$.duration(e,t),c(this,n,-1),this},diff:function(e,t,n){var i,s,o=this._isUTC?$(e).zone(this._offset||0):$(e).local(),a=6e4*(this.zone()-o.zone());return t=h(t),"year"===t||"month"===t?(i=432e5*(this.daysInMonth()+o.daysInMonth()),s=12*(this.year()-o.year())+(this.month()-o.month()),s+=(this-$(this).startOf("month")-(o-$(o).startOf("month")))/i,s-=6e4*(this.zone()-$(this).startOf("month").zone()-(o.zone()-$(o).startOf("month").zone()))/i,"year"===t&&(s/=12)):(i=this-o,s="second"===t?i/1e3:"minute"===t?i/6e4:"hour"===t?i/36e5:"day"===t?(i-a)/864e5:"week"===t?(i-a)/6048e5:i),n?s:r(s)},from:function(e,t){return $.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from($(),e)},calendar:function(){var e=this.diff($().zone(this.zone()).startOf("day"),"days",!0),t=-6>e?"sameElse":-1>e?"lastWeek":0>e?"lastDay":1>e?"sameDay":2>e?"nextDay":7>e?"nextWeek":"sameElse";return this.format(this.lang().calendar(t,this))},isLeapYear:function(){var e=this.year();return 0===e%4&&0!==e%100||0===e%400},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?"string"==typeof e&&(e=this.lang().weekdaysParse(e),"number"!=typeof e)?this:this.add({d:e-t}):t},month:function(e){var t,n=this._isUTC?"UTC":"";return null!=e?"string"==typeof e&&(e=this.lang().monthsParse(e),"number"!=typeof e)?this:(t=this.date(),this.date(1),this._d["set"+n+"Month"](e),this.date(Math.min(t,this.daysInMonth())),$.updateOffset(this),this):this._d["get"+n+"Month"]()},startOf:function(e){switch(e=h(e)){case"year":this.month(0);case"month":this.date(1);case"week":case"isoweek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e?this.weekday(0):"isoweek"===e&&this.isoWeekday(1),this},endOf:function(e){return e=h(e),this.startOf(e).add("isoweek"===e?"week":e,1).subtract("ms",1)},isAfter:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)>+$(e).startOf(t)},isBefore:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)<+$(e).startOf(t)},isSame:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)===+$(e).startOf(t)},min:function(e){return e=$.apply(null,arguments),this>e?this:e},max:function(e){return e=$.apply(null,arguments),e>this?this:e},zone:function(e){var t=this._offset||0;return null==e?this._isUTC?t:this._d.getTimezoneOffset():("string"==typeof e&&(e=E(e)),Math.abs(e)<16&&(e=60*e),this._offset=e,this._isUTC=!0,t!==e&&c(this,$.duration(t-e,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},hasAlignedHourOffset:function(e){return e=e?$(e).zone():0,0===(this.zone()-e)%60},daysInMonth:function(){return $.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(e){var t=F(($(this).startOf("day")-$(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},weekYear:function(e){var t=R(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==e?t:this.add("y",e-t)},isoWeekYear:function(e){var t=R(this,1,4).year;return null==e?t:this.add("y",e-t)},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},isoWeek:function(e){var t=R(this,1,4).week;return null==e?t:this.add("d",7*(e-t))},weekday:function(e){var t=(this._d.getDay()+7-this.lang()._week.dow)%7;return null==e?t:this.add("d",e-t)},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},get:function(e){return e=h(e),this[e.toLowerCase()]()},set:function(e,t){e=h(e),this[e.toLowerCase()](t)},lang:function(t){return t===e?this._lang:(this._lang=m(t),this)}}),B=0;B<at.length;B++)N(at[B].toLowerCase().replace(/s$/,""),at[B]);N("year","FullYear"),$.fn.days=$.fn.day,$.fn.months=$.fn.month,$.fn.weeks=$.fn.week,$.fn.isoWeeks=$.fn.isoWeek,$.fn.toJSON=$.fn.toISOString,a($.duration.fn=o.prototype,{_bubble:function(){var e,t,n,i,s=this._milliseconds,o=this._days,a=this._months,l=this._data;l.milliseconds=s%1e3,e=r(s/1e3),l.seconds=e%60,t=r(e/60),l.minutes=t%60,n=r(t/60),l.hours=n%24,o+=r(n/24),l.days=o%30,a+=r(o/30),l.months=a%12,i=r(a/12),l.years=i},weeks:function(){return r(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*(this._months%12)+31536e6*~~(this._months/12)},humanize:function(e){var t=+this,n=D(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},add:function(e,t){var n=$.duration(e,t);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(e,t){var n=$.duration(e,t);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(e){return e=h(e),this[e.toLowerCase()+"s"]()},as:function(e){return e=h(e),this["as"+e.charAt(0).toUpperCase()+e.slice(1)+"s"]()},lang:$.fn.lang});for(B in rt)rt.hasOwnProperty(B)&&(P(B,rt[B]),M(B.toLowerCase()));P("Weeks",6048e5),$.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},$.lang("en",{ordinal:function(e){var t=e%10,n=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),j&&(module.exports=$),"undefined"==typeof ender&&(this.moment=$),"function"==typeof define&&define.amd&&define("moment",[],function(){return $})}.call(this),/*!
 * Copyright (c) 2011-2013 Felix Gnass
 * Licensed under the MIT license
 */
function(e,t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Spinner=t()}(this,function(){"use strict";function e(e,t){var n,i=document.createElement(e||"div");for(n in t)i[n]=t[n];return i}function t(e){for(var t=1,n=arguments.length;n>t;t++)e.appendChild(arguments[t]);return e}function n(e,t,n,i){var s=["opacity",t,~~(100*e),n,i].join("-"),o=.01+n/i*100,a=Math.max(1-(1-e)/t*(100-o),e),r=c.substring(0,c.indexOf("Animation")).toLowerCase(),l=r&&"-"+r+"-"||"";return u[s]||(h.insertRule("@"+l+"keyframes "+s+"{0%{opacity:"+a+"}"+o+"%{opacity:"+e+"}"+(o+.01)+"%{opacity:1}"+(o+t)%100+"%{opacity:"+e+"}100%{opacity:"+a+"}}",h.cssRules.length),u[s]=1),s}function i(e,t){var n,i,s=e.style;if(void 0!==s[t])return t;for(t=t.charAt(0).toUpperCase()+t.slice(1),i=0;i<d.length;i++)if(n=d[i]+t,void 0!==s[n])return n}function s(e,t){for(var n in t)e.style[i(e,n)||n]=t[n];return e}function o(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)void 0===e[i]&&(e[i]=n[i])}return e}function a(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e=e.offsetParent;)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function r(e){return"undefined"==typeof this?new r(e):void(this.opts=o(e||{},r.defaults,p))}function l(){function n(t,n){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',n)}h.addRule(".spin-vml","behavior:url(#default#VML)"),r.prototype.lines=function(e,i){function o(){return s(n("group",{coordsize:c+" "+c,coordorigin:-l+" "+-l}),{width:c,height:c})}function a(e,a,r){t(u,t(s(o(),{rotation:360/i.lines*e+"deg",left:~~a}),t(s(n("roundrect",{arcsize:i.corners}),{width:l,height:i.width,left:i.radius,top:-i.width>>1,filter:r}),n("fill",{color:i.color,opacity:i.opacity}),n("stroke",{opacity:0}))))}var r,l=i.length+i.width,c=2*l,d=2*-(i.width+i.length)+"px",u=s(o(),{position:"absolute",top:d,left:d});if(i.shadow)for(r=1;r<=i.lines;r++)a(r,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(r=1;r<=i.lines;r++)a(r);return t(e,u)},r.prototype.opacity=function(e,t,n,i){var s=e.firstChild;i=i.shadow&&i.lines||0,s&&t+i<s.childNodes.length&&(s=s.childNodes[t+i],s=s&&s.firstChild,s=s&&s.firstChild,s&&(s.opacity=n))}}var c,d=["webkit","Moz","ms","O"],u={},h=function(){var n=e("style",{type:"text/css"});return t(document.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}(),p={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};r.defaults={},o(r.prototype,{spin:function(t){this.stop();var n,i,o=this,r=o.opts,l=o.el=s(e(0,{className:r.className}),{position:r.position,width:0,zIndex:r.zIndex}),d=r.radius+r.length+r.width;if(t&&(t.insertBefore(l,t.firstChild||null),i=a(t),n=a(l),s(l,{left:("auto"==r.left?i.x-n.x+(t.offsetWidth>>1):parseInt(r.left,10)+d)+"px",top:("auto"==r.top?i.y-n.y+(t.offsetHeight>>1):parseInt(r.top,10)+d)+"px"})),l.setAttribute("role","progressbar"),o.lines(l,o.opts),!c){var u,h=0,p=(r.lines-1)*(1-r.direction)/2,f=r.fps,m=f/r.speed,g=(1-r.opacity)/(m*r.trail/100),v=m/r.lines;!function y(){h++;for(var e=0;e<r.lines;e++)u=Math.max(1-(h+(r.lines-e)*v)%m*g,r.opacity),o.opacity(l,e*r.direction+p,u,r);o.timeout=o.el&&setTimeout(y,~~(1e3/f))}()}return o},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(i,o){function a(t,n){return s(e(),{position:"absolute",width:o.length+o.width+"px",height:o.width+"px",background:t,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/o.lines*l+o.rotate)+"deg) translate("+o.radius+"px,0)",borderRadius:(o.corners*o.width>>1)+"px"})}for(var r,l=0,d=(o.lines-1)*(1-o.direction)/2;l<o.lines;l++)r=s(e(),{position:"absolute",top:1+~(o.width/2)+"px",transform:o.hwaccel?"translate3d(0,0,0)":"",opacity:o.opacity,animation:c&&n(o.opacity,o.trail,d+l*o.direction,o.lines)+" "+1/o.speed+"s linear infinite"}),o.shadow&&t(r,s(a("#000","0 0 4px #000"),{top:"2px"})),t(i,t(r,a(o.color,"0 0 1px rgba(0,0,0,.1)")));return i},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}});var f=s(e("group"),{behavior:"url(#default#VML)"});return!i(f,"transform")&&f.adj?l():c=i(f,"animation"),r}),/*!
 * Ladda 0.7.0
 * http://lab.hakim.se/ladda
 * MIT licensed
 *
 * Copyright (C) 2013 Hakim El Hattab, http://hakim.se
 */
function(e,t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define(["spin"],t):e.Ladda=t(e.Spinner)}(this,function(e){"use strict";function t(e){if("undefined"==typeof e)return void console.warn("Ladda button target must be defined.");e.querySelector(".ladda-label")||(e.innerHTML='<span class="ladda-label">'+e.innerHTML+"</span>");var t=s(e),n=document.createElement("span");n.className="ladda-spinner",e.appendChild(n);var i,o={start:function(){return e.setAttribute("disabled",""),e.setAttribute("data-loading",""),clearTimeout(i),t.spin(n),this.setProgress(0),this},startAfter:function(e){return clearTimeout(i),i=setTimeout(function(){o.start()},e),this},stop:function(){return e.removeAttribute("disabled"),e.removeAttribute("data-loading"),clearTimeout(i),i=setTimeout(function(){t.stop()},1e3),this},toggle:function(){return this.isLoading()?this.stop():this.start(),this},setProgress:function(t){t=Math.max(Math.min(t,1),0);var n=e.querySelector(".ladda-progress");0===t&&n&&n.parentNode?n.parentNode.removeChild(n):(n||(n=document.createElement("div"),n.className="ladda-progress",e.appendChild(n)),n.style.width=(t||0)*e.offsetWidth+"px")},enable:function(){return this.stop(),this},disable:function(){return this.stop(),e.setAttribute("disabled",""),this},isLoading:function(){return e.hasAttribute("data-loading")}};return a.push(o),o}function n(e,n){n=n||{};var i=[];"string"==typeof e?i=o(document.querySelectorAll(e)):"object"==typeof e&&"string"==typeof e.nodeName&&(i=[e]);for(var s=0,a=i.length;a>s;s++)!function(){var e=i[s];if("function"==typeof e.addEventListener){var o=t(e),a=-1;e.addEventListener("click",function(){o.startAfter(1),"number"==typeof n.timeout&&(clearTimeout(a),a=setTimeout(o.stop,n.timeout)),"function"==typeof n.callback&&n.callback.apply(null,[o])},!1)}}()}function i(){for(var e=0,t=a.length;t>e;e++)a[e].stop()}function s(t){var n,i=t.offsetHeight;i>32&&(i*=.8),t.hasAttribute("data-spinner-size")&&(i=parseInt(t.getAttribute("data-spinner-size"),10)),t.hasAttribute("data-spinner-color")&&(n=t.getAttribute("data-spinner-color"));var s=12,o=.2*i,a=.6*o,r=7>o?2:3;return new e({color:n||"#fff",lines:s,radius:o,length:a,width:r,zIndex:"initial",top:"auto",left:"auto",className:""})}function o(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}var a=[];return{bind:n,create:t,stopAll:i}}),/*! Hammer.JS - v1.0.7 - 2014-03-11
 * http://eightmedia.github.com/hammer.js
 *
 * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
 * Licensed under the MIT license */
function(e,t){"use strict";function n(){i.READY||(i.event.determineEventTypes(),i.utils.each(i.gestures,function(e){i.detection.register(e)}),i.event.onTouch(i.DOCUMENT,i.EVENT_MOVE,i.detection.detect),i.event.onTouch(i.DOCUMENT,i.EVENT_END,i.detection.detect),i.READY=!0)}var i=function(e,t){return new i.Instance(e,t||{})};i.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},i.HAS_POINTEREVENTS=e.navigator.pointerEnabled||e.navigator.msPointerEnabled,i.HAS_TOUCHEVENTS="ontouchstart"in e,i.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,i.NO_MOUSEEVENTS=i.HAS_TOUCHEVENTS&&e.navigator.userAgent.match(i.MOBILE_REGEX),i.EVENT_TYPES={},i.DIRECTION_DOWN="down",i.DIRECTION_LEFT="left",i.DIRECTION_UP="up",i.DIRECTION_RIGHT="right",i.POINTER_MOUSE="mouse",i.POINTER_TOUCH="touch",i.POINTER_PEN="pen",i.UPDATE_VELOCITY_INTERVAL=16,i.EVENT_START="start",i.EVENT_MOVE="move",i.EVENT_END="end",i.DOCUMENT=e.document,i.plugins=i.plugins||{},i.gestures=i.gestures||{},i.READY=!1,i.utils={extend:function(e,n,i){for(var s in n)e[s]!==t&&i||(e[s]=n[s]);return e},each:function(e,n,i){var s,o;if("forEach"in e)e.forEach(n,i);else if(e.length!==t){for(s=-1;o=e[++s];)if(n.call(i,o,s,e)===!1)return}else for(s in e)if(e.hasOwnProperty(s)&&n.call(i,e[s],s,e)===!1)return},hasParent:function(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1},getCenter:function(e){var t=[],n=[];return i.utils.each(e,function(e){t.push("undefined"!=typeof e.clientX?e.clientX:e.pageX),n.push("undefined"!=typeof e.clientY?e.clientY:e.pageY)}),{pageX:(Math.min.apply(Math,t)+Math.max.apply(Math,t))/2,pageY:(Math.min.apply(Math,n)+Math.max.apply(Math,n))/2}},getVelocity:function(e,t,n){return{x:Math.abs(t/e)||0,y:Math.abs(n/e)||0}},getAngle:function(e,t){var n=t.pageY-e.pageY,i=t.pageX-e.pageX;return 180*Math.atan2(n,i)/Math.PI},getDirection:function(e,t){var n=Math.abs(e.pageX-t.pageX),s=Math.abs(e.pageY-t.pageY);return n>=s?e.pageX-t.pageX>0?i.DIRECTION_LEFT:i.DIRECTION_RIGHT:e.pageY-t.pageY>0?i.DIRECTION_UP:i.DIRECTION_DOWN},getDistance:function(e,t){var n=t.pageX-e.pageX,i=t.pageY-e.pageY;return Math.sqrt(n*n+i*i)},getScale:function(e,t){return e.length>=2&&t.length>=2?this.getDistance(t[0],t[1])/this.getDistance(e[0],e[1]):1},getRotation:function(e,t){return e.length>=2&&t.length>=2?this.getAngle(t[1],t[0])-this.getAngle(e[1],e[0]):0},isVertical:function(e){return e==i.DIRECTION_UP||e==i.DIRECTION_DOWN},toggleDefaultBehavior:function(e,t,n){t&&e&&e.style&&(i.utils.each(["webkit","moz","Moz","ms","o",""],function(s){i.utils.each(t,function(t,i){s&&(i=s+i.substring(0,1).toUpperCase()+i.substring(1)),i in e.style&&(e.style[i]=!n&&t)})}),"none"==t.userSelect&&(e.onselectstart=!n&&function(){return!1}),"none"==t.userDrag&&(e.ondragstart=!n&&function(){return!1}))}},i.Instance=function(e,t){var s=this;return n(),this.element=e,this.enabled=!0,this.options=i.utils.extend(i.utils.extend({},i.defaults),t||{}),this.options.stop_browser_behavior&&i.utils.toggleDefaultBehavior(this.element,this.options.stop_browser_behavior,!1),this.eventStartHandler=i.event.onTouch(e,i.EVENT_START,function(e){s.enabled&&i.detection.startDetect(s,e)}),this.eventHandlers=[],this},i.Instance.prototype={on:function(e,t){var n=e.split(" ");return i.utils.each(n,function(e){this.element.addEventListener(e,t,!1),this.eventHandlers.push({gesture:e,handler:t})},this),this},off:function(e,t){var n,s,o=e.split(" ");return i.utils.each(o,function(e){for(this.element.removeEventListener(e,t,!1),n=-1;s=this.eventHandlers[++n];)s.gesture===e&&s.handler===t&&this.eventHandlers.splice(n,1)},this),this},trigger:function(e,t){t||(t={});var n=i.DOCUMENT.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t;var s=this.element;return i.utils.hasParent(t.target,s)&&(s=t.target),s.dispatchEvent(n),this},enable:function(e){return this.enabled=e,this},dispose:function(){var e,t;for(this.options.stop_browser_behavior&&i.utils.toggleDefaultBehavior(this.element,this.options.stop_browser_behavior,!0),e=-1;t=this.eventHandlers[++e];)this.element.removeEventListener(t.gesture,t.handler,!1);return this.eventHandlers=[],i.event.unbindDom(this.element,i.EVENT_TYPES[i.EVENT_START],this.eventStartHandler),null}};var s=null,o=!1,a=!1;i.event={bindDom:function(e,t,n){var s=t.split(" ");i.utils.each(s,function(t){e.addEventListener(t,n,!1)})},unbindDom:function(e,t,n){var s=t.split(" ");i.utils.each(s,function(t){e.removeEventListener(t,n,!1)})},onTouch:function(e,t,n){var r=this,l=function(l){var c=l.type.toLowerCase();if(!c.match(/mouse/)||!a){c.match(/touch/)||c.match(/pointerdown/)||c.match(/mouse/)&&1===l.which?o=!0:c.match(/mouse/)&&!l.which&&(o=!1),c.match(/touch|pointer/)&&(a=!0);var d=0;o&&(i.HAS_POINTEREVENTS&&t!=i.EVENT_END?d=i.PointerEvent.updatePointer(t,l):c.match(/touch/)?d=l.touches.length:a||(d=c.match(/up/)?0:1),d>0&&t==i.EVENT_END?t=i.EVENT_MOVE:d||(t=i.EVENT_END),(d||null===s)&&(s=l),n.call(i.detection,r.collectEventData(e,t,r.getTouchList(s,t),l)),i.HAS_POINTEREVENTS&&t==i.EVENT_END&&(d=i.PointerEvent.updatePointer(t,l))),d||(s=null,o=!1,a=!1,i.PointerEvent.reset())}};return this.bindDom(e,i.EVENT_TYPES[t],l),l},determineEventTypes:function(){var e;e=i.HAS_POINTEREVENTS?i.PointerEvent.getEvents():i.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],i.EVENT_TYPES[i.EVENT_START]=e[0],i.EVENT_TYPES[i.EVENT_MOVE]=e[1],i.EVENT_TYPES[i.EVENT_END]=e[2]},getTouchList:function(e){return i.HAS_POINTEREVENTS?i.PointerEvent.getTouchList():e.touches?e.touches:(e.identifier=1,[e])},collectEventData:function(e,t,n,s){var o=i.POINTER_TOUCH;return(s.type.match(/mouse/)||i.PointerEvent.matchType(i.POINTER_MOUSE,s))&&(o=i.POINTER_MOUSE),{center:i.utils.getCenter(n),timeStamp:(new Date).getTime(),target:s.target,touches:n,eventType:t,pointerType:o,srcEvent:s,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return i.detection.stopDetect()}}}},i.PointerEvent={pointers:{},getTouchList:function(){var e=this,t=[];return i.utils.each(e.pointers,function(e){t.push(e)}),t},updatePointer:function(e,t){return e==i.EVENT_END?delete this.pointers[t.pointerId]:(t.identifier=t.pointerId,this.pointers[t.pointerId]=t),Object.keys(this.pointers).length},matchType:function(e,t){if(!t.pointerType)return!1;var n=t.pointerType,s={};return s[i.POINTER_MOUSE]=n===t.MSPOINTER_TYPE_MOUSE||n===i.POINTER_MOUSE,s[i.POINTER_TOUCH]=n===t.MSPOINTER_TYPE_TOUCH||n===i.POINTER_TOUCH,s[i.POINTER_PEN]=n===t.MSPOINTER_TYPE_PEN||n===i.POINTER_PEN,s[e]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},i.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(e,t){this.current||(this.stopped=!1,this.current={inst:e,startEvent:i.utils.extend({},t),lastEvent:!1,lastVEvent:!1,velocity:!1,name:""},this.detect(t))},detect:function(e){if(this.current&&!this.stopped){e=this.extendEventData(e);var t=this.current.inst.options;return i.utils.each(this.gestures,function(n){return this.stopped||t[n.name]===!1||n.handler.call(n,e,this.current.inst)!==!1?void 0:(this.stopDetect(),!1)},this),this.current&&(this.current.lastEvent=e),e.eventType==i.EVENT_END&&!e.touches.length-1&&this.stopDetect(),e}},stopDetect:function(){this.previous=i.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(e){var t=this.current.startEvent,n=this.current.lastVEvent;!t||e.touches.length==t.touches.length&&e.touches!==t.touches||(t.touches=[],i.utils.each(e.touches,function(e){t.touches.push(i.utils.extend({},e))}));var s,o,a=e.timeStamp-t.timeStamp,r=e.center.pageX-t.center.pageX,l=e.center.pageY-t.center.pageY,c=this.current.velocity;return n!==!1&&e.timeStamp-n.timeStamp>i.UPDATE_VELOCITY_INTERVAL?(c=i.utils.getVelocity(e.timeStamp-n.timeStamp,e.center.pageX-n.center.pageX,e.center.pageY-n.center.pageY),this.current.lastVEvent=e,c.x>0&&c.y>0&&(this.current.velocity=c)):this.current.velocity===!1&&(c=i.utils.getVelocity(a,r,l),this.current.velocity=c,this.current.lastVEvent=e),e.eventType==i.EVENT_END?(s=this.current.lastEvent&&this.current.lastEvent.interimAngle,o=this.current.lastEvent&&this.current.lastEvent.interimDirection):(s=this.current.lastEvent&&i.utils.getAngle(this.current.lastEvent.center,e.center),o=this.current.lastEvent&&i.utils.getDirection(this.current.lastEvent.center,e.center)),i.utils.extend(e,{deltaTime:a,deltaX:r,deltaY:l,velocityX:c.x,velocityY:c.y,distance:i.utils.getDistance(t.center,e.center),angle:i.utils.getAngle(t.center,e.center),interimAngle:s,direction:i.utils.getDirection(t.center,e.center),interimDirection:o,scale:i.utils.getScale(t.touches,e.touches),rotation:i.utils.getRotation(t.touches,e.touches),startEvent:t}),e},register:function(e){var n=e.defaults||{};return n[e.name]===t&&(n[e.name]=!0),i.utils.extend(i.defaults,n,!0),e.index=e.index||1e3,this.gestures.push(e),this.gestures.sort(function(e,t){return e.index<t.index?-1:e.index>t.index?1:0}),this.gestures}},i.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(e,t){if(i.detection.current.name!=this.name&&this.triggered)return t.trigger(this.name+"end",e),void(this.triggered=!1);if(!(t.options.drag_max_touches>0&&e.touches.length>t.options.drag_max_touches))switch(e.eventType){case i.EVENT_START:this.triggered=!1;break;case i.EVENT_MOVE:if(e.distance<t.options.drag_min_distance&&i.detection.current.name!=this.name)return;if(i.detection.current.name!=this.name&&(i.detection.current.name=this.name,t.options.correct_for_drag_min_distance&&e.distance>0)){var n=Math.abs(t.options.drag_min_distance/e.distance);i.detection.current.startEvent.center.pageX+=e.deltaX*n,i.detection.current.startEvent.center.pageY+=e.deltaY*n,e=i.detection.extendEventData(e)}(i.detection.current.lastEvent.drag_locked_to_axis||t.options.drag_lock_to_axis&&t.options.drag_lock_min_distance<=e.distance)&&(e.drag_locked_to_axis=!0);var s=i.detection.current.lastEvent.direction;e.drag_locked_to_axis&&s!==e.direction&&(e.direction=i.utils.isVertical(s)?e.deltaY<0?i.DIRECTION_UP:i.DIRECTION_DOWN:e.deltaX<0?i.DIRECTION_LEFT:i.DIRECTION_RIGHT),this.triggered||(t.trigger(this.name+"start",e),this.triggered=!0),t.trigger(this.name,e),t.trigger(this.name+e.direction,e);var o=i.utils.isVertical(e.direction);(t.options.drag_block_vertical&&o||t.options.drag_block_horizontal&&!o)&&e.preventDefault();break;case i.EVENT_END:this.triggered&&t.trigger(this.name+"end",e),this.triggered=!1}}},i.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(e,t){switch(e.eventType){case i.EVENT_START:clearTimeout(this.timer),i.detection.current.name=this.name,this.timer=setTimeout(function(){"hold"==i.detection.current.name&&t.trigger("hold",e)},t.options.hold_timeout);break;case i.EVENT_MOVE:e.distance>t.options.hold_threshold&&clearTimeout(this.timer);break;case i.EVENT_END:clearTimeout(this.timer)}}},i.gestures.Release={name:"release",index:1/0,handler:function(e,t){e.eventType==i.EVENT_END&&t.trigger(this.name,e)}},i.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(e,t){if(e.eventType==i.EVENT_END){if(e.touches.length<t.options.swipe_min_touches||e.touches.length>t.options.swipe_max_touches)return;(e.velocityX>t.options.swipe_velocity||e.velocityY>t.options.swipe_velocity)&&(t.trigger(this.name,e),t.trigger(this.name+e.direction,e))}}},i.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},has_moved:!1,handler:function(e,t){if(e.eventType==i.EVENT_START)this.has_moved=!1;else if(e.eventType!=i.EVENT_MOVE||this.moved){if(e.eventType==i.EVENT_END&&"touchcancel"!=e.srcEvent.type&&e.deltaTime<t.options.tap_max_touchtime&&!this.has_moved){var n=i.detection.previous,s=e.timeStamp-n.lastEvent.timeStamp,o=!1;n&&"tap"==n.name&&s<t.options.doubletap_interval&&e.distance<t.options.doubletap_distance&&(t.trigger("doubletap",e),o=!0),(!o||t.options.tap_always)&&(i.detection.current.name="tap",t.trigger(i.detection.current.name,e))}}else this.has_moved=e.distance>t.options.tap_max_distance}},i.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(e,t){return t.options.prevent_mouseevents&&e.pointerType==i.POINTER_MOUSE?void e.stopDetect():(t.options.prevent_default&&e.preventDefault(),void(e.eventType==i.EVENT_START&&t.trigger(this.name,e)))}},i.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1,transform_within_instance:!1},triggered:!1,handler:function(e,t){if(i.detection.current.name!=this.name&&this.triggered)return t.trigger(this.name+"end",e),void(this.triggered=!1);if(!(e.touches.length<2)){if(t.options.transform_always_block&&e.preventDefault(),t.options.transform_within_instance)for(var n=-1;e.touches[++n];)if(!i.utils.hasParent(e.touches[n].target,t.element))return;switch(e.eventType){case i.EVENT_START:this.triggered=!1;break;case i.EVENT_MOVE:var s=Math.abs(1-e.scale),o=Math.abs(e.rotation);if(s<t.options.transform_min_scale&&o<t.options.transform_min_rotation)return;i.detection.current.name=this.name,this.triggered||(t.trigger(this.name+"start",e),this.triggered=!0),t.trigger(this.name,e),o>t.options.transform_min_rotation&&t.trigger("rotate",e),s>t.options.transform_min_scale&&(t.trigger("pinch",e),t.trigger("pinch"+(e.scale<1?"in":"out"),e));break;case i.EVENT_END:this.triggered&&t.trigger(this.name+"end",e),this.triggered=!1}}}},"function"==typeof define&&define.amd?define(function(){return i}):"object"==typeof module&&module.exports?module.exports=i:e.Hammer=i}(window);/*! Socket.IO.min.js build:0.9.16, production. Copyright(c) 2011 LearnBoost <dev@learnboost.com> MIT Licensed */
var io="undefined"==typeof module?{}:module.exports;!function(){if(function(e,t){var n=e;n.version="0.9.16",n.protocol=1,n.transports=[],n.j=[],n.sockets={},n.connect=function(e,i){var s,o,a=n.util.parseUri(e);t&&t.location&&(a.protocol=a.protocol||t.location.protocol.slice(0,-1),a.host=a.host||(t.document?t.document.domain:t.location.hostname),a.port=a.port||t.location.port),s=n.util.uniqueUri(a);var r={host:a.host,secure:"https"==a.protocol,port:a.port||("https"==a.protocol?443:80),query:a.query||""};return n.util.merge(r,i),(r["force new connection"]||!n.sockets[s])&&(o=new n.Socket(r)),!r["force new connection"]&&o&&(n.sockets[s]=o),o=o||n.sockets[s],o.of(a.path.length>1?a.path:"")}}("object"==typeof module?module.exports:this.io={},this),function(e,t){var n=e.util={},i=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,s=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];n.parseUri=function(e){for(var t=i.exec(e||""),n={},o=14;o--;)n[s[o]]=t[o]||"";return n},n.uniqueUri=function(e){var n=e.protocol,i=e.host,s=e.port;return"document"in t?(i=i||document.domain,s=s||("https"==n&&"https:"!==document.location.protocol?443:document.location.port)):(i=i||"localhost",!s&&"https"==n&&(s=443)),(n||"http")+"://"+i+":"+(s||80)},n.query=function(e,t){var i=n.chunkQuery(e||""),s=[];n.merge(i,n.chunkQuery(t||""));for(var o in i)i.hasOwnProperty(o)&&s.push(o+"="+i[o]);return s.length?"?"+s.join("&"):""},n.chunkQuery=function(e){for(var t,n={},i=e.split("&"),s=0,o=i.length;o>s;++s)t=i[s].split("="),t[0]&&(n[t[0]]=t[1]);return n};var o=!1;n.load=function(e){return"document"in t&&"complete"===document.readyState||o?e():void n.on(t,"load",e,!1)},n.on=function(e,t,n,i){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener&&e.addEventListener(t,n,i)},n.request=function(e){if(e&&"undefined"!=typeof XDomainRequest&&!n.ua.hasCORS)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!e||n.ua.hasCORS))return new XMLHttpRequest;if(!e)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}return null},"undefined"!=typeof window&&n.load(function(){o=!0}),n.defer=function(e){return n.ua.webkit&&"undefined"==typeof importScripts?void n.load(function(){setTimeout(e,100)}):e()},n.merge=function(e,t,i,s){var o,a=s||[],r="undefined"==typeof i?2:i;for(o in t)t.hasOwnProperty(o)&&n.indexOf(a,o)<0&&("object"==typeof e[o]&&r?n.merge(e[o],t[o],r-1,a):(e[o]=t[o],a.push(t[o])));return e},n.mixin=function(e,t){n.merge(e.prototype,t.prototype)},n.inherit=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.intersect=function(e,t){for(var i=[],s=e.length>t.length?e:t,o=e.length>t.length?t:e,a=0,r=o.length;r>a;a++)~n.indexOf(s,o[a])&&i.push(o[a]);return i},n.indexOf=function(e,t,n){for(var i=e.length,n=0>n?0>n+i?0:n+i:n||0;i>n&&e[n]!==t;n++);return n>=i?-1:n},n.toArray=function(e){for(var t=[],n=0,i=e.length;i>n;n++)t.push(e[n]);return t},n.ua={},n.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var e=new XMLHttpRequest}catch(t){return!1}return void 0!=e.withCredentials}(),n.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),n.ua.iDevice="undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}("undefined"!=typeof io?io:module.exports,this),function(e,t){function n(){}e.EventEmitter=n,n.prototype.on=function(e,n){return this.$events||(this.$events={}),this.$events[e]?t.util.isArray(this.$events[e])?this.$events[e].push(n):this.$events[e]=[this.$events[e],n]:this.$events[e]=n,this},n.prototype.addListener=n.prototype.on,n.prototype.once=function(e,t){function n(){i.removeListener(e,n),t.apply(this,arguments)}var i=this;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,n){if(this.$events&&this.$events[e]){var i=this.$events[e];if(t.util.isArray(i)){for(var s=-1,o=0,a=i.length;a>o;o++)if(i[o]===n||i[o].listener&&i[o].listener===n){s=o;break}if(0>s)return this;i.splice(s,1),i.length||delete this.$events[e]}else(i===n||i.listener&&i.listener===n)&&delete this.$events[e]}return this},n.prototype.removeAllListeners=function(e){return void 0===e?(this.$events={},this):(this.$events&&this.$events[e]&&(this.$events[e]=null),this)},n.prototype.listeners=function(e){return this.$events||(this.$events={}),this.$events[e]||(this.$events[e]=[]),t.util.isArray(this.$events[e])||(this.$events[e]=[this.$events[e]]),this.$events[e]},n.prototype.emit=function(e){if(!this.$events)return!1;var n=this.$events[e];if(!n)return!1;var i=Array.prototype.slice.call(arguments,1);if("function"==typeof n)n.apply(this,i);else{if(!t.util.isArray(n))return!1;for(var s=n.slice(),o=0,a=s.length;a>o;o++)s[o].apply(this,i)}return!0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,nativeJSON){function f(e){return 10>e?"0"+e:e}function date(e){return isFinite(e.valueOf())?e.getUTCFullYear()+"-"+f(e.getUTCMonth()+1)+"-"+f(e.getUTCDate())+"T"+f(e.getUTCHours())+":"+f(e.getUTCMinutes())+":"+f(e.getUTCSeconds())+"Z":null}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,i,s,o,a,r=gap,l=t[e];switch(l instanceof Date&&(l=date(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(l)){for(o=l.length,n=0;o>n;n+=1)a[n]=str(n,l)||"null";return s=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+r+"]":"["+a.join(",")+"]",gap=r,s}if(rep&&"object"==typeof rep)for(o=rep.length,n=0;o>n;n+=1)"string"==typeof rep[n]&&(i=rep[n],s=str(i,l),s&&a.push(quote(i)+(gap?": ":":")+s));else for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(s=str(i,l),s&&a.push(quote(i)+(gap?": ":":")+s));return s=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+r+"}":"{"+a.join(",")+"}",gap=r,s}}if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(e,t,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;n>i;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,!t||"function"==typeof t||"object"==typeof t&&"number"==typeof t.length)return str("",{"":e});throw new Error("JSON.stringify")},JSON.parse=function(text,reviver){function walk(e,t){var n,i,s=e[t];if(s&&"object"==typeof s)for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(i=walk(s,n),void 0!==i?s[n]=i:delete s[n]);return reviver.call(e,t,s)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof JSON?JSON:void 0),function(e,t){var n=e.parser={},i=n.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],s=n.reasons=["transport not supported","client not handshaken","unauthorized"],o=n.advice=["reconnect"],a=t.JSON,r=t.util.indexOf;n.encodePacket=function(e){var t=r(i,e.type),n=e.id||"",l=e.endpoint||"",c=e.ack,d=null;switch(e.type){case"error":var u=e.reason?r(s,e.reason):"",h=e.advice?r(o,e.advice):"";(""!==u||""!==h)&&(d=u+(""!==h?"+"+h:""));break;case"message":""!==e.data&&(d=e.data);break;case"event":var p={name:e.name};e.args&&e.args.length&&(p.args=e.args),d=a.stringify(p);break;case"json":d=a.stringify(e.data);break;case"connect":e.qs&&(d=e.qs);break;case"ack":d=e.ackId+(e.args&&e.args.length?"+"+a.stringify(e.args):"")}var f=[t,n+("data"==c?"+":""),l];return null!==d&&void 0!==d&&f.push(d),f.join(":")},n.encodePayload=function(e){var t="";if(1==e.length)return e[0];for(var n=0,i=e.length;i>n;n++){var s=e[n];t+="\ufffd"+s.length+"\ufffd"+e[n]}return t};var l=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;n.decodePacket=function(e){var t=e.match(l);if(!t)return{};var n=t[2]||"",e=t[5]||"",r={type:i[t[1]],endpoint:t[4]||""};switch(n&&(r.id=n,r.ack=t[3]?"data":!0),r.type){case"error":var t=e.split("+");r.reason=s[t[0]]||"",r.advice=o[t[1]]||"";break;case"message":r.data=e||"";break;case"event":try{var c=a.parse(e);r.name=c.name,r.args=c.args}catch(d){}r.args=r.args||[];break;case"json":try{r.data=a.parse(e)}catch(d){}break;case"connect":r.qs=e||"";break;case"ack":var t=e.match(/^([0-9]+)(\+)?(.*)/);if(t&&(r.ackId=t[1],r.args=[],t[3]))try{r.args=t[3]?a.parse(t[3]):[]}catch(d){}break;case"disconnect":case"heartbeat":}return r},n.decodePayload=function(e){if("\ufffd"==e.charAt(0)){for(var t=[],i=1,s="";i<e.length;i++)"\ufffd"==e.charAt(i)?(t.push(n.decodePacket(e.substr(i+1).substr(0,s))),i+=Number(s)+1,s=""):s+=e.charAt(i);return t}return[n.decodePacket(e)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t){function n(e,t){this.socket=e,this.sessid=t}e.Transport=n,t.util.mixin(n,t.EventEmitter),n.prototype.heartbeats=function(){return!0},n.prototype.onData=function(e){if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==e){var n=t.parser.decodePayload(e);if(n&&n.length)for(var i=0,s=n.length;s>i;i++)this.onPacket(n[i])}return this},n.prototype.onPacket=function(e){return this.socket.setHeartbeatTimeout(),"heartbeat"==e.type?this.onHeartbeat():("connect"==e.type&&""==e.endpoint&&this.onConnect(),"error"==e.type&&"reconnect"==e.advice&&(this.isOpen=!1),this.socket.onPacket(e),this)},n.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var e=this;this.closeTimeout=setTimeout(function(){e.onDisconnect()},this.socket.closeTimeout)}},n.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},n.prototype.onConnect=function(){return this.socket.onConnect(),this},n.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},n.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},n.prototype.packet=function(e){this.send(t.parser.encodePacket(e))},n.prototype.onHeartbeat=function(){this.packet({type:"heartbeat"})},n.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},n.prototype.onClose=function(){this.isOpen=!1,this.socket.onClose(),this.onDisconnect()},n.prototype.prepareUrl=function(){var e=this.socket.options;return this.scheme()+"://"+e.host+":"+e.port+"/"+e.resource+"/"+t.protocol+"/"+this.name+"/"+this.sessid},n.prototype.ready=function(e,t){t.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function i(e){if(this.options={port:80,secure:!1,document:"document"in n?document:!1,resource:"socket.io",transports:t.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,manualFlush:!1},t.util.merge(this.options,e),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||t.util.ua.hasCORS)){var i=this;t.util.on(n,"beforeunload",function(){i.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function s(){}e.Socket=i,t.util.mixin(i,t.EventEmitter),i.prototype.of=function(e){return this.namespaces[e]||(this.namespaces[e]=new t.SocketNamespace(this,e),""!==e&&this.namespaces[e].packet({type:"connect"})),this.namespaces[e]},i.prototype.publish=function(){this.emit.apply(this,arguments);var e;for(var t in this.namespaces)this.namespaces.hasOwnProperty(t)&&(e=this.of(t),e.$emit.apply(e,arguments))},i.prototype.handshake=function(e){function n(t){t instanceof Error?(i.connecting=!1,i.onError(t.message)):e.apply(null,t.split(":"))}var i=this,o=this.options,a=["http"+(o.secure?"s":"")+":/",o.host+":"+o.port,o.resource,t.protocol,t.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!t.util.ua.hasCORS){var r=document.getElementsByTagName("script")[0],l=document.createElement("script");l.src=a+"&jsonp="+t.j.length,r.parentNode.insertBefore(l,r),t.j.push(function(e){n(e),l.parentNode.removeChild(l)})}else{var c=t.util.request();c.open("GET",a,!0),this.isXDomain()&&(c.withCredentials=!0),c.onreadystatechange=function(){4==c.readyState&&(c.onreadystatechange=s,200==c.status?n(c.responseText):403==c.status?i.onError(c.responseText):(i.connecting=!1,!i.reconnecting&&i.onError(c.responseText)))},c.send(null)}},i.prototype.getTransport=function(e){for(var n,i=e||this.transports,s=0;n=i[s];s++)if(t.Transport[n]&&t.Transport[n].check(this)&&(!this.isXDomain()||t.Transport[n].xdomainCheck(this)))return new t.Transport[n](this,this.sessionid);return null},i.prototype.connect=function(e){if(this.connecting)return this;var n=this;return n.connecting=!0,this.handshake(function(i,s,o,a){function r(e){return n.transport&&n.transport.clearTimeouts(),n.transport=n.getTransport(e),n.transport?void n.transport.ready(n,function(){n.connecting=!0,n.publish("connecting",n.transport.name),n.transport.open(),n.options["connect timeout"]&&(n.connectTimeoutTimer=setTimeout(function(){if(!n.connected&&(n.connecting=!1,n.options["try multiple transports"])){for(var e=n.transports;e.length>0&&e.splice(0,1)[0]!=n.transport.name;);e.length?r(e):n.publish("connect_failed")}},n.options["connect timeout"]))}):n.publish("connect_failed")}n.sessionid=i,n.closeTimeout=1e3*o,n.heartbeatTimeout=1e3*s,n.transports||(n.transports=n.origTransports=a?t.util.intersect(a.split(","),n.options.transports):n.options.transports),n.setHeartbeatTimeout(),r(n.transports),n.once("connect",function(){clearTimeout(n.connectTimeoutTimer),e&&"function"==typeof e&&e()})}),this},i.prototype.setHeartbeatTimeout=function(){if(clearTimeout(this.heartbeatTimeoutTimer),!this.transport||this.transport.heartbeats()){var e=this;this.heartbeatTimeoutTimer=setTimeout(function(){e.transport.onClose()},this.heartbeatTimeout)}},i.prototype.packet=function(e){return this.connected&&!this.doBuffer?this.transport.packet(e):this.buffer.push(e),this},i.prototype.setBuffer=function(e){this.doBuffer=e,!e&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},i.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},i.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this},i.prototype.disconnectSync=function(){var e=t.util.request(),n=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,t.protocol,"",this.sessionid].join("/")+"/?disconnect=1";e.open("GET",n,!1),e.send(null),this.onDisconnect("booted")},i.prototype.isXDomain=function(){var e=n.location.port||("https:"==n.location.protocol?443:80);return this.options.host!==n.location.hostname||this.options.port!=e},i.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},i.prototype.onOpen=function(){this.open=!0},i.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},i.prototype.onPacket=function(e){this.of(e.endpoint).onPacket(e)},i.prototype.onError=function(e){e&&e.advice&&"reconnect"===e.advice&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",e&&e.reason?e.reason:e)},i.prototype.onDisconnect=function(e){var t=this.connected,n=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1,(t||n)&&(this.transport.close(),this.transport.clearTimeouts(),t&&(this.publish("disconnect",e),"booted"!=e&&this.options.reconnect&&!this.reconnecting&&this.reconnect()))},i.prototype.reconnect=function(){function e(){if(n.connected){for(var e in n.namespaces)n.namespaces.hasOwnProperty(e)&&""!==e&&n.namespaces[e].packet({type:"connect"});n.publish("reconnect",n.transport.name,n.reconnectionAttempts)}clearTimeout(n.reconnectionTimer),n.removeListener("connect_failed",t),n.removeListener("connect",t),n.reconnecting=!1,delete n.reconnectionAttempts,delete n.reconnectionDelay,delete n.reconnectionTimer,delete n.redoTransports,n.options["try multiple transports"]=s}function t(){return n.reconnecting?n.connected?e():n.connecting&&n.reconnecting?n.reconnectionTimer=setTimeout(t,1e3):void(n.reconnectionAttempts++>=i?n.redoTransports?(n.publish("reconnect_failed"),e()):(n.on("connect_failed",t),n.options["try multiple transports"]=!0,n.transports=n.origTransports,n.transport=n.getTransport(),n.redoTransports=!0,n.connect()):(n.reconnectionDelay<o&&(n.reconnectionDelay*=2),n.connect(),n.publish("reconnecting",n.reconnectionDelay,n.reconnectionAttempts),n.reconnectionTimer=setTimeout(t,n.reconnectionDelay))):void 0}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var n=this,i=this.options["max reconnection attempts"],s=this.options["try multiple transports"],o=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(t,this.reconnectionDelay),this.on("connect",t)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(e,t){this.socket=e,this.name=t||"",this.flags={},this.json=new i(this,"json"),this.ackPackets=0,this.acks={}}function i(e,t){this.namespace=e,this.name=t}e.SocketNamespace=n,t.util.mixin(n,t.EventEmitter),n.prototype.$emit=t.EventEmitter.prototype.emit,n.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},n.prototype.packet=function(e){return e.endpoint=this.name,this.socket.packet(e),this.flags={},this},n.prototype.send=function(e,t){var n={type:this.flags.json?"json":"message",data:e};return"function"==typeof t&&(n.id=++this.ackPackets,n.ack=!0,this.acks[n.id]=t),this.packet(n)},n.prototype.emit=function(e){var t=Array.prototype.slice.call(arguments,1),n=t[t.length-1],i={type:"event",name:e};return"function"==typeof n&&(i.id=++this.ackPackets,i.ack="data",this.acks[i.id]=n,t=t.slice(0,t.length-1)),i.args=t,this.packet(i)},n.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},n.prototype.onPacket=function(e){function n(){i.packet({type:"ack",args:t.util.toArray(arguments),ackId:e.id})}var i=this;switch(e.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(e.reason||"booted"):this.$emit("disconnect",e.reason);break;case"message":case"json":var s=["message",e.data];"data"==e.ack?s.push(n):e.ack&&this.packet({type:"ack",ackId:e.id}),this.$emit.apply(this,s);break;case"event":var s=[e.name].concat(e.args);"data"==e.ack&&s.push(n),this.$emit.apply(this,s);break;case"ack":this.acks[e.ackId]&&(this.acks[e.ackId].apply(this,e.args),delete this.acks[e.ackId]);break;case"error":e.advice?this.socket.onError(e):"unauthorized"==e.reason?this.$emit("connect_failed",e.reason):this.$emit("error",e.reason)}},i.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},i.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function i(){t.Transport.apply(this,arguments)}e.websocket=i,t.util.inherit(i,t.Transport),i.prototype.name="websocket",i.prototype.open=function(){var e,i=t.util.query(this.socket.options.query),s=this;return e||(e=n.MozWebSocket||n.WebSocket),this.websocket=new e(this.prepareUrl()+i),this.websocket.onopen=function(){s.onOpen(),s.socket.setBuffer(!1)},this.websocket.onmessage=function(e){s.onData(e.data)},this.websocket.onclose=function(){s.onClose(),s.socket.setBuffer(!0)},this.websocket.onerror=function(e){s.onError(e)},this},i.prototype.send=t.util.ua.iDevice?function(e){var t=this;return setTimeout(function(){t.websocket.send(e)},0),this}:function(e){return this.websocket.send(e),this},i.prototype.payload=function(e){for(var t=0,n=e.length;n>t;t++)this.packet(e[t]);return this},i.prototype.close=function(){return this.websocket.close(),this},i.prototype.onError=function(e){this.socket.onError(e)},i.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},i.check=function(){return"WebSocket"in n&&!("__addTask"in WebSocket)||"MozWebSocket"in n},i.xdomainCheck=function(){return!0},t.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(){t.Transport.websocket.apply(this,arguments)}e.flashsocket=n,t.util.inherit(n,t.Transport.websocket),n.prototype.name="flashsocket",n.prototype.open=function(){var e=this,n=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.open.apply(e,n)}),this},n.prototype.send=function(){var e=this,n=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.send.apply(e,n)}),this},n.prototype.close=function(){return WebSocket.__tasks.length=0,t.Transport.websocket.prototype.close.call(this),this},n.prototype.ready=function(e,i){function s(){var t=e.options,s=t["flash policy port"],a=["http"+(t.secure?"s":"")+":/",t.host+":"+t.port,t.resource,"static/flashsocket","WebSocketMain"+(e.isXDomain()?"Insecure":"")+".swf"];n.loaded||("undefined"==typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=a.join("/")),843!==s&&WebSocket.loadFlashPolicyFile("xmlsocket://"+t.host+":"+s),WebSocket.__initialize(),n.loaded=!0),i.call(o)}var o=this;return document.body?s():void t.util.load(s)},n.check=function(){return"undefined"!=typeof WebSocket&&"__initialize"in WebSocket&&swfobject?swfobject.getFlashPlayerVersion().major>=10:!1},n.xdomainCheck=function(){return!0},"undefined"!=typeof window&&(WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0),t.transports.push("flashsocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),"undefined"!=typeof window)var swfobject=function(){function e(){if(!V){try{var e=P.getElementsByTagName("body")[0].appendChild(g("span"));e.parentNode.removeChild(e)}catch(t){return}V=!0;for(var n=H.length,i=0;n>i;i++)H[i]()}}function t(e){V?e():H[H.length]=e}function n(e){if(typeof M.addEventListener!=I)M.addEventListener("load",e,!1);else if(typeof P.addEventListener!=I)P.addEventListener("load",e,!1);else if(typeof M.attachEvent!=I)v(M,"onload",e);else if("function"==typeof M.onload){var t=M.onload;M.onload=function(){t(),e()}}else M.onload=e}function i(){B?s():o()}function s(){var e=P.getElementsByTagName("body")[0],t=g(x);t.setAttribute("type",R);var n=e.appendChild(t);if(n){var i=0;!function(){if(typeof n.GetVariable!=I){var s=n.GetVariable("$version");s&&(s=s.split(" ")[1].split(","),Y.pv=[parseInt(s[0],10),parseInt(s[1],10),parseInt(s[2],10)])}else if(10>i)return i++,void setTimeout(arguments.callee,10);e.removeChild(t),n=null,o()}()}else o()}function o(){var e=F.length;if(e>0)for(var t=0;e>t;t++){var n=F[t].id,i=F[t].callbackFn,s={success:!1,id:n};if(Y.pv[0]>0){var o=m(n);if(o)if(!y(F[t].swfVersion)||Y.wk&&Y.wk<312)if(F[t].expressInstall&&r()){var d={};d.data=F[t].expressInstall,d.width=o.getAttribute("width")||"0",d.height=o.getAttribute("height")||"0",o.getAttribute("class")&&(d.styleclass=o.getAttribute("class")),o.getAttribute("align")&&(d.align=o.getAttribute("align"));for(var u={},h=o.getElementsByTagName("param"),p=h.length,f=0;p>f;f++)"movie"!=h[f].getAttribute("name").toLowerCase()&&(u[h[f].getAttribute("name")]=h[f].getAttribute("value"));l(d,u,n,i)}else c(o),i&&i(s);else S(n,!0),i&&(s.success=!0,s.ref=a(n),i(s))}else if(S(n,!0),i){var g=a(n);g&&typeof g.SetVariable!=I&&(s.success=!0,s.ref=g),i(s)}}}function a(e){var t=null,n=m(e);if(n&&"OBJECT"==n.nodeName)if(typeof n.SetVariable!=I)t=n;else{var i=n.getElementsByTagName(x)[0];i&&(t=i)}return t}function r(){return!z&&y("6.0.65")&&(Y.win||Y.mac)&&!(Y.wk&&Y.wk<312)}function l(e,t,n,i){z=!0,w=i||null,_={success:!1,id:n};var s=m(n);if(s){"OBJECT"==s.nodeName?(k=d(s),T=null):(k=s,T=n),e.id=O,(typeof e.width==I||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==I||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),P.title=P.title.slice(0,47)+" - Flash Player Installation";var o=Y.ie&&Y.win?["Active"].concat("").join("X"):"PlugIn",a="MMredirectURL="+M.location.toString().replace(/&/g,"%26")+"&MMplayerType="+o+"&MMdoctitle="+P.title;if(typeof t.flashvars!=I?t.flashvars+="&"+a:t.flashvars=a,Y.ie&&Y.win&&4!=s.readyState){var r=g("div");n+="SWFObjectNew",r.setAttribute("id",n),s.parentNode.insertBefore(r,s),s.style.display="none",function(){4==s.readyState?s.parentNode.removeChild(s):setTimeout(arguments.callee,10)}()}u(e,t,n)}}function c(e){if(Y.ie&&Y.win&&4!=e.readyState){var t=g("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(d(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(d(e),e)}function d(e){var t=g("div");if(Y.win&&Y.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(x)[0];if(n){var i=n.childNodes;if(i)for(var s=i.length,o=0;s>o;o++)(1!=i[o].nodeType||"PARAM"!=i[o].nodeName)&&8!=i[o].nodeType&&t.appendChild(i[o].cloneNode(!0))}}return t}function u(e,t,n){var i,s=m(n);if(Y.wk&&Y.wk<312)return i;if(s)if(typeof e.id==I&&(e.id=n),Y.ie&&Y.win){var o="";for(var a in e)e[a]!=Object.prototype[a]&&("data"==a.toLowerCase()?t.movie=e[a]:"styleclass"==a.toLowerCase()?o+=' class="'+e[a]+'"':"classid"!=a.toLowerCase()&&(o+=" "+a+'="'+e[a]+'"'));var r="";for(var l in t)t[l]!=Object.prototype[l]&&(r+='<param name="'+l+'" value="'+t[l]+'" />');s.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+o+">"+r+"</object>",U[U.length]=e.id,i=m(e.id)}else{var c=g(x);c.setAttribute("type",R);for(var d in e)e[d]!=Object.prototype[d]&&("styleclass"==d.toLowerCase()?c.setAttribute("class",e[d]):"classid"!=d.toLowerCase()&&c.setAttribute(d,e[d]));for(var u in t)t[u]!=Object.prototype[u]&&"movie"!=u.toLowerCase()&&h(c,u,t[u]);s.parentNode.replaceChild(c,s),i=c}return i}function h(e,t,n){var i=g("param");i.setAttribute("name",t),i.setAttribute("value",n),e.appendChild(i)}function p(e){var t=m(e);t&&"OBJECT"==t.nodeName&&(Y.ie&&Y.win?(t.style.display="none",function(){4==t.readyState?f(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function f(e){var t=m(e);if(t){for(var n in t)"function"==typeof t[n]&&(t[n]=null);t.parentNode.removeChild(t)}}function m(e){var t=null;try{t=P.getElementById(e)}catch(n){}return t}function g(e){return P.createElement(e)}function v(e,t,n){e.attachEvent(t,n),j[j.length]=[e,t,n]}function y(e){var t=Y.pv,n=e.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?!0:!1}function b(e,t,n,i){if(!Y.ie||!Y.mac){var s=P.getElementsByTagName("head")[0];if(s){var o=n&&"string"==typeof n?n:"screen";if(i&&(L=null,C=null),!L||C!=o){var a=g("style");a.setAttribute("type","text/css"),a.setAttribute("media",o),L=s.appendChild(a),Y.ie&&Y.win&&typeof P.styleSheets!=I&&P.styleSheets.length>0&&(L=P.styleSheets[P.styleSheets.length-1]),C=o}Y.ie&&Y.win?L&&typeof L.addRule==x&&L.addRule(e,t):L&&typeof P.createTextNode!=I&&L.appendChild(P.createTextNode(e+" {"+t+"}"))}}}function S(e,t){if(W){var n=t?"visible":"hidden";V&&m(e)?m(e).style.visibility=n:b("#"+e,"visibility:"+n)}}function E(e){var t=/[\\\"<>\.;]/,n=null!=t.exec(e);return n&&typeof encodeURIComponent!=I?encodeURIComponent(e):e}{var k,T,w,_,L,C,I="undefined",x="object",A="Shockwave Flash",D="ShockwaveFlash.ShockwaveFlash",R="application/x-shockwave-flash",O="SWFObjectExprInst",N="onreadystatechange",M=window,P=document,$=navigator,B=!1,H=[i],F=[],U=[],j=[],V=!1,z=!1,W=!0,Y=function(){var e=typeof P.getElementById!=I&&typeof P.getElementsByTagName!=I&&typeof P.createElement!=I,t=$.userAgent.toLowerCase(),n=$.platform.toLowerCase(),i=/win/.test(n?n:t),s=/mac/.test(n?n:t),o=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,a=!1,r=[0,0,0],l=null;if(typeof $.plugins!=I&&typeof $.plugins[A]==x)l=$.plugins[A].description,l&&(typeof $.mimeTypes==I||!$.mimeTypes[R]||!!$.mimeTypes[R].enabledPlugin)&&(B=!0,a=!1,l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),r[0]=parseInt(l.replace(/^(.*)\..*$/,"$1"),10),r[1]=parseInt(l.replace(/^.*\.(.*)\s.*$/,"$1"),10),r[2]=/[a-zA-Z]/.test(l)?parseInt(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof M[["Active"].concat("Object").join("X")]!=I)try{var c=new(window[["Active"].concat("Object").join("X")])(D);c&&(l=c.GetVariable("$version"),l&&(a=!0,l=l.split(" ")[1].split(","),r=[parseInt(l[0],10),parseInt(l[1],10),parseInt(l[2],10)]))}catch(d){}return{w3:e,pv:r,wk:o,ie:a,win:i,mac:s}}();!function(){Y.w3&&((typeof P.readyState!=I&&"complete"==P.readyState||typeof P.readyState==I&&(P.getElementsByTagName("body")[0]||P.body))&&e(),V||(typeof P.addEventListener!=I&&P.addEventListener("DOMContentLoaded",e,!1),Y.ie&&Y.win&&(P.attachEvent(N,function(){"complete"==P.readyState&&(P.detachEvent(N,arguments.callee),e())}),M==top&&function(){if(!V){try{P.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}e()}}()),Y.wk&&function(){return V?void 0:/loaded|complete/.test(P.readyState)?void e():void setTimeout(arguments.callee,0)}(),n(e)))}(),function(){Y.ie&&Y.win&&window.attachEvent("onunload",function(){for(var e=j.length,t=0;e>t;t++)j[t][0].detachEvent(j[t][1],j[t][2]);for(var n=U.length,i=0;n>i;i++)p(U[i]);for(var s in Y)Y[s]=null;Y=null;for(var o in swfobject)swfobject[o]=null;swfobject=null})}()}return{registerObject:function(e,t,n,i){if(Y.w3&&e&&t){var s={};s.id=e,s.swfVersion=t,s.expressInstall=n,s.callbackFn=i,F[F.length]=s,S(e,!1)}else i&&i({success:!1,id:e})},getObjectById:function(e){return Y.w3?a(e):void 0},embedSWF:function(e,n,i,s,o,a,c,d,h,p){var f={success:!1,id:n};Y.w3&&!(Y.wk&&Y.wk<312)&&e&&n&&i&&s&&o?(S(n,!1),t(function(){i+="",s+="";var t={};if(h&&typeof h===x)for(var m in h)t[m]=h[m];t.data=e,t.width=i,t.height=s;var g={};if(d&&typeof d===x)for(var v in d)g[v]=d[v];if(c&&typeof c===x)for(var b in c)typeof g.flashvars!=I?g.flashvars+="&"+b+"="+c[b]:g.flashvars=b+"="+c[b];if(y(o)){var E=u(t,g,n);t.id==n&&S(n,!0),f.success=!0,f.ref=E}else{if(a&&r())return t.data=a,void l(t,g,n,p);S(n,!0)}p&&p(f)})):p&&p(f)},switchOffAutoHideShow:function(){W=!1},ua:Y,getFlashPlayerVersion:function(){return{major:Y.pv[0],minor:Y.pv[1],release:Y.pv[2]}},hasFlashPlayerVersion:y,createSWF:function(e,t,n){return Y.w3?u(e,t,n):void 0},showExpressInstall:function(e,t,n,i){Y.w3&&r()&&l(e,t,n,i)},removeSWF:function(e){Y.w3&&p(e)},createCSS:function(e,t,n,i){Y.w3&&b(e,t,n,i)},addDomLoadEvent:t,addLoadEvent:n,getQueryParamValue:function(e){var t=P.location.search||P.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return E(t);for(var n=t.split("&"),i=0;i<n.length;i++)if(n[i].substring(0,n[i].indexOf("="))==e)return E(n[i].substring(n[i].indexOf("=")+1))}return""},expressInstallCallback:function(){if(z){var e=m(O);e&&k&&(e.parentNode.replaceChild(k,e),T&&(S(T,!0),Y.ie&&Y.win&&(k.style.display="block")),w&&w(_)),z=!1
}}}}();!function(){if("undefined"!=typeof window&&!window.WebSocket){var e=window.console;return e&&e.log&&e.error||(e={log:function(){},error:function(){}}),swfobject.hasFlashPlayerVersion("10.0.0")?("file:"==location.protocol&&e.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(e,t,n,i,s){var o=this;o.__id=WebSocket.__nextId++,WebSocket.__instances[o.__id]=o,o.readyState=WebSocket.CONNECTING,o.bufferedAmount=0,o.__events={},t?"string"==typeof t&&(t=[t]):t=[],setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(o.__id,e,t,n||null,i||0,s||null)})},0)},WebSocket.prototype.send=function(e){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";var t=WebSocket.__flash.send(this.__id,encodeURIComponent(e));return 0>t?!0:(this.bufferedAmount+=t,!1)},WebSocket.prototype.close=function(){this.readyState!=WebSocket.CLOSED&&this.readyState!=WebSocket.CLOSING&&(this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id))},WebSocket.prototype.addEventListener=function(e,t){e in this.__events||(this.__events[e]=[]),this.__events[e].push(t)},WebSocket.prototype.removeEventListener=function(e,t){if(e in this.__events)for(var n=this.__events[e],i=n.length-1;i>=0;--i)if(n[i]===t){n.splice(i,1);break}},WebSocket.prototype.dispatchEvent=function(e){for(var t=this.__events[e.type]||[],n=0;n<t.length;++n)t[n](e);var i=this["on"+e.type];i&&i(e)},WebSocket.prototype.__handleEvent=function(e){"readyState"in e&&(this.readyState=e.readyState),"protocol"in e&&(this.protocol=e.protocol);var t;if("open"==e.type||"error"==e.type)t=this.__createSimpleEvent(e.type);else if("close"==e.type)t=this.__createSimpleEvent("close");else{if("message"!=e.type)throw"unknown event type: "+e.type;var n=decodeURIComponent(e.message);t=this.__createMessageEvent("message",n)}this.dispatchEvent(t)},WebSocket.prototype.__createSimpleEvent=function(e){if(document.createEvent&&window.Event){var t=document.createEvent("Event");return t.initEvent(e,!1,!1),t}return{type:e,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(e,t){if(document.createEvent&&window.MessageEvent&&!window.opera){var n=document.createEvent("MessageEvent");return n.initMessageEvent("message",!1,!1,t,null,null,window,null),n}return{type:e,data:t,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(e){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(e)})},WebSocket.__initialize=function(){if(!WebSocket.__flash){if(WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation),!window.WEB_SOCKET_SWF_LOCATION)return void e.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf");var t=document.createElement("div");t.id="webSocketContainer",t.style.position="absolute",WebSocket.__isFlashLite()?(t.style.left="0px",t.style.top="0px"):(t.style.left="-100px",t.style.top="-100px");var n=document.createElement("div");n.id="webSocketFlash",t.appendChild(n),document.body.appendChild(t),swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(t){t.success||e.error("[WebSocket] swfobject.embedSWF failed")})}},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var e=0;e<WebSocket.__tasks.length;++e)WebSocket.__tasks[e]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){return setTimeout(function(){try{for(var t=WebSocket.__flash.receiveEvents(),n=0;n<t.length;++n)WebSocket.__instances[t[n].webSocketId].__handleEvent(t[n])}catch(i){e.error(i)}},0),!0},WebSocket.__log=function(t){e.log(decodeURIComponent(t))},WebSocket.__error=function(t){e.error(decodeURIComponent(t))},WebSocket.__addTask=function(e){WebSocket.__flash?e():WebSocket.__tasks.push(e)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;var e=window.navigator.mimeTypes["application/x-shockwave-flash"];return e&&e.enabledPlugin&&e.enabledPlugin.filename&&e.enabledPlugin.filename.match(/flashlite/i)?!0:!1},window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()})),void 0):void e.error("Flash Player >= 10.0.0 is required.")}}(),function(e,t,n){function i(e){e&&(t.Transport.apply(this,arguments),this.sendBuffer=[])}function s(){}e.XHR=i,t.util.inherit(i,t.Transport),i.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},i.prototype.payload=function(e){for(var n=[],i=0,s=e.length;s>i;i++)n.push(t.parser.encodePacket(e[i]));this.send(t.parser.encodePayload(n))},i.prototype.send=function(e){return this.post(e),this},i.prototype.post=function(e){function t(){4==this.readyState&&(this.onreadystatechange=s,o.posting=!1,200==this.status?o.socket.setBuffer(!1):o.onClose())}function i(){this.onload=s,o.socket.setBuffer(!1)}var o=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),n.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=i:this.sendXHR.onreadystatechange=t,this.sendXHR.send(e)},i.prototype.close=function(){return this.onClose(),this},i.prototype.request=function(e){var n=t.util.request(this.socket.isXDomain()),i=t.util.query(this.socket.options.query,"t="+ +new Date);if(n.open(e||"GET",this.prepareUrl()+i,!0),"POST"==e)try{n.setRequestHeader?n.setRequestHeader("Content-type","text/plain;charset=UTF-8"):n.contentType="text/plain"}catch(s){}return n},i.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},i.check=function(e,i){try{var s=t.util.request(i),o=n.XDomainRequest&&s instanceof XDomainRequest,a=e&&e.options&&e.options.secure?"https:":"http:",r=n.location&&a!=n.location.protocol;if(s&&(!o||!r))return!0}catch(l){}return!1},i.xdomainCheck=function(e){return i.check(e,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(){t.Transport.XHR.apply(this,arguments)}e.htmlfile=n,t.util.inherit(n,t.Transport.XHR),n.prototype.name="htmlfile",n.prototype.get=function(){this.doc=new(window[["Active"].concat("Object").join("X")])("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this;var e=this.doc.createElement("div");e.className="socketio",this.doc.body.appendChild(e),this.iframe=this.doc.createElement("iframe"),e.appendChild(this.iframe);var n=this,i=t.util.query(this.socket.options.query,"t="+ +new Date);this.iframe.src=this.prepareUrl()+i,t.util.on(window,"unload",function(){n.destroy()})},n.prototype._=function(e,t){e=e.replace(/\\\//g,"/"),this.onData(e);try{var n=t.getElementsByTagName("script")[0];n.parentNode.removeChild(n)}catch(i){}},n.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(e){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},n.prototype.close=function(){return this.destroy(),t.Transport.XHR.prototype.close.call(this)},n.check=function(e){if("undefined"!=typeof window&&["Active"].concat("Object").join("X")in window)try{var n=new(window[["Active"].concat("Object").join("X")])("htmlfile");return n&&t.Transport.XHR.check(e)}catch(i){}return!1},n.xdomainCheck=function(){return!1},t.transports.push("htmlfile")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function i(){t.Transport.XHR.apply(this,arguments)}function s(){}e["xhr-polling"]=i,t.util.inherit(i,t.Transport.XHR),t.util.merge(i,t.Transport.XHR),i.prototype.name="xhr-polling",i.prototype.heartbeats=function(){return!1},i.prototype.open=function(){var e=this;return t.Transport.XHR.prototype.open.call(e),!1},i.prototype.get=function(){function e(){4==this.readyState&&(this.onreadystatechange=s,200==this.status?(o.onData(this.responseText),o.get()):o.onClose())}function t(){this.onload=s,this.onerror=s,o.retryCounter=1,o.onData(this.responseText),o.get()}function i(){o.retryCounter++,!o.retryCounter||o.retryCounter>3?o.onClose():o.get()}if(this.isOpen){var o=this;this.xhr=this.request(),n.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=t,this.xhr.onerror=i):this.xhr.onreadystatechange=e,this.xhr.send(null)}},i.prototype.onClose=function(){if(t.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=s;try{this.xhr.abort()}catch(e){}this.xhr=null}},i.prototype.ready=function(e,n){var i=this;t.util.defer(function(){n.call(i)})},t.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t,n){function i(){t.Transport["xhr-polling"].apply(this,arguments),this.index=t.j.length;var e=this;t.j.push(function(t){e._(t)})}var s=n.document&&"MozAppearance"in n.document.documentElement.style;e["jsonp-polling"]=i,t.util.inherit(i,t.Transport["xhr-polling"]),i.prototype.name="jsonp-polling",i.prototype.post=function(e){function n(){i(),s.socket.setBuffer(!1)}function i(){s.iframe&&s.form.removeChild(s.iframe);try{a=document.createElement('<iframe name="'+s.iframeId+'">')}catch(e){a=document.createElement("iframe"),a.name=s.iframeId}a.id=s.iframeId,s.form.appendChild(a),s.iframe=a}var s=this,o=t.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);if(!this.form){var a,r=document.createElement("form"),l=document.createElement("textarea"),c=this.iframeId="socketio_iframe_"+this.index;r.className="socketio",r.style.position="absolute",r.style.top="0px",r.style.left="0px",r.style.display="none",r.target=c,r.method="POST",r.setAttribute("accept-charset","utf-8"),l.name="d",r.appendChild(l),document.body.appendChild(r),this.form=r,this.area=l}this.form.action=this.prepareUrl()+o,i(),this.area.value=t.JSON.stringify(e);try{this.form.submit()}catch(d){}this.iframe.attachEvent?a.onreadystatechange=function(){"complete"==s.iframe.readyState&&n()}:this.iframe.onload=n,this.socket.setBuffer(!0)},i.prototype.get=function(){var e=this,n=document.createElement("script"),i=t.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),n.async=!0,n.src=this.prepareUrl()+i,n.onerror=function(){e.onClose()};var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(n,o),this.script=n,s&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},i.prototype._=function(e){return this.onData(e),this.isOpen&&this.get(),this},i.prototype.ready=function(e,n){var i=this;return s?void t.util.load(function(){n.call(i)}):n.call(this)},i.check=function(){return"document"in n},i.xdomainCheck=function(){return!0},t.transports.push("jsonp-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),"function"==typeof define&&define.amd&&define([],function(){return io})}();var CryptoJS=CryptoJS||function(e,t){var n={},i=n.lib={},s=function(){},o=i.Base={extend:function(e){s.prototype=this;var t=new s;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=i.WordArray=o.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes;if(e=e.sigBytes,this.clamp(),i%4)for(var s=0;e>s;s++)t[i+s>>>2]|=(n[s>>>2]>>>24-8*(s%4)&255)<<24-8*((i+s)%4);else if(65535<n.length)for(s=0;e>s;s+=4)t[i+s>>>2]=n[s>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-8*(n%4),t.length=e.ceil(n/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],i=0;t>i;i+=4)n.push(4294967296*e.random()|0);return new a.init(n,t)}}),r=n.enc={},l=r.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],i=0;e>i;i++){var s=t[i>>>2]>>>24-8*(i%4)&255;n.push((s>>>4).toString(16)),n.push((15&s).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],i=0;t>i;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-4*(i%8);return new a.init(n,t/2)}},c=r.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],i=0;e>i;i++)n.push(String.fromCharCode(t[i>>>2]>>>24-8*(i%4)&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],i=0;t>i;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-8*(i%4);return new a.init(n,t)}},d=r.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},u=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,i=n.words,s=n.sigBytes,o=this.blockSize,r=s/(4*o),r=t?e.ceil(r):e.max((0|r)-this._minBufferSize,0);if(t=r*o,s=e.min(4*t,s),t){for(var l=0;t>l;l+=o)this._doProcessBlock(i,l);l=i.splice(0,t),n.sigBytes-=s}return new a.init(l,s)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});i.Hasher=u.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}});var h=n.algo={};return n}(Math);!function(e){function t(e,t,n,i,s,o,a){return e=e+(t&n|~t&i)+s+a,(e<<o|e>>>32-o)+t}function n(e,t,n,i,s,o,a){return e=e+(t&i|n&~i)+s+a,(e<<o|e>>>32-o)+t}function i(e,t,n,i,s,o,a){return e=e+(t^n^i)+s+a,(e<<o|e>>>32-o)+t}function s(e,t,n,i,s,o,a){return e=e+(n^(t|~i))+s+a,(e<<o|e>>>32-o)+t}for(var o=CryptoJS,a=o.lib,r=a.WordArray,l=a.Hasher,a=o.algo,c=[],d=0;64>d;d++)c[d]=4294967296*e.abs(e.sin(d+1))|0;a=a.MD5=l.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,o){for(var a=0;16>a;a++){var r=o+a,l=e[r];e[r]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}var a=this._hash.words,r=e[o+0],l=e[o+1],d=e[o+2],u=e[o+3],h=e[o+4],p=e[o+5],f=e[o+6],m=e[o+7],g=e[o+8],v=e[o+9],y=e[o+10],b=e[o+11],S=e[o+12],E=e[o+13],k=e[o+14],T=e[o+15],w=a[0],_=a[1],L=a[2],C=a[3],w=t(w,_,L,C,r,7,c[0]),C=t(C,w,_,L,l,12,c[1]),L=t(L,C,w,_,d,17,c[2]),_=t(_,L,C,w,u,22,c[3]),w=t(w,_,L,C,h,7,c[4]),C=t(C,w,_,L,p,12,c[5]),L=t(L,C,w,_,f,17,c[6]),_=t(_,L,C,w,m,22,c[7]),w=t(w,_,L,C,g,7,c[8]),C=t(C,w,_,L,v,12,c[9]),L=t(L,C,w,_,y,17,c[10]),_=t(_,L,C,w,b,22,c[11]),w=t(w,_,L,C,S,7,c[12]),C=t(C,w,_,L,E,12,c[13]),L=t(L,C,w,_,k,17,c[14]),_=t(_,L,C,w,T,22,c[15]),w=n(w,_,L,C,l,5,c[16]),C=n(C,w,_,L,f,9,c[17]),L=n(L,C,w,_,b,14,c[18]),_=n(_,L,C,w,r,20,c[19]),w=n(w,_,L,C,p,5,c[20]),C=n(C,w,_,L,y,9,c[21]),L=n(L,C,w,_,T,14,c[22]),_=n(_,L,C,w,h,20,c[23]),w=n(w,_,L,C,v,5,c[24]),C=n(C,w,_,L,k,9,c[25]),L=n(L,C,w,_,u,14,c[26]),_=n(_,L,C,w,g,20,c[27]),w=n(w,_,L,C,E,5,c[28]),C=n(C,w,_,L,d,9,c[29]),L=n(L,C,w,_,m,14,c[30]),_=n(_,L,C,w,S,20,c[31]),w=i(w,_,L,C,p,4,c[32]),C=i(C,w,_,L,g,11,c[33]),L=i(L,C,w,_,b,16,c[34]),_=i(_,L,C,w,k,23,c[35]),w=i(w,_,L,C,l,4,c[36]),C=i(C,w,_,L,h,11,c[37]),L=i(L,C,w,_,m,16,c[38]),_=i(_,L,C,w,y,23,c[39]),w=i(w,_,L,C,E,4,c[40]),C=i(C,w,_,L,r,11,c[41]),L=i(L,C,w,_,u,16,c[42]),_=i(_,L,C,w,f,23,c[43]),w=i(w,_,L,C,v,4,c[44]),C=i(C,w,_,L,S,11,c[45]),L=i(L,C,w,_,T,16,c[46]),_=i(_,L,C,w,d,23,c[47]),w=s(w,_,L,C,r,6,c[48]),C=s(C,w,_,L,m,10,c[49]),L=s(L,C,w,_,k,15,c[50]),_=s(_,L,C,w,p,21,c[51]),w=s(w,_,L,C,S,6,c[52]),C=s(C,w,_,L,u,10,c[53]),L=s(L,C,w,_,y,15,c[54]),_=s(_,L,C,w,l,21,c[55]),w=s(w,_,L,C,g,6,c[56]),C=s(C,w,_,L,T,10,c[57]),L=s(L,C,w,_,f,15,c[58]),_=s(_,L,C,w,E,21,c[59]),w=s(w,_,L,C,h,6,c[60]),C=s(C,w,_,L,b,10,c[61]),L=s(L,C,w,_,d,15,c[62]),_=s(_,L,C,w,v,21,c[63]);a[0]=a[0]+w|0,a[1]=a[1]+_|0,a[2]=a[2]+L|0,a[3]=a[3]+C|0},_doFinalize:function(){var t=this._data,n=t.words,i=8*this._nDataBytes,s=8*t.sigBytes;n[s>>>5]|=128<<24-s%32;var o=e.floor(i/4294967296);for(n[(s+64>>>9<<4)+15]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),n[(s+64>>>9<<4)+14]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),t.sigBytes=4*(n.length+1),this._process(),t=this._hash,n=t.words,i=0;4>i;i++)s=n[i],n[i]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8);return t},clone:function(){var e=l.clone.call(this);return e._hash=this._hash.clone(),e}}),o.MD5=l._createHelper(a),o.HmacMD5=l._createHmacHelper(a)}(Math),window.SL=function(e){e=e.split(".");for(var t=SL;e.length;){var n=e.shift();t[n]||(t[n]={}),t=t[n]}return t},$(function(){function e(){t(),SL.settings.init(),SL.warnings.init(),"undefined"==typeof SLConfig&&(window.SLConfig={}),n(),i(),s()}function t(){var e=$("html");e.addClass("loaded"),SL.util.device.HAS_TOUCH&&e.addClass("touch"),SL.util.device.isChrome()?e.addClass("ua-chrome"):SL.util.device.isSafari()&&e.addClass("ua-safari")}function n(){"object"==typeof window.SLConfig&&(SLConfig.deck&&!SLConfig.deck.notes&&(SLConfig.deck.notes={}),SL.current_user=new SL.models.User(SLConfig.current_user),"object"==typeof SLConfig.deck&&(SL.current_deck=new SL.models.Deck(SLConfig.deck)),"object"==typeof SLConfig.team&&(SL.current_team=new SL.models.Team(SLConfig.team)))}function i(){if(document.querySelector(".fb-like")&&($("body").append('<div id="fb-root"></div>'),function(e,t,n){var i,s=e.getElementsByTagName(t)[0];e.getElementById(n)||(i=e.createElement(t),i.id=n,i.src="//connect.facebook.net/en_US/all.js#xfbml=1&appId=178466085544080",s.parentNode.insertBefore(i,s))}(document,"script","facebook-jssdk")),document.querySelector(".twitter-share-button")&&!function(e,t,n){var i,s=e.getElementsByTagName(t)[0];e.getElementById(n)||(i=e.createElement(t),i.id=n,i.src="//platform.twitter.com/widgets.js",s.parentNode.insertBefore(i,s))}(document,"script","twitter-wjs"),document.querySelector(".g-plusone")){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://apis.google.com/js/plusone.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}}function s(){var e=$("html");SL.util.hideAddressBar(),e.hasClass("home index")&&(SL.view=new SL.views.home.Index),SL.view=e.hasClass("home explore")?new SL.views.home.Explore:e.hasClass("users show")?new SL.views.users.Show:e.hasClass("decks show")?new SL.views.decks.Show:e.hasClass("decks edit")?new SL.views.decks.Edit:e.hasClass("decks embed")?new SL.views.decks.Embed:e.is(".decks.live-client")?new SL.views.decks.LiveClient:e.is(".decks.live-server")?new SL.views.decks.LiveServer:e.hasClass("decks speaker")?new SL.views.decks.Speaker:e.hasClass("decks fullscreen")?new SL.views.decks.Fullscreen:e.hasClass("teams-subscriptions-show")?new SL.views.teams.subscriptions.Show:e.hasClass("registrations")&&(e.hasClass("edit")||e.hasClass("update"))?new SL.views.devise.Edit:e.hasClass("registrations")||e.hasClass("team_registrations")||e.hasClass("sessions")||e.hasClass("passwords")?new SL.views.devise.All:e.hasClass("subscriptions new")||e.hasClass("subscriptions edit")?new SL.views.subscriptions.New:e.hasClass("subscriptions show")?new SL.views.subscriptions.Show:e.hasClass("subscriptions edit_period")?new SL.views.subscriptions.EditPeriod:e.hasClass("teams-signup")?new SL.views.teams.New:e.hasClass("teams edit")?new SL.views.teams.teams.Edit:e.hasClass("teams edit_members")?new SL.views.teams.teams.EditMembers:e.hasClass("teams show")?new SL.views.teams.teams.Show:e.hasClass("themes edit")?new SL.views.themes.Edit:e.hasClass("themes preview")?new SL.views.themes.Preview:e.hasClass("pricing")?new SL.views.statik.Pricing:e.hasClass("static")?new SL.views.statik.All:new SL.views.Base,Placement.sync()}setTimeout(e,1)}),SL("models").Collection=Class.extend({init:function(e,t){if(this.data=e||[],this.factory=t,"function"==typeof this.factory){var n=this.data;this.data=[];for(var i=0,s=n.length;s>i;i++){var o=n[i];this.data.push(o instanceof this.factory?n[i]:new this.factory(n[i]))}}},find:function(e){var t=typeof e;return 1===arguments.length&&"number"===t?e:1===arguments.length&&"object"===t?this.findByProperties(e):-1},findByProperties:function(e){for(var t=0,n=this.data.length;n>t;t++){var i=this.data[t],s=!0;for(var o in e)e.hasOwnProperty(o)&&"function"==typeof i.get&&i.get(o)!=e[o]&&(s=!1);if(s)return t}return-1},findByValue:function(e){for(var t=0,n=this.data.length;n>t;t++){var i=this.data[t];if(i===e)return t}return-1},get:function(e){return this.data[this.find(e)]},remove:function(e){return this.data.splice(this.find(e),1)},create:function(e){if("function"==typeof this.factory){var t=new this.factory(e);return this.data.push(t),t}},clear:function(){this.data.length=0},swap:function(e,t){var n="number"==typeof e&&e>=0&&e<this.size(),i="number"==typeof t&&t>=0&&t<this.size();if(n&&i){var s=this.data[e],o=this.data[t];this.data[e]=o,this.data[t]=s}},shiftLeft:function(e){"number"==typeof e&&e>0&&this.swap(e,e-1)},shiftRight:function(e){"number"==typeof e&&e<this.size()-1&&this.swap(e,e+1)},at:function(e){return this.data[e]},first:function(){return this.at(0)},last:function(){return this.at(this.size())},size:function(){return this.data.length},isEmpty:function(){return 0===this.size()},toJSON:function(){return this.map(function(e){return"function"==typeof e.toJSON?e.toJSON():e})},push:function(e){return this.data.push(e)},pop:function(){return this.data.pop()},map:function(e){return this.data.map(e)},forEach:function(e){return this.data.forEach(e)}}),SL("models").Model=Class.extend({init:function(e){this.data=e||{}},set:function(e,t){this.data[e]=t},get:function(e){if("string"==typeof e&&/\./.test(e)){for(var t=e.split("."),n=this.data;t.length&&n;)e=t.shift(),n=n[e];return n}return this.data[e]},has:function(e){return!!this.get(e)},toJSON:function(){return JSON.parse(JSON.stringify(this.data))}}),SL("models").Customer=SL.models.Model.extend({init:function(e){this._super(e)},isTrial:function(){return"trialing"===this.get("subscription.status")},hasActiveSubscription:function(){return!this.get("subscription.cancel_at_period_end")},getNextInvoiceDate:function(){return this.get("next_charge")},getNextInvoiceSum:function(){return(parseFloat(this.get("next_charge_amount"))/100).toFixed(2)},clone:function(){return new SL.models.Customer(JSON.parse(JSON.stringify(this.data)))}}),SL("models").Deck=SL.models.Model.extend({init:function(e){this.data=e||{},$.extend(this,this.data)},isPro:function(){return this.data.user?!!this.data.user.pro:!1},isPrivate:function(){var e=SL.current_deck.get("visibility");return e===SL.models.Deck.VISIBILITY_SELF||e===SL.models.Deck.VISIBILITY_TEAM},getAbsoluteURL:function(e){var t=document.location.protocol+"//"+document.location.host+SL.routes.DECK(this.get("user").username,this.get("slug"));return e&&(t+="/"+e),t},getTokenedAbsoluteURL:function(e){var t=this.getAbsoluteURL(e);return this.isPrivate()&&(t+="?token="+this.get("access_token")),t},clone:function(){return new SL.models.Deck(JSON.parse(JSON.stringify(this.data)))}}),SL("models").Deck.VISIBILITY_SELF="self",SL("models").Deck.VISIBILITY_TEAM="team",SL("models").Deck.VISIBILITY_ALL="all",SL("models").Team=SL.models.Model.extend({init:function(e){if(this._super(e),"object"==typeof this.data.themes)for(var t=0,n=this.data.themes.length;n>t;t++)this.data.themes[t]=new SL.models.Theme(this.data.themes[t]);this.set("themes",new SL.models.Collection(this.data.themes))},hasThemes:function(){var e=this.get("themes");return e&&e.size()>0},clone:function(){return new SL.models.Team(JSON.parse(JSON.stringify(this.data)))}}),SL("models").ThemeSnippet=SL.models.Model.extend({init:function(e){this._super(e),this.has("title")||this.set("title",""),this.has("template")||this.set("template","")},templatize:function(e){var t=this.get("template");return t&&(t=t.split(SL.models.ThemeSnippet.TEMPLATE_SELECTION_TAG).join(""),e.forEach(function(e){t=t.replace(e.string,e.value||e.defaultValue)})),t},getTemplateVariables:function(){var e=this.get("template");if(e){e=e.split(SL.models.ThemeSnippet.TEMPLATE_SELECTION_TAG).join("");var t=e.match(SL.models.ThemeSnippet.TEMPLATE_VARIABLE_REGEX);if(t)return t=t.map(function(e){var t=e.split(SL.models.ThemeSnippet.TEMPLATE_VARIABLE_DIVIDER),n={string:e,label:t[0]||"",defaultValue:t[1]||""};return n.label=n.label.trim(),n.defaultValue=n.defaultValue.trim(),n.label=n.label.replace(SL.models.ThemeSnippet.TEMPLATE_VARIABLE_OPENER,""),n.label=n.label.replace(SL.models.ThemeSnippet.TEMPLATE_VARIABLE_CLOSER,""),n.defaultValue=n.defaultValue.replace(SL.models.ThemeSnippet.TEMPLATE_VARIABLE_OPENER,""),n.defaultValue=n.defaultValue.replace(SL.models.ThemeSnippet.TEMPLATE_VARIABLE_CLOSER,""),n})}return[]},templateHasVariables:function(){return this.getTemplateVariables().length>0},templateHasSelection:function(){var e=this.get("template");return e?e.indexOf(SL.models.ThemeSnippet.TEMPLATE_SELECTION_TAG)>-1:!1},isEmpty:function(){return!this.get("title")&&!this.get("template")}}),SL.models.ThemeSnippet.TEMPLATE_VARIABLE_OPENER="{{",SL.models.ThemeSnippet.TEMPLATE_VARIABLE_CLOSER="}}",SL.models.ThemeSnippet.TEMPLATE_VARIABLE_DIVIDER="::",SL.models.ThemeSnippet.TEMPLATE_VARIABLE_REGEX=/\{\{.*?\}\}/gi,SL.models.ThemeSnippet.TEMPLATE_SELECTION_TAG="{{selection}}",SL("models").Theme=SL.models.Model.extend({init:function(e){if(this._super(e),this.has("name")||this.set("name","Untitled"),this.has("font")||this.set("font",SL.config.DEFAULT_THEME_FONT),this.has("color")||this.set("color",SL.config.DEFAULT_THEME_COLOR),this.has("transition")||this.set("transition",SL.config.DEFAULT_THEME_TRANSITION),this.has("background_transition")||this.set("background_transition",SL.config.DEFAULT_THEME_BACKGROUND_TRANSITION),"string"==typeof this.data.snippets)try{this.data.snippets=JSON.parse(this.data.snippets)}catch(t){console.warn("Malformed snippets JSON")}this.set("snippets",new SL.models.Collection(this.data.snippets,SL.models.ThemeSnippet))},hasThumbnail:function(){return!!this.get("thumbnail_url")},hasJavaScript:function(){return!!this.get("js")},isTransitionDeprecated:function(){var e=this.get("transition");return SL.config.THEME_TRANSITIONS.some(function(t){return t.id===e&&t.deprecated===!0})},isBackgroundTransitionDeprecated:function(){var e=this.get("background_transition");return SL.config.THEME_BACKGROUND_TRANSITIONS.some(function(t){return t.id===e&&t.deprecated===!0})},clone:function(){return new SL.models.Theme(JSON.parse(JSON.stringify(this.data)))},toJSON:function(){return{name:this.get("name"),center:this.get("center"),rolling_links:this.get("rolling_links"),font:this.get("font"),color:this.get("color"),transition:this.get("transition"),background_transition:this.get("background_transition"),html:this.get("html"),less:this.get("less"),css:this.get("css"),js:this.get("js"),snippets:JSON.stringify(this.get("snippets").toJSON())}}}),SL("models").Theme.fromDeck=function(e){return new SL.models.Theme({id:e.theme_id,name:"",center:e.center,rolling_links:e.rolling_links,font:e.theme_font,color:e.theme_color,transition:e.transition,background_transition:e.background_transition,snippets:[]})},SL("models").User=Class.extend({init:function(e){this.data=e||{},$.extend(this,this.data)},isPro:function(){return!!this.pro},isEnterprise:function(){return!!this.enterprise},get:function(e){return this[e]},hasThemes:function(){return SL.current_team?SL.current_team.hasThemes():void 0},getThemes:function(){return SL.current_team?SL.current_team.get("themes"):new SL.models.Collection},getDefaultTheme:function(){var e=this.getThemes();return e.get(SL.current_team?{id:SL.current_team.get("default_theme_id")}:{id:this.default_theme_id})},getProfileURL:function(){return"/"+this.username}}),SL.analytics={track:function(e,t){"undefined"!=typeof analytics&&analytics.track(e,t)},trackLink:function(e,t,n){"undefined"!=typeof analytics&&analytics.trackLink(e,t,n)},trackForm:function(e,t,n){"undefined"!=typeof analytics&&analytics.trackForm(e,t,n)}},SL.config={LOGIN_STATUS_INTERVAL:6e4,UNSAVED_CHANGES_INTERVAL:1e3,AUTOSAVE_INTERVAL:3e3,MAX_IMAGE_UPLOAD_SIZE:1e4,DEFAULT_THEME_COLOR:"grey-blue",DEFAULT_THEME_FONT:"league",DEFAULT_THEME_TRANSITION:"linear",DEFAULT_THEME_BACKGROUND_TRANSITION:"fade",AUTO_SLIDE_OPTIONS:[2,4,6,8,10,15,20,30,40],THEME_COLORS:[{id:"grey-blue"},{id:"black-mint"},{id:"black-orange"},{id:"forest-yellow"},{id:"lila-yellow"},{id:"asphalt-orange"},{id:"sky-blue"},{id:"beige-brown"},{id:"sand-grey"},{id:"silver-green",pro:!0},{id:"silver-blue",pro:!0},{id:"cobalt-orange",pro:!0},{id:"white-blue",pro:!0},{id:"mint-beige",pro:!0},{id:"sea-yellow",pro:!0},{id:"coral-blue",pro:!0}],THEME_FONTS:[{id:"league",title:"League"},{id:"opensans",title:"Open Sans"},{id:"josefine",title:"Josefine"},{id:"palatino",title:"Palatino"},{id:"news",title:"News"},{id:"montserrat",title:"Montserrat"},{id:"helvetica",title:"Helvetica"},{id:"asul",title:"Asul"},{id:"merriweather",title:"Merriweather"},{id:"sketch",title:"Sketch"},{id:"quicksand",title:"Quicksand"},{id:"overpass",title:"Overpass"}],THEME_TRANSITIONS:[{id:"linear",title:"Linear"},{id:"default",title:"Default"},{id:"concave",title:"Concave"},{id:"zoom",title:"Zoom"},{id:"none",title:"None"},{id:"cube",title:"Cube",deprecated:!0},{id:"page",title:"Page",deprecated:!0},{id:"fade",title:"Fade"}],THEME_BACKGROUND_TRANSITIONS:[{id:"fade",title:"Fade"},{id:"slide",title:"Slide"},{id:"convex",title:"Convex"},{id:"concave",title:"Concave"},{id:"zoom",title:"Zoom"},{id:"none",title:"None"}],DEFAULT_DECK_THUMBNAIL:"https://s3.amazonaws.com/static.slid.es/images/default-deck-thumbnail.png",DEFAULT_USER_THUMBNAIL:"https://s3.amazonaws.com/static.slid.es/images/default-profile-picture.png",DECK_THUMBNAIL_TEMPLATE:['<li class="deck-thumbnail">','<div class="deck-image" style="background-image: url({{DECK_THUMB_URL}})">','<a class="deck-link" href="{{DECK_URL}}"></a>',"</div>",'<footer class="deck-details">','<a class="author" href="{{USER_URL}}">','<span class="picture" style="background-image: url({{USER_THUMB_URL}})"></span>','<span class="name">{{USER_NAME}}</span>',"</a>",'<div class="stats">','<div>{{DECK_VIEWS}}<span class="icon i-eye"></span></div>',"</div>","</footer>","</li>"].join(""),AJAX_SEARCH:"/api/v1/search.json",AJAX_SEARCH_ORGANIZATION:"/api/v1/team/search.json",AJAX_CREATE_DECK:function(){return"/api/v1/decks.json"},AJAX_UPDATE_DECK:function(e){return"/api/v1/decks/"+e+".json"},AJAX_PUBLISH_DECK:function(e){return"/api/v1/decks/"+e+"/publish.json"},AJAX_GET_DECK_VERSIONS:function(e){return"/api/v1/decks/"+e+"/revisions.json"},AJAX_PREVIEW_DECK_VERSION:function(e,t,n){return"/"+e+"/"+t+"/preview?revision="+n},AJAX_RESTORE_DECK_VERSION:function(e,t){return"/api/v1/decks/"+e+"/revisions/"+t+"/restore.json"},AJAX_EXPORT_DECK:function(e,t){return"/"+e+"/"+t+"/export"},AJAX_THUMBNAIL_DECK:function(e){return"/api/v1/decks/"+e+"/thumbnails.json"},AJAX_FORK_DECK:function(e){return"/api/v1/decks/"+e+"/fork.json"},AJAX_KUDO_DECK:function(e){return"/api/v1/decks/"+e+"/kudos/kudo.json"},AJAX_UNKUDO_DECK:function(e){return"/api/v1/decks/"+e+"/kudos/unkudo.json"},AJAX_PDF_EXPORT_START:function(e){return"/api/v1/decks/"+e+"/exports.json"},AJAX_PDF_EXPORT_LIST:function(e){return"/api/v1/decks/"+e+"/exports.json"},AJAX_PDF_EXPORT_STATUS:function(e,t){return"/api/v1/decks/"+e+"/exports/"+t+".json"},AJAX_DROPBOX_CONNECT:"/settings/dropbox/authorize",AJAX_DROPBOX_DISCONNECT:"https://www.dropbox.com/account/security#apps",AJAX_DROPBOX_SYNC_DECK:function(e){return"/api/v1/decks/"+e+"/export.json"
},AJAX_UPDATE_ORGANIZATION:"/api/v1/team.json",AJAX_LOOKUP_ORGANIZATION:"/api/v1/team/lookup.json",AJAX_ORGANIZATION_MEMBERS_LIST:"/api/v1/team/users.json",AJAX_ORGANIZATION_MEMBER_CREATE:"/api/v1/team/users.json",AJAX_ORGANIZATION_MEMBER_DELETE:function(e){return"/api/v1/team/users/"+e+".json"},AJAX_ORGANIZATION_MEMBER_WELCOME:function(e){return"/api/v1/team/users/"+e+"/welcome.json"},AJAX_THEMES_LIST:"/api/v1/themes.json",AJAX_THEMES_CREATE:"/api/v1/themes.json",AJAX_THEMES_UPDATE:function(e){return"/api/v1/themes/"+e+".json"},AJAX_THEMES_DELETE:function(e){return"/api/v1/themes/"+e+".json"},AJAX_GET_USER:function(e){return"/api/v1/users/"+e+".json"},AJAX_LOOKUP_USER:"/api/v1/users/lookup.json",AJAX_SERVICES_USER:"/api/v1/users/services.json",AJAX_UPDATE_USER:"/users.json",AJAX_SUBSCRIPTIONS:"/subscriptions",AJAX_SUBSCRIPTIONS_STATUS:"/account/details.json",AJAX_SUBSCRIPTIONS_PRINT_RECEIPT:function(e){return"/account/receipts/"+e},AJAX_TEAMS_CREATE:"/teams.json",AJAX_CHECK_STATUS:"/api/v1/status.json",AJAX_IMAGE_UPLOAD:"/api/v1/media.json",STATIC_ASSET_HOST:"/assets/",STREAM_ENGINE_HOST:"http://stream.slides.com"},SL.routes={NEW_USER_SESSION:"/users/sign_in",SUBSCRIPTIONS_NEW:"/account/upgrade",SUBSCRIPTIONS_EDIT_CARD:"/account/update_billing",SUBSCRIPTIONS_EDIT_PERIOD:"/account/update_billing_period",DECK:function(e,t){return"/"+e+"/"+t},DECK_EDIT:function(e,t){return"/"+e+"/"+t+"/edit"},DECK_EMBED:function(e,t){return"/"+e+"/"+t+"/embed"}},SL.locale={GENERIC_ERROR:["Oops, something went wrong","We ran into an unexpected error","Something's wong, can you try that again?"],WARN_UNSAVED_CHANGES:"You have unsaved changes, save first?",CLOSE:"Close",PREVIOUS:"Previous",NEXT:"Next",DECK_SAVE_SUCCESS:"Saved successfully",DECK_SAVE_ERROR:"Failed to save",NEW_SLIDE_TITLE:"Title",LEAVE_UNSAVED_DECK:"You will lose your unsaved changes.",LEAVE_UNSAVED_THEME:"You will lose your unsaved changes.",REMOVE_PRO_CONFIRM:"Are you sure you want to downgrade? Your private decks will become <strong>public</strong> at the end of the billing cycle.",REMOVE_PRO_SUCCESS:"Subscription canceled",DECK_RESTORE_CONFIRM:"Are you sure you want to revert to this version from {#time}?",DECK_DELETE_CONFIRM:'Are you sure you want to delete "{#title}"?',DECK_DELETE_SUCCESS:"Deck deleted",DECK_DELETE_ERROR:"Failed to delete",DECK_VISIBILITY_CHANGE_SELF:'<div><span class="icon i-lock-stroke"></span></div><h3>Private</h3><p>Only visible to you</p>',DECK_VISIBILITY_CHANGE_TEAM:'<div><span class="icon i-users"></span></div><h3>Internal</h3><p>Visible to your team</p>',DECK_VISIBILITY_CHANGE_ALL:'<div><span class="icon i-globe"></span></div><h3>Public</h3><p>Visible to the world</p>',DECK_VISIBILITY_CHANGED_SELF:"Your deck is now private",DECK_VISIBILITY_CHANGED_TEAM:"Your deck is now internal",DECK_VISIBILITY_CHANGED_ALL:"Your deck is now public",DECK_VISIBILITY_CHANGED_ERROR:"Failed to change visibility",DECK_EDIT_INVALID_TITLE:"Please enter a valid title",DECK_EDIT_INVALID_SLUG:"Please enter a valid URL",DECK_DELETE_SLIDE_CONFIRM:"Are you sure you want to remove this slide?",DECK_IMPORT_HTML_CONFIRM:"All existing content will be replaced, continue?",EXPORT_PDF_BUTTON:"Download PDF",EXPORT_PDF_BUTTON_WORKING:"Creating PDF...",EXPORT_PDF_ERROR:"An error occured while exporting your PDF.",DECKSHARER_URL_TITLE:"Link",DECKSHARER_EMBED_TITLE:"Embed",DECKSHARER_PRIVATE_URL_NOTICE:"This deck is private but can be shared using the secret link above. To publicly share or embed your deck, please publish it first.",FORM_ERROR_REQUIRED:"Required",FORM_ERROR_USERNAME_TAKEN:["That one's already taken :(","Sorry, that's taken too"],FORM_ERROR_ORGANIZATION_SLUG_TAKEN:["That one's already taken :(","Sorry, that's taken too"],BILLING_DETAILS_ERROR:"An error occured while fetching your billing details, please try again.",BILLING_DETAILS_NOHISTORY:"You haven't made any payments yet.",THEME_CREATE:"New theme",THEME_CREATE_ERROR:"Failed to create theme",THEME_SAVE_SUCCESS:"Theme saved",THEME_SAVE_ERROR:"Failed to save theme",THEME_REMOVE_CONFIRM:"Are you sure you want to remove this theme?",THEME_REMOVE_SUCCESS:"Theme removed successfully",THEME_REMOVE_ERROR:"Failed to remove theme",THEME_LIST_LOAD_ERROR:"Failed to load themes",THEME_LIST_EMPTY:"You haven't created any themes yet. Click below to create one now.",THEME_CSS_DESCRIPTION:"This editor supports LESS or plain CSS input. All selectors are prefixed with .reveal when saved to avoid style spillover.",THEME_HTML_DESCRIPTION:"HTML is inserted into the presentation container, meaning it lives separately from individual slides. This makes it great for things like a company logo which is constantly visible on top of the presentation.",THEME_JS_DESCRIPTION:"Scripts will be executed when a deck that uses this theme is loaded.",THEME_DEFAULT_SAVE_SUCCESS:"Default theme was changed",THEME_DEFAULT_SAVE_ERROR:"Failed to change default theme",THEME_DELETE_TOOLTIP:"Delete this theme",THEME_MAKE_DEFAULT_TOOLTIP:"Make this the default theme",THEME_IS_DEFAULT_TOOLTIP:"This is the default theme",THEME_SNIPPET_DELETE_CONFIRM:"Are you sure you want to delete this snippet?",ORG_USERS_REMOVE_CONFIRM:'Delete "{#name}" and all of their decks?',ORG_USERS_REMOVE_SUCCESS:"User removed successfully",ORG_USERS_REMOVE_ERROR:"Failed to remove user",ORG_USERS_INVITE_SEND_SUCCESS:"Invite email sent",ORG_USERS_INVITE_SEND_ERROR:"Failed to send invite email",ORG_USERS_LIST_EMPTY:"Couldn't find any members of this team.",ORG_USERS_LIST_LOAD_ERROR:"Failed to load user list",SEARCH_PAGINATION_PAGE:"Page",SEARCH_NO_RESULTS_FOR:'No results for "{#term}"',SEARCH_SERVER_ERROR:"Failed to fetch search results",SEARCH_NO_TERM_ERROR:"Please enter a search term",counter:{},get:function(e,t){var n=SL.locale[e];if("object"==typeof n&&n.length&&(this.counter[e]="number"==typeof this.counter[e]?(this.counter[e]+1)%n.length:0,n=n[this.counter[e]]),"object"==typeof t)for(var i in t)n=n.replace("{#"+i+"}",t[i]);return"string"==typeof n?n:""}},function(e){var t={};t.sync=function(){$("[data-placement]").each(function(){var e=$(this),n=e.attr("data-placement");"function"==typeof t[n]?t[n](e):console.log('No matching layout found for "'+n+'"')})},t.hcenter=function(e){var t=e.parent();t&&e.css("left",(t.width()-e.outerWidth())/2)},t.vcenter=function(e){var t=e.parent();t&&e.css("top",(t.height()-e.outerHeight())/2)},t.center=function(e){var t=e.parent();if(t){var n=t.width(),i=t.height(),s=e.outerWidth(),o=e.outerHeight();e.css({left:(n-s)/2,top:(i-o)/2})}},t.sync(),$(e).on("resize",t.sync),e.Placement=t}(window),SL.settings={STORAGE_KEY:"slides-settings",STORAGE_VERSION:1,EDITOR_AUTO_HIDE:"editorAutoHide",EDITOR_AUTO_SAVE:"editorAutoSave",init:function(){this.settings={version:this.STORAGE_VERSION},this.settings[this.EDITOR_AUTO_HIDE]=!1,this.settings[this.EDITOR_AUTO_SAVE]=!0,this.changed=new signals.Signal,this.restore()},setValue:function(e,t){"object"==typeof e?$.extend(this.settings,e):this.settings[e]=t,this.save(),this.changed.dispatch([e])},getValue:function(e){return this.settings[e]},restore:function(){if(Modernizr.localstorage){var e=localStorage.getItem(this.STORAGE_KEY);if(e){var t=JSON.parse(localStorage.getItem(this.STORAGE_KEY));t&&t.version===this.STORAGE_VERSION?(this.settings=t,this.changed.dispatch()):this.save()}}},save:function(){Modernizr.localstorage&&localStorage.setItem(this.STORAGE_KEY,JSON.stringify(this.settings))}},SL.util={getQuery:function(){var e={};return location.search.replace(/[A-Z0-9]+?=([\w%]*)/gi,function(t){e[t.split("=").shift()]=unescape(t.split("=").pop())}),e},getStaticAsset:function(e){return e=e||"",e=e.replace(/^\//gi,""),SL.config.STATIC_ASSET_HOST+e},getMetaKeyName:function(){return SL.util.device.isOSX()?"&#8984":"CTRL"},unescapeHTMLEntities:function(e){var t=document.createElement("div");return t.innerHTML=e,0===t.childNodes.length?"":t.childNodes[0].nodeValue},toArray:function(e){for(var t=[],n=0,i=e.length;i>n;n++)t.push(e[n]);return t},skipCSSTransitions:function(e){e=$(e?e:"html"),e.addClass("no-transition"),setTimeout(function(){e.removeClass("no-transition")},1)},setupReveal:function(e){if("undefined"!=typeof Reveal){var t={controls:!0,progress:!0,history:!1,mouseWheel:!1,margin:.05,autoSlideStoppable:!0,dependencies:[{src:"/assets/reveal-plugins/markdown/marked.js",condition:function(){return!!document.querySelector(".reveal [data-markdown]")}},{src:"/assets/reveal-plugins/markdown/markdown.js",condition:function(){return!!document.querySelector(".reveal [data-markdown]")}},{src:"/assets/reveal-plugins/highlight/highlight.js",async:!0,callback:function(){hljs.initHighlightingOnLoad()}}]};SLConfig&&SLConfig.deck&&(t.autoSlide=SLConfig.deck.auto_slide_interval||0,t.rollingLinks=SLConfig.deck.rolling_links,t.center=SLConfig.deck.center,t.loop=SLConfig.deck.should_loop,t.rtl=SLConfig.deck.rtl,t.transition=SLConfig.deck.transition||"default",t.backgroundTransition=SLConfig.deck.background_transition),$.extend(t,e),Reveal.initialize(t),Reveal.addEventListener("ready",function(){window.STATUS=window.STATUS||{},window.STATUS.REVEAL_IS_READY=!0}),e&&e.openLinksInTabs&&this.openLinksInTabs($(".reveal .slides")),SL.util.deck.injectNotes()}},openLinksInTabs:function(e){e&&e.find("a").each(function(){var e=$(this),t=e.attr("href");/^#/gi.test(t)===!1&&(/http|www/gi.test(t)?e.attr("target","_blank"):e.attr("target","_top"))})},openPopupWindow:function(e,t,n,i){var s=screen.width/2-n/2,o=screen.height/2-i/2;return window.open(e,t,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+n+", height="+i+", top="+o+", left="+s)},layoutReveal:function(e,t){if(clearInterval(this.revealLayoutInterval),clearTimeout(this.revealLayoutTimeout),1===arguments.length)this.revealLayoutTimeout=setTimeout(Reveal.layout,e);else{if(2!==arguments.length)throw"Illegal arguments, expected (duration[, fps])";this.revealLayoutInterval=setInterval(Reveal.layout,t),this.revealLayoutTimeout=setTimeout(function(){clearInterval(this.revealLayoutInterval)}.bind(this),e)}},getRevealElementOffset:function(e,t){e=$(e);var n={left:0,top:0};if(e.parents("section").length)for(;e.length&&!e.is("section");)n.left+=e.get(0).offsetLeft,n.top+=e.get(0).offsetTop,t&&(n.left-=parseInt(e.css("margin-left"),10),n.top-=parseInt(e.css("margin-top"),10)),e=$(e.get(0).offsetParent);return n},getRevealElementGlobalOffset:function(e){var t=$(e),n=t.closest(".reveal"),i={left:0,top:0};if(t.length&&n.length){var s=Reveal.getConfig(),o=Reveal.getScale(),a=n.get(0).getBoundingClientRect(),r={x:a.left+a.width/2,y:a.top+a.height/2},l=s.width*o,c=s.height*o;i.left=r.x-l/2,i.top=r.y-c/2;var d=t.closest(".slides section");d.length&&(i.top-=d.scrollTop()*o);var u=SL.util.getRevealElementOffset(t);i.left+=u.left*o,i.top+=u.top*o}return i},getRevealCounterScale:function(){return window.Reveal?2-Reveal.getScale():1},hideAddressBar:function(){if(SL.util.device.IS_PHONE&&!/crios/gi.test(navigator.userAgent)){var e=function(){setTimeout(function(){window.scrollTo(0,1)},10)};$(window).on("orientationchange",function(){e()}),e()}},callback:function(){"function"==typeof arguments[0]&&arguments[0].apply(null,[].slice.call(arguments,1))},uniqueIDCounter:0,uniqueID:function(e){var t=[Date.now(),SL.util.uniqueIDCounter++];return e&&t.unshift(e),t.join("-")},getPlaceholderImage:function(e){var t="";return e&&"function"==typeof window.btoa&&(t=window.btoa(Math.random().toString()).replace(/=/g,"")),"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"+t}},SL.util.user={isLoggedIn:function(){return"object"==typeof SLConfig&&"object"==typeof SLConfig.current_user},isPro:function(){return SL.util.user.isLoggedIn()?SLConfig.current_user.pro:null},isEnterprise:function(){return SL.util.user.isLoggedIn()?SLConfig.current_user.enterprise:null}},SL.util.device={HAS_TOUCH:!!("ontouchstart"in window),IS_PHONE:/iphone|ipod|android/gi.test(navigator.userAgent),IS_TABLET:/ipad/gi.test(navigator.userAgent),isOSX:function(){return/Mac OS X/.test(navigator.userAgent)},isIE:function(){return/MSIE\s[0-9]/gi.test(navigator.userAgent)},isChrome:function(){return/chrome/gi.test(navigator.userAgent)},isSafari:function(){return/safari/gi.test(navigator.userAgent)&&!SL.util.device.isChrome()},isSafariDesktop:function(){return SL.util.device.isSafari()&&!SL.util.device.isChrome()&&!SL.util.device.IS_PHONE&&!SL.util.device.IS_TABLET},isOpera:function(){return!!window.opera},isPhantomJS:function(){return/PhantomJS/gi.test(navigator.userAgent)},supportedByEditor:function(){return Modernizr.history&&Modernizr.csstransforms&&!SL.util.device.isOpera()}},SL.util.trig={distanceBetween:function(e,t){var n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)}},SL.util.string={slug:function(e){return"string"==typeof e?(e=SL.util.string.trim(e),e=e.toLowerCase(),e=e.replace(/-/g," "),e=e.replace(/[^\w\s]/g,""),e=e.replace(/\s{2,}/g," "),e=e.replace(/\s/g,"-")):""},trim:function(e){return SL.util.string.trimRight(SL.util.string.trimLeft(e))},trimLeft:function(e){return"string"==typeof e?e.replace(/^\s+/,""):""},trimRight:function(e){return"string"==typeof e?e.replace(/\s+$/,""):""},linkify:function(e){return e&&(e=e.replace(/((https?\:\/\/)|(www\.))(\S+)(\w{2,4})(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi,function(e){var t=e;return t.match("^https?://")||(t="http://"+t),'<a href="'+t+'">'+e+"</a>"})),e},pluralize:function(e,t,n){return n?e+t:e},getCustomClassesFromLESS:function(e){var t=(e||"").match(/\/\/=[a-z0-9-_ \t]{2,}(?=\n)?/gi);return t?t.map(function(e){return e=e.replace("//=",""),e=e.trim(),e=e.toLowerCase(),e=e.replace(/\s/g,"-")}):[]}},SL.util.validate={name:function(){return[]},slug:function(e){e=e||"";var t=[];return e.length<2&&t.push("At least 2 characters"),/\s/gi.test(e)&&t.push("No spaces please"),/^[\w-_]+$/gi.test(e)||t.push("Can only contain: A-Z, 0-9, - and _"),t},username:function(e){return SL.util.validate.slug(e)},team_slug:function(e){return SL.util.validate.slug(e)},password:function(e){e=e||"";var t=[];return e.length<6&&t.push("At least 6 characters"),t},email:function(e){e=e||"";var t=[];return/^[A-Z0-9._%+\-]+@[A-Z0-9.\-]+\.[A-Z]{2,4}$/gi.test(e)||t.push("Please enter a valid email"),t},twitterhandle:function(e){e=e||"";var t=[];return e.length>15&&t.push("15 characters max"),/\s/gi.test(e)&&t.push("No spaces please"),/^[\w-_]+$/gi.test(e)||t.push("Can only contain: A-Z, 0-9 and _"),t},url:function(e){e=e||"";var t=[];return e.length<4&&t.push("Please enter a valid URL"),/\s/gi.test(e)&&t.push("No spaces please"),t},decktitle:function(e){e=e||"";var t=[];return 0===e.length&&t.push("Can not be empty"),t},deckslug:function(e){e=e||"";var t=[];return 0===e.length&&t.push("Can not be empty"),t},none:function(){return[]}},SL.util.dom={scrollIntoViewIfNeeded:function(e){e&&("function"==typeof e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded.apply(e,[].slice.call(arguments,1)):"function"==typeof e.scrollIntoView&&e.scrollIntoView())},insertCSRF:function(e,t){"undefined"==typeof t&&(t=$('meta[name="csrf-token"]').attr("content")),t&&(e.find('input[name="authenticity_token"]').remove(),e.append('<input name="authenticity_token" type="hidden" value="'+t+'" />'))}},SL.util.html={indent:function(e){var t="",n=/(>)(<)(\/*)/g,i=0,s=!1;return e=e.replace(/>(\r\n)+</g,"><"),e=e.replace(n,"$1\r\n$2$3"),jQuery.each(e.split("\r\n"),function(e,n){if(n.match(/<pre>/)?s=!0:n.match(/<\/pre>/)&&(s=!1),s)t+=n;else{var o=0;n.length<2e3&&(n.match(/.+<\/\w[^>]*>$/)?o=0:n.match(/^<\/\w/)?0!==i&&(i-=1):o=n.match(/^<\w[^>]*[^\/]>.*$/)&&!n.match(/^<(br|img).*>\s?$/)?1:0);for(var a="",r=0;i>r;r++)a+="    ";t+=a+n+"\r\n",i+=o}}),t},ATTR_SRC_NORMAL:" src=",ATTR_SRC_SILENCED:" data-silenced-src=",muteSources:function(e){return(e||"").replace(new RegExp(SL.util.html.ATTR_SRC_NORMAL,"gi"),SL.util.html.ATTR_SRC_SILENCED)},unmuteSources:function(e){return(e||"").replace(new RegExp(SL.util.html.ATTR_SRC_SILENCED,"gi"),SL.util.html.ATTR_SRC_NORMAL)},trimCode:function(e){$(e).find("pre code").each(function(){var e=$(this).parent("pre"),t=e.html(),n=$.trim(t);t!==n&&e.html(n)})},removeAttributes:function(e,t){e=$(e);var n=$.map(e.get(0).attributes,function(e){return e.name});"function"==typeof t&&(n=n.filter(t)),$.each(n,function(t,n){e.removeAttr(n)})},removeClasses:function(e,t){if(e=$(e),"function"==typeof t){var n=(e.attr("class")||"").split(" ").filter(t);$.each(n,function(t,n){e.removeClass(n)})}else e.attr("class","")},createSpinner:function(e){return e=$.extend({lines:12,radius:8,length:6,width:3,color:"#fff",zIndex:"auto",left:"0",top:"0",className:""},e),new Spinner(e)},generateSpinners:function(){$(".spinner").each(function(e,t){if(t.hasAttribute("data-spinner-state")===!1){t.setAttribute("data-spinner-state","spinning");var n={};t.hasAttribute("data-spinner-color")&&(n.color=t.getAttribute("data-spinner-color")),t.hasAttribute("data-spinner-radius")&&(n.radius=parseInt(t.getAttribute("data-spinner-radius"),10));var i=SL.util.html.createSpinner(n);i.spin(t)}})},createDeckThumbnail:function(e){var e={DECK_URL:e.user.username+"/"+e.slug,DECK_VIEWS:"number"==typeof e.view_count?e.view_count:"N/A",DECK_THUMB_URL:e.thumbnail_url||SL.config.DEFAULT_DECK_THUMBNAIL,USER_URL:"/"+e.user.username,USER_NAME:e.user.name||e.user.username,USER_THUMB_URL:e.user.thumbnail_url||SL.config.DEFAULT_USER_THUMBNAIL},t=SL.config.DECK_THUMBNAIL_TEMPLATE;for(var n in e)t=t.replace("{{"+n+"}}",e[n]);return $(t)}},SL.util.deck={idCounter:1,sortInjectedStyles:function(){var e=$("head");$("#theme-css-output").appendTo(e),$("#user-css-output").appendTo(e)},generateIdentifiers:function(){$(".reveal .slides section").each(function(){(this.hasAttribute("data-id")===!1||0===this.getAttribute("data-id").length)&&this.setAttribute("data-id",CryptoJS.MD5(["slide",SL.current_user.get("id"),SL.current_deck.get("id"),Date.now(),SL.util.deck.idCounter++].join("-")).toString())})},injectNotes:function(){SLConfig.deck&&SLConfig.deck.notes&&[].forEach.call(document.querySelectorAll(".reveal .slides section"),function(e){var t=SLConfig.deck.notes[e.getAttribute("data-id")];t&&"string"==typeof t&&e.setAttribute("data-notes",t)})}},SL.util.anim={collapseListItem:function(e,t){e=$(e),e.addClass("no-transition"),e.css({overflow:"hidden"}),e.animate({opacity:0,height:0,minHeight:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0},{duration:500,complete:t})}},SL.util.selection={moveCursorToEnd:function(e){if(e){e.focus();var t=document.createRange();t.selectNodeContents(e),t.collapse(!1),selection=window.getSelection(),selection.removeAllRanges(),selection.addRange(t)}},getSelectedHTML:function(){var e;if(document.selection&&document.selection.createRange)return e=document.selection.createRange(),e.htmlText;if(window.getSelection){var t=window.getSelection();if(t.rangeCount>0){e=t.getRangeAt(0);var n=e.cloneContents(),i=document.createElement("div");return i.appendChild(n),i.innerHTML}}return""}},"undefined"!=typeof window.Spinner&&"undefined"!=typeof SL.util&&SL.util.html.generateSpinners(),SL.warnings={STORAGE_KEY:"slides-last-warning-id",MESSAGE_ID:3,init:function(){this.showMessage()},showMessage:function(){if(this.hasMessage()&&!this.hasExpired()&&SL.util.user.isLoggedIn()&&Modernizr.localstorage){var e=parseInt(localStorage.getItem(this.STORAGE_KEY),10)||0;if(e<this.MESSAGE_ID){var t=SL.notify(this.MESSAGE_TEXT,{autoHide:!1});t.destroyed.add(this.hideMessage.bind(this))}}},hideMessage:function(){Modernizr.localstorage&&localStorage.setItem(this.STORAGE_KEY,this.MESSAGE_ID)},hasMessage:function(){return!!this.MESSAGE_TEXT},hasExpired:function(){return this.MESSAGE_EXPIRY?moment().diff(moment(this.MESSAGE_EXPIRY))>0:!1}},SL("helpers").FileUploader=Class.extend({init:function(e){if(this.options=e||{},"undefined"==typeof this.options.file||"undefined"==typeof this.options.service)throw"File and service must be defined for FileUploader task.";this.loading=!1,this.timeout=-1,this.onUploadSuccess=this.onUploadSuccess.bind(this),this.onUploadProgress=this.onUploadProgress.bind(this),this.onUploadError=this.onUploadError.bind(this),this.failed=new signals.Signal,this.succeeded=new signals.Signal,this.progressed=new signals.Signal},upload:function(){clearTimeout(this.timeout),"number"==typeof this.options.timeout&&(this.timeout=setTimeout(this.onUploadError,this.options.timeout));var e=new FormData;this.options.filename?e.append("file",this.options.file,this.options.filename):e.append("file",this.options.file);var t=this.options.csrf||document.querySelector('meta[name="csrf-token"]');t&&e.append("authenticity_token",t.getAttribute("content")),this.xhr=new XMLHttpRequest,this.xhr.open("POST",this.options.service),this.xhr.onload=function(){try{var e=JSON.parse(this.xhr.responseText)}catch(t){return this.onUploadError()}this.onUploadSuccess(e)}.bind(this),this.xhr.onerror=this.onUploadError,this.xhr.upload.onprogress=this.onUploadProgress,this.xhr.send(e)},onUploadSuccess:function(e){this.succeeded.dispatch(e),clearTimeout(this.timeout)},onUploadProgress:function(e){this.progressed.dispatch(e.loaded/e.total)},onUploadError:function(){this.failed.dispatch(),clearTimeout(this.timeout)},destroy:function(){clearTimeout(this.timeout);var e=function(){};this.xhr.onload=e,this.xhr.onerror=e,this.xhr.upload.onprogress=e,this.xhr.abort(),this.succeeded.dispose(),this.progressed.dispose(),this.failed.dispose()}}),SL.helpers.Fullscreen={enter:function(e){e=e||document.body;var t=e.requestFullScreen||e.webkitRequestFullscreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullscreen;t&&t.apply(e)},exit:function(){var e=document.exitFullscreen||document.msCancelFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen;e&&e.apply(document)},toggle:function(){SL.helpers.Fullscreen.isActive()?SL.helpers.Fullscreen.exit():SL.helpers.Fullscreen.enter()},isEnabled:function(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled)},isActive:function(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)}},SL.helpers.PageLoader={show:function(e){var t=$(".page-loader");0===t.length&&(t=$(['<div class="page-loader">','<div class="page-loader-inner">','<p class="page-loader-message"></p>','<div class="page-loader-spinner spinner"></div>',"</div>","</div>"].join("")).appendTo(document.body)),e&&t.find(".page-loader-message").html(e),t.addClass("visible")},hide:function(){$(".page-loader").removeClass("visible")}},SL("helpers").PollJob=Class.extend({init:function(e){this.options=$.extend({interval:1e3,timeout:Number.MAX_VALUE,retries:Number.MAX_VALUE},e),this.interval=-1,this.running=!1,this.poll=this.poll.bind(this),this.ended=new signals.Signal,this.polled=new signals.Signal},start:function(){this.running=!0,this.pollStart=Date.now(),this.pollTimes=0,clearInterval(this.interval),this.interval=setInterval(this.poll,this.options.interval)},stop:function(){this.running=!1,clearInterval(this.interval)},poll:function(){this.pollTimes++,Date.now()-this.pollStart>this.options.timeout||this.pollTimes>this.options.retries?(this.stop(),this.ended.dispatch()):this.polled.dispatch()}}),SL("helpers").Stream=Class.extend({init:function(e){this.options=$.extend({reveal:window.Reveal,subscriber:!0,publisher:!1,publisherID:Date.now()+"-"+Math.round(1e6*Math.random()),deckID:SL.current_deck.get("id")},e),this.ready=new signals.Signal,this.stateChanged=new signals.Signal,this.statusChanged=new signals.Signal,this.subscribersChanged=new signals.Signal,this.socketIsDisconnected=!1,this.debugMode=!!SL.util.getQuery().debug},connect:function(){this.options.publisher?this.setupPublisher():this.setupSubscriber()},setupPublisher:function(){this.publish=this.publish.bind(this),this.publishable=!0,this.options.reveal.addEventListener("slidechanged",this.publish),this.options.reveal.addEventListener("fragmentshown",this.publish),this.options.reveal.addEventListener("fragmenthidden",this.publish),this.options.reveal.addEventListener("overviewshown",this.publish),this.options.reveal.addEventListener("overviewhidden",this.publish),this.options.reveal.addEventListener("paused",this.publish),this.options.reveal.addEventListener("resumed",this.publish),$.ajax({url:"/api/v1/decks/"+this.options.deckID+"/stream.json",type:"GET",context:this}).done(function(e){this.log("found existing stream"),this.setState(JSON.parse(e.state),!0),this.setupSocket(),this.ready.dispatch()}).error(function(){this.log("no existing stream, publishing state"),this.publish(function(){this.setupSocket(),this.ready.dispatch()}.bind(this))})},setupSubscriber:function(){$.ajax({url:"/api/v1/decks/"+this.options.deckID+"/stream.json",type:"GET",context:this}).done(function(e){this.log("found existing stream"),this.setStatus(SL.helpers.Stream.STATUS_NONE),this.setState(JSON.parse(e.state),!0),this.setupSocket(),this.ready.dispatch()}).error(function(){this.retryStartTime=Date.now(),this.setStatus(SL.helpers.Stream.STATUS_WAITING_FOR_PUBLISHER),this.log("no existing stream, retrying in "+SL.helpers.Stream.CONNECTION_RETRY_INTERVAL/1e3+"s"),setTimeout(this.setupSubscriber.bind(this),SL.helpers.Stream.CONNECTION_RETRY_INTERVAL)})},setupSocket:function(){this.options.subscriber&&(this.log("socket connected",SL.config.STREAM_ENGINE_HOST),this.socket=io.connect(SL.config.STREAM_ENGINE_HOST),this.socket.on("connect",this.onSocketConnected.bind(this)),this.socket.on("disconnect",this.onSocketDisconnected.bind(this)),this.socket.on("message",this.onSocketStateMessage.bind(this)),this.socket.on("subscribers",this.onSocketSubscribersMessage.bind(this)))},publish:function(e){if(this.publishable){var t=this.options.reveal.getState();t.publisher_id=this.options.publisherID,this.log("publish",t.publisher_id),$.ajax({url:"/api/v1/decks/"+this.options.deckID+"/stream.json",type:"PUT",data:{state:JSON.stringify(t)},success:e})}},log:function(){if(this.debugMode&&"function"==typeof console.log.apply){var e="Stream ("+(this.options.publisher?"publisher":"subscriber")+"):",t=[e].concat(Array.prototype.slice.call(arguments));console.log.apply(console,t)}},setState:function(e,t){this.publishable=!1,t&&$(".reveal").addClass("no-transition"),this.options.reveal.setState(e),this.stateChanged.dispatch(e),setTimeout(function(){this.publishable=!0,t&&$(".reveal").removeClass("no-transition")}.bind(this),1)},setStatus:function(e){this.status!==e&&(this.status=e,this.statusChanged.dispatch(this.status))},getRetryStartTime:function(){return this.retryStartTime},isPublisher:function(){return this.options.publisher},onSocketStateMessage:function(e){try{var t=JSON.parse(e.data);t.publisher_id!=this.options.publisherID&&(this.log("sync","from: "+t.publisher_id,"to: "+this.options.publisherID),this.setState(t))}catch(n){this.log("unable to parse streamed deck state as JSON.")}this.setStatus(SL.helpers.Stream.STATUS_NONE)},onSocketSubscribersMessage:function(e){this.subscribersChanged.dispatch(e.subscribers)},onSocketConnected:function(){this.socket.emit("subscribe",{deck_id:this.options.deckID,publisher:this.options.publisher}),this.socketIsDisconnected===!0&&(this.socketIsDisconnected=!1,this.log("socket connection regained"),this.setStatus(SL.helpers.Stream.STATUS_NONE))},onSocketDisconnected:function(){this.socketIsDisconnected===!1&&(this.socketIsDisconnected=!0,this.log("socket connection lost"),this.setStatus(SL.helpers.Stream.STATUS_CONNECTION_LOST))}}),SL.helpers.Stream.CONNECTION_RETRY_INTERVAL=2e4,SL.helpers.Stream.STATUS_NONE="",SL.helpers.Stream.STATUS_CONNECTION_LOST="connection_lost",SL.helpers.Stream.STATUS_WAITING_FOR_PUBLISHER="waiting_for_publisher",SL.helpers.ThemeController={paint:function(e,t){t=t||{};var n=$(".reveal-viewport");if(0===n.length||"undefined"==typeof window.Reveal)return!1;if(this.cleanup(),n.addClass("theme-font-"+e.get("font")),n.addClass("theme-color-"+e.get("color")),Reveal.configure($.extend({center:e.get("center"),rolling_links:e.get("rolling_links"),transition:e.get("transition"),backgroundTransition:e.get("background_transition")},t)),e.get("html")){var i=$("#theme-html-output");i.length?i.html(e.get("html")):$(".reveal").append('<div id="theme-html-output">'+e.get("html")+"</div>")}else $("#theme-html-output").remove();if(e.get("css")){var s=$("#theme-css-output");s.length?s.html(e.get("css")):$("head").append('<style id="theme-css-output">'+e.get("css")+"</style>")}else $("#theme-css-output").remove();if(t.js!==!1)if(e.get("js")){var o=$("#theme-js-output");o.text()!==e.get("js")&&(o.remove(),$("body").append('<script id="theme-js-output">'+e.get("js")+"</script>"))}else $("#theme-js-output").remove();SL.util.deck.sortInjectedStyles()},cleanup:function(){var e=$(".reveal-viewport"),t=$(".reveal");e.attr("class",e.attr("class").replace(/theme\-(font|color)\-([a-z0-9-])*/gi,"")),SL.config.THEME_TRANSITIONS.forEach(function(e){t.removeClass(e.id)})}},SL("components").DeckSharer=Class.extend({DEFAULT_WIDTH:576,DEFAULT_HEIGHT:420,init:function(e){this.theme=e,this.onLinkOutputMouseDown=this.onLinkOutputMouseDown.bind(this),this.onEmbedOutputMouseDown=this.onEmbedOutputMouseDown.bind(this),this.onStyleChanged=this.onStyleChanged.bind(this),this.onSizeChanged=this.onSizeChanged.bind(this),this.width=this.DEFAULT_WIDTH,this.height=this.DEFAULT_HEIGHT,this.style="",this.domElement=$("<div>").addClass("decksharer")},build:function(){this.domElement.empty(),this.domElement.append(['<div class="url">',"<h3>"+SL.locale.get("DECKSHARER_URL_TITLE")+"</h3>",'<input type="text" name="url" readonly="readonly" class="input-field" />',"</div>"].join("")),this.linkOutputElement=this.domElement.find(".url input"),this.linkOutputElement.on("mousedown",this.onLinkOutputMouseDown);var e='<option value="dark" selected>Dark</option><option value="light">Light</option>';SL.current_user.isPro()&&(e+='<option value="hidden">Hidden</option>'),this.domElement.append(['<div class="embed">',"<h3>"+SL.locale.get("DECKSHARER_EMBED_TITLE")+"</h3>",'<div class="options">','<div class="option">',"<label>Width:</label>",'<input type="text" name="width" maxlength="4" class="input-field" />',"</div>",'<div class="option">',"<label>Height:</label>",'<input type="text" name="height" maxlength="4" class="input-field" />',"</div>",'<div class="option">',"<label>Footer style:</label>",'<select class="sl-select l" name="style">',e,"</select>","</div>","</div>",'<textarea name="output" readonly="readonly"></textarea>',"</div>"].join("")),this.embedStyleElement=this.domElement.find(".embed .options select[name=style]"),this.embedWidthElement=this.domElement.find(".embed .options input[name=width]"),this.embedHeightElement=this.domElement.find(".embed .options input[name=height]"),this.embedOutputElement=this.domElement.find(".embed textarea"),this.embedStyleElement.on("change",this.onStyleChanged),this.embedWidthElement.on("input",this.onSizeChanged),this.embedHeightElement.on("input",this.onSizeChanged),this.embedOutputElement.on("mousedown",this.onEmbedOutputMouseDown),this.embedWidthElement.val(this.width),this.embedHeightElement.val(this.height),this.isPrivate&&this.domElement.append(['<div class="note">','<p class="note-inner">',SL.locale.get("DECKSHARER_PRIVATE_URL_NOTICE"),"</p>","</div>"].join(""))},render:function(e){if(e&&"string"!=typeof e.slug||"string"!=typeof e.user.username)throw"Must specify username and slug of deck to embed.";this.data=e,this.isPrivate="string"==typeof this.data.access_token&&(this.data.visibility===SL.models.Deck.VISIBILITY_SELF||this.data.visibility===SL.models.Deck.VISIBILITY_TEAM),this.build(),this.generate()},appendTo:function(e){$(e).append(this.domElement)},prependTo:function(e){$(e).prepend(this.domElement)},generate:function(){var e=this.getDeckURL(),t=this.getDeckURL(!0)+"/embed",n=[];this.isPrivate&&this.data.access_token&&n.push("token="+this.data.access_token),e+=n.length?"?"+n.join("&"):"","string"==typeof this.style&&this.style.length>0&&n.push("style="+this.style),t+=n.length?"?"+n.join("&"):"";var i='<iframe src="'+t+'" width="'+this.width+'" height="'+this.height+'" scrolling="no" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>';this.embedOutputElement&&this.embedOutputElement.text(i),this.linkOutputElement&&this.linkOutputElement.val(e)},getDeckURL:function(e){var t=this.data.slug||this.data.id,n=e?"":"http:";return n+"//"+document.location.host+SL.routes.DECK(this.data.user.username,t)},onEmbedOutputMouseDown:function(e){e.preventDefault(),this.embedOutputElement.focus().select()},onLinkOutputMouseDown:function(e){e.preventDefault(),this.linkOutputElement.focus().select()},onSizeChanged:function(){this.width=parseInt(this.embedWidthElement.val(),10)||1,this.height=parseInt(this.embedHeightElement.val(),10)||1,this.generate()
},onStyleChanged:function(){this.style=this.embedStyleElement.val(),this.generate()}}),SL("components.form").Scripts=Class.extend({init:function(e){this.domElement=$(e),this.render(),this.readValues(),this.renderList()},render:function(){this.valueElement=this.domElement.find(".value-holder"),this.listElement=$('<ul class="list">'),this.listElement.delegate("li .remove","click",this.onListItemRemove.bind(this)),this.listElement.appendTo(this.domElement),this.inputWrapper=$('<div class="input-wrapper"></div>').appendTo(this.domElement),this.inputElement=$('<input type="text" placeholder="https://...">'),this.inputElement.on("keyup",this.onInputKeyUp.bind(this)),this.inputElement.appendTo(this.inputWrapper),this.submitElement=$('<div class="button outline">Add</div>'),this.submitElement.on("click",this.submitInput.bind(this)),this.submitElement.appendTo(this.inputWrapper),this.domElement.parents("form").first().on("submit",this.onFormSubmit.bind(this))},renderList:function(){this.listElement.empty(),this.values.forEach(function(e){this.listElement.append(['<li class="list-item" data-value="'+e+'">',e,'<span class="icon i-x remove"></span>',"</li>"].join(""))}.bind(this))},formatValues:function(){for(var e=0;e<this.values.length;e++)this.values[e]=SL.util.string.trim(this.values[e]),""===this.values[e]&&this.values.splice(e,1)},readValues:function(){this.values=(this.valueElement.val()||"").split(","),this.formatValues()},writeValues:function(){this.formatValues(),this.valueElement.val(this.values.join(","))},addValue:function(e){return e=e||"",0===e.search(/https\:\/\//gi)?(this.values.push(e),this.renderList(),this.writeValues(),!0):0===e.search(/http\:\/\//gi)?(SL.notify("Script must be loaded via HTTPS","negative"),!1):(SL.notify("Please enter a valid script URL","negative"),!1)},removeValue:function(e){if("string"==typeof e)for(var t=0;t<this.values.length;t++)this.values[t]===e&&this.values.splice(t,1);else"number"==typeof e&&this.values.splice(e,1);this.renderList(),this.writeValues()},submitInput:function(){this.addValue(this.inputElement.val())&&this.inputElement.val("")},onListItemRemove:function(e){var t=$(e.target).parent().index();"number"==typeof t&&this.removeValue(t)},onInputKeyUp:function(e){13===e.keyCode&&this.submitInput()},onFormSubmit:function(e){return this.inputElement.is(":focus")?(e.preventDefault(),!1):void 0}}),SL("components").FormUnit=Class.extend({init:function(e){this.domElement=$(e),this.inputElement=this.domElement.find("input"),this.errorElement=$('<div class="error">'),this.errorIcon=$('<span class="icon">!</span>').appendTo(this.errorElement),this.errorMessage=$('<p class="message">!</p>').appendTo(this.errorElement),this.validateType=this.domElement.attr("data-validate"),this.validateTimeout=-1,this.originalValue=this.inputElement.val(),this.originalError=this.domElement.attr("data-error-message"),this.asyncValidatedValue=null,this.clientErrors=[],this.serverErrors=[],this.inputElement.on("input",this.onInput.bind(this)),this.inputElement.on("change",this.onInputChange.bind(this)),this.inputElement.on("focus",this.onInputFocus.bind(this)),this.inputElement.on("blur",this.onInputBlur.bind(this)),this.inputElement.on("invalid",this.onInputInvalid.bind(this)),this.domElement.parents("form").first().on("submit",this.onFormSubmit.bind(this)),this.originalError&&(this.domElement.removeClass("hidden"),this.validate(),this.inputElement.focus()),this.domElement.data("controller",this)},validate:function(e){clearTimeout(this.validateTimeout);var t=this.inputElement.val();if("string"!=typeof t)return this.serverErrors=[],this.clientErrors=[],void this.render();if(t===this.originalValue&&(this.originalValue||"password"===this.validateType)&&this.originalError)this.clientErrors=[this.originalError];else if(t.length){var n=SL.util.validate[this.validateType];"function"==typeof n?this.clientErrors=n(t):console.log('Could not find validation method of type "'+this.validateType+'"')}else this.clientErrors=[],e&&this.isRequired()&&this.clientErrors.push(SL.locale.FORM_ERROR_REQUIRED);return this.validateAsync(),this.render(),0===this.clientErrors.length&&0===this.serverErrors.length},validateAsync:function(){if("username"===this.validateType){var e=SLConfig&&SLConfig.current_user?SLConfig.current_user.username:"",t=this.inputElement.val();0===SL.util.validate.username(t).length&&(e&&t===e?(this.asyncValidatedValue=e,this.serverErrors=[]):t!==this.asyncValidatedValue&&$.ajax({url:SL.config.AJAX_LOOKUP_USER,type:"GET",data:{id:t},context:this,statusCode:{204:function(){this.serverErrors=[SL.locale.get("FORM_ERROR_USERNAME_TAKEN")]},404:function(){this.serverErrors=[]}}}).complete(function(){this.render(),this.asyncValidatedValue=t}))}else if("team_slug"===this.validateType){var n=SL.current_team?SL.current_team.get("slug"):"",i=this.inputElement.val();0===SL.util.validate.team_slug(i).length&&(n&&i===n?(this.asyncValidatedValue=n,this.serverErrors=[]):i!==this.asyncValidatedValue&&$.ajax({url:SL.config.AJAX_LOOKUP_ORGANIZATION,type:"GET",data:{id:i},context:this,statusCode:{204:function(){this.serverErrors=[SL.locale.get("FORM_ERROR_ORGANIZATION_SLUG_TAKEN")]},404:function(){this.serverErrors=[]}}}).complete(function(){this.render(),this.asyncValidatedValue=i}))}},render:function(){var e=this.serverErrors.concat(this.clientErrors);e.length?(this.domElement.addClass("has-error"),this.errorElement.appendTo(this.domElement),this.errorMessage.text(e[0]),setTimeout(function(){this.errorElement.addClass("visible")}.bind(this),1)):(this.domElement.removeClass("has-error"),this.errorElement.removeClass("visible").remove())},format:function(){if("username"===this.validateType||"team_slug"===this.validateType){var e=this.inputElement.val();e&&this.inputElement.val(this.inputElement.val().toLowerCase())}if("url"===this.validateType){var e=this.inputElement.val();/^http(s?):\/\//gi.test(e)===!1&&this.inputElement.val("http://"+e)}},focus:function(){this.inputElement.focus()},beforeSubmit:function(){return this.validate(!0),this.clientErrors.length>0||this.serverErrors.length>0?(this.focus(),!1):!0},renderImage:function(){var e=this.inputElement.get(0);if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(e){var t=this.domElement.find("img"),n=e.target.result;t.length?t.attr("src",n):$('<img src="'+n+'">').appendTo(this.domElement.find(".image-uploader"))}.bind(this),t.readAsDataURL(e.files[0])}},isRequired:function(){return!this.domElement.hasClass("hidden")&&this.domElement.is("[data-required]")},isUnchanged:function(){return this.inputElement.val()===this.originalValue},onInput:function(){if(clearTimeout(this.validateTimeout),!SL.util.device.IS_PHONE&&!SL.util.device.IS_TABLET){var e=600;(this.clientErrors.length||this.serverErrors.length)&&(e=300),this.validateTimeout=setTimeout(this.validate.bind(this),e)}},onInputChange:function(e){this.domElement.hasClass("image")&&this.renderImage(e.target),this.validate()},onInputFocus:function(){this.domElement.addClass("focused")},onInputBlur:function(){this.format(),this.domElement.removeClass("focused")},onInputInvalid:function(e){return this.beforeSubmit(e)},onFormSubmit:function(e){return this.beforeSubmit(e)===!1?(e.preventDefault(),!1):void 0}}),SL("components").Header=Class.extend({init:function(){this.domElement=$(".global-header"),this.bind(),this.layout()},bind:function(){if(SL.util.device.HAS_TOUCH){var e=this.domElement.find(".profile");e.find(".dropdown-button").on("click",function(e){e.preventDefault()}),e.find(".dropdown-button").on("touchstart",function(t){e.hasClass("open")?e.removeClass("open").addClass("closed"):e.removeClass("closed").addClass("open"),t.preventDefault()}.bind(this))}this.domElement.find(".logo-animation").on("contextmenu",function(){return window.location.href="/about#logo",!1}),$(window).on("resize",this.layout.bind(this)),this.domElement.hasClass("show-on-scroll")&&($(document).on("mousemove",this.onDocumentMouseMove.bind(this)),$(window).on("scroll",this.onWindowScroll.bind(this)))},layout:function(){},onWindowScroll:function(){this.isScrolledDown=$(window).scrollTop()>30,this.domElement.toggleClass("show",this.isScrolledDown)},onDocumentMouseMove:function(e){if(!this.isScrolledDown){var t=e.clientY;t>0&&(20>t&&!this.isMouseOver?(this.domElement.addClass("show"),this.isMouseOver=!0):t>80&&this.isMouseOver&&0===$(e.target).parents(".global-header").length&&(this.domElement.removeClass("show"),this.isMouseOver=!1))}}}),SL("components").Kudos=function(){function e(){$("[data-kudos-value][data-kudos-id]").each(function(e,t){var n=t.getAttribute("data-kudos-id");n&&!a[n]&&(a[n]=t.getAttribute("data-kudos-value"))}.bind(this)),$(".kudos-trigger[data-kudos-id]").on("click",function(e){var i=e.currentTarget;"true"===i.getAttribute("data-kudoed-by-user")?n(i.getAttribute("data-kudos-id")):t(i.getAttribute("data-kudos-id"))}.bind(this))}function t(e){i(e),$.ajax({type:"POST",url:SL.config.AJAX_KUDO_DECK(e),context:this}).fail(function(){s(e),SL.notify(SL.locale.get("GENERIC_ERROR"))})}function n(e){s(e),$.ajax({type:"DELETE",url:SL.config.AJAX_UNKUDO_DECK(e),context:this}).fail(function(){i(e),SL.notify(SL.locale.get("GENERIC_ERROR"))})}function i(e){var t=$('.kudos-trigger[data-kudos-id="'+e+'"]');t.attr("data-kudoed-by-user","true"),a[e]++,o(e,a[e]);var n=t.find(".kudos-icon");n.length&&(n.removeClass("bounce"),setTimeout(function(){n.addClass("bounce")},1))}function s(e){var t=$('.kudos-trigger[data-kudos-id="'+e+'"]');t.attr("data-kudoed-by-user","false"),a[e]--,o(e,a[e]),t.find(".kudos-icon").removeClass("bounce")}function o(e,t){"number"==typeof a[e]&&("number"==typeof t&&(a[e]=t),t=Math.max(a[e],0),$("[data-kudos-id][data-kudos-value]").each(function(e,n){n.setAttribute("data-kudos-value",t)}))}var a={};e()}(),SL("components").Meter=Class.extend({init:function(e){this.domElement=$(e),this.labelElement=$('<div class="label">').appendTo(this.domElement),this.progressElement=$('<div class="progress">').appendTo(this.domElement),this.read(),this.paint(),window.m=this},read:function(){switch(this.unit="",this.type=this.domElement.attr("data-type"),this.value=parseInt(this.domElement.attr("data-value"),10)||0,this.total=parseInt(this.domElement.attr("data-total"),10)||0,this.type){case"storage":var e=1024,t=1024*e,n=1024*t;this.value<t&&this.total<t&&(this.value=Math.round(this.value/e),this.total=Math.round(this.total/e),this.unit="KB"),this.value<n&&this.total<n?(this.value=Math.round(this.value/t),this.total=Math.round(this.total/t),this.unit="MB"):(this.value=(this.value/n).toFixed(2),this.total=(this.total/n).toFixed(2),this.unit="GB")}},paint:function(){var e=Math.min(Math.max(this.value/this.total,0),1)||0;this.labelElement.text(this.value+" / "+this.total+" "+this.unit),this.progressElement.width(100*e+"%"),0===this.total?this.domElement.attr("data-state","invalid"):e>.9?this.domElement.attr("data-state","negative"):e>.7?this.domElement.attr("data-state","warning"):this.domElement.attr("data-state","positive")}}),SL.modal=function(){function e(){$(['<div class="inner edit-html">',"<h3>Edit HTML</h3>",'<div id="ace-html" class="editor"></div>',"<footer>",'<button class="button grey negative close xl">Cancel</button>','<button class="button save-changes xl">OK</button>',"</footer>","</div>"].join("")).appendTo(r);this.htmlEditor&&"function"==typeof this.htmlEditor.destroy&&(this.htmlEditor.destroy(),this.htmlEditor=null);try{SL.htmlEditor=ace.edit("ace-html"),SL.htmlEditor.setTheme("ace/theme/monokai"),SL.htmlEditor.setDisplayIndentGuides(!0),SL.htmlEditor.setShowPrintMargin(!1),SL.htmlEditor.getSession().setMode("ace/mode/html")}catch(e){console.log("An error occurred while initializing the Ace editor.")}SL.htmlEditor.env.document.setValue(SL.util.html.indent($(Reveal.getCurrentSlide()).html())),SL.htmlEditor.focus(),r.find(".save-changes").on("click",function(){SL.view.writeHTMLToCurrentSlide(SL.htmlEditor.env.document.getValue()),SL.modal.close()})}function t(){$(['<div class="inner no-session">',"<h3>Session Expired</h3>","<p>You are no longer signed in to Slides. This can happen when you leave the editor idle for too long, log out in a different tab or go offline. To continue please:</p>","<ol>",'<li><a href="'+SL.routes.NEW_USER_SESSION+'" target="_blank">Sign in</a> to Slides from another browser tab.</li>',"<li>Come back to this tab and press the 'Retry' button.</li>","</ol>","<footer>",'<button class="button outline negative close l">Ignore</button>','<button class="button retry l">Retry</button>',"</footer>","</div>"].join("")).appendTo(r);r.find(".retry").on("click",function(){SL.view.checkLogin(!0)})}function n(e){var t=$(['<div class="inner share-deck">',"<footer>",'<button class="button xl done close">Done</button>',"</footer>","</div>"].join("")).appendTo(r);controller=new SL.components.DeckSharer,controller.prependTo(t),t.data("decksharer",controller),controller.render(e)}function i(e){var t=$(['<div class="inner preview-deck">','<div class="spinner centered"></div>','<div class="deck"></div>',"<footer></footer>","</div>"].join("")).appendTo(r),n=t.find(".deck").empty(),i=t.find("footer").empty();t.addClass("loading"),SL.util.html.generateSpinners();var s=$("<iframe>",{src:e.src,load:function(){t.removeClass("loading")}});s.appendTo(n),i.append(e.footer?e.footer:'<button class="button close l">Close</button>')}function s(e){var t=$(['<div class="inner insert-snippet">','<h3>Insert: "'+e.snippet.get("title")+'"</h3>','<div class="variables sl-form"></div>',"<footer>",'<button class="button outline close l">Cancel</button>','<button class="button insert l">Insert</button>',"</footer>","</div>"].join("")).appendTo(r),n=r.find(".insert"),i=e.snippet.getTemplateVariables(),s=t.find(".variables");i.forEach(function(e){var t=$(['<div class="unit">',"<label>"+e.label+"</label>",'<input type="text" value="'+e.defaultValue+'">',"</div>"].join("")).appendTo(s);t.find("input").data("variable",e),t.find("input").on("keydown",function(e){13===e.keyCode&&n.trigger("click")})}),setTimeout(function(){t.find("input").first().focus()},1),n.on("click",function(){s.find("input").each(function(e,t){t=$(t),t.data("variable").value=t.val()}),e.callback(e.snippet.templatize(i)),SL.modal.close()})}function o(){var e=r.find(".preview-deck");e.find(".deck iframe").attr("src",""),e.find(".deck").empty(),e.find("footer").empty()}function a(){var e=r.find(">.inner");e.css({left:Math.max((window.innerWidth-e.outerWidth())/2,10),top:Math.max((window.innerHeight-e.outerHeight())/2,10)})}var r=$('<div id="modal">').appendTo(document.body),l=$('<div id="modal-cover">').appendTo(document.body),c=$('<div id="modal-background">').appendTo(document.body),d=null,u=null;return $(document).on("keyup",function(e){27===e.keyCode&&SL.modal.close()}),r.add(l).on("click",function(e){e.target===this&&SL.modal.close()}),r.on("click",".close",function(){SL.modal.close()}),{open:function(o,l){switch(r.find(">.inner").remove(),d=o,o){case"edit-html":e(l);break;case"no-session":t(l);break;case"share-deck":n(l);break;case"preview-deck":i(l);break;case"insert-snippet":s(l)}$("html").addClass("modal-open"),clearTimeout(u),c.show(),r.find(">.inner").removeClass("visible"),r.find("."+o).addClass("visible"),$(window).on("resize",a),a()},close:function(){$("html").removeClass("modal-open"),r.find(".save-changes").off(),r.find(".discard-changes").off(),u=setTimeout(function(){switch(c.hide(),r.find(">.inner").removeClass("visible"),d){case"preview-deck":o()}},400),$(window).off("resize",a)},isOpen:function(e){var t=$("html").hasClass("modal-open");return t&&e&&(t=r.find("."+e).hasClass("visible")),t}}}(),SL.notify=function(e,t){function n(){i(),r=setTimeout(function(){o.addClass("no-transition").fadeOut(600,s)},t.duration)}function i(){clearTimeout(r),o.stop().css("opacity","")}function s(){clearTimeout(r),o.remove(),a.dispatch()}0===$(".sl-notifications").length&&$(document.body).append('<div class="sl-notifications"></div>'),$(".sl-notifications>p").last().html()===e&&$(".sl-notifications>p").last().remove(),"string"==typeof t&&(t={type:t}),t=$.extend({type:"",duration:2500+15*e.length,autoHide:!0},t),"negative"===t.type&&(t.duration=1.5*t.duration);var o=$("<p>").html(e).addClass(t.type).appendTo($(".sl-notifications")).on("click",s);t.autoHide&&(o.on("mouseover",i),o.on("mouseout",n));var a=new signals.Signal,r=-1;return setTimeout(function(){o.addClass("show"),t.autoHide&&n()},1),{domElement:o,destroy:s,destroyed:a}},SL("components").Prompt=Class.extend({init:function(e){this.config=$.extend({type:"custom",data:null,anchor:null,title:null,optional:!0,alignment:"auto",offsetX:0,offsetY:0,className:null,confirmLabel:"OK",cancelLabel:"Cancel"},e),this.onBackgroundClicked=this.onBackgroundClicked.bind(this),this.onDocumentKeydown=this.onDocumentKeydown.bind(this),this.onPromptCancelClick=this.onPromptCancelClick.bind(this),this.onPromptConfirmClick=this.onPromptConfirmClick.bind(this),this.onInputChanged=this.onInputChanged.bind(this),this.layout=this.layout.bind(this),this.confirmed=new signals.Signal,this.canceled=new signals.Signal,this.destroyed=new signals.Signal,this.render()},render:function(){this.domElement=$('<div class="sl-prompt" data-type="'+this.config.type+'">'),this.innerElement=$('<div class="inner">').appendTo(this.domElement),this.arrowElement=$('<div class="arrow">').appendTo(this.innerElement),this.config.title&&(this.titleElement=$('<h3 class="title">').html(this.config.title).appendTo(this.innerElement)),this.config.className&&this.domElement.addClass(this.config.className),this.config.html&&this.innerElement.append(this.config.html),"select"===this.config.type?this.renderSelect():"list"===this.config.type?(this.renderList(),this.renderButtons(!this.config.multiselect,this.config.multiselect)):"input"===this.config.type&&(this.renderInput(),this.renderButtons())},renderSelect:function(){this.config.data.forEach(function(e){var t=$('<a class="item button outline l">').html(e.html);t.data("callback",e.callback),t.appendTo(this.innerElement),t.on("click",function(e){var t=$(e.currentTarget).data("callback");"function"==typeof t&&t.apply(null),this.destroy()}.bind(this)),e.focused===!0&&t.addClass("focus"),e.selected===!0&&t.addClass("selected"),"string"==typeof e.className&&t.addClass(e.className)}.bind(this)),this.domElement.attr("data-length",this.config.data.length)},renderList:function(){this.listElement=$('<div class="list">').appendTo(this.innerElement),this.config.data.forEach(function(e){var t=$('<div class="item">');t.html('<span class="title">'+(e.title?e.title:e.value)+'</span><span class="checkmark icon i-checkmark"></span>'),t.data({callback:e.callback,value:e.value}),t.appendTo(this.listElement),t.on("click",function(e){var t=$(e.currentTarget),n=t.data("callback"),i=t.data("value");this.config.multiselect&&t.toggleClass("selected"),"function"==typeof n&&n.apply(null,[i,t.hasClass("selected")]),this.config.multiselect||(this.confirmed.dispatch(i),this.destroy())}.bind(this)),e.focused===!0&&t.addClass("focus"),e.selected===!0&&t.addClass("selected"),"string"==typeof e.className&&t.addClass(e.className)}.bind(this))},renderInput:function(){this.inputElement=$(this.config.data.multiline===!0?'<textarea cols="40" rows="8">':'<input type="text">'),this.config.data.value&&this.inputElement.val(this.config.data.value),this.config.data.placeholder&&this.inputElement.attr("placeholder",this.config.data.placeholder),this.config.data.maxlength&&this.inputElement.attr("maxlength",this.config.data.maxlength),this.inputWrapperElement=$('<div class="input-wrapper">').append(this.inputElement),this.inputWrapperElement.appendTo(this.innerElement),this.onInputChanged()},renderButtons:function(e,t){this.footerElement=$('<div class="footer">').appendTo(this.innerElement),!t&&this.config.optional&&this.config.cancelLabel&&this.footerElement.append('<button class="button l outline white prompt-cancel">'+this.config.cancelLabel+"</button>"),!e&&this.config.confirmLabel&&this.footerElement.append('<button class="button l prompt-confirm">'+this.config.confirmLabel+"</button>")},bind:function(){$(window).on("resize scroll",this.layout),$(document).on("keydown",this.onDocumentKeydown),this.domElement.on("click",this.onBackgroundClicked),this.domElement.find(".prompt-cancel").on("click",this.onPromptCancelClick),this.domElement.find(".prompt-confirm").on("click",this.onPromptConfirmClick),this.inputElement&&this.inputElement.on("input",this.onInputChanged)},unbind:function(){$(window).off("resize scroll",this.layout),$(document).off("keydown",this.onDocumentKeydown),this.domElement.off("click",this.onBackgroundClicked),this.domElement.find(".prompt-cancel").off("click",this.onPromptCancelClick),this.domElement.find(".prompt-confirm").off("click",this.onPromptConfirmClick),this.inputElement&&this.inputElement.off("input",this.onInputChanged)},layout:function(){var e=$(this.config.anchor);if(e.length){var t=e.offset(),n=15,i=this.config.alignment,s=$(window).scrollLeft(),o=$(window).scrollTop(),a=t.left-$(window).scrollLeft(),r=t.top-$(window).scrollTop();a+=this.config.offsetX,r+=this.config.offsetY;var l=e.outerWidth(),c=e.outerHeight(),d=this.innerElement.outerWidth(),u=this.innerElement.outerHeight(),h=d/2,p=d/2,f=8;switch("auto"===i&&(i=t.top-(u+n+f)<o?"b":"t"),this.domElement.attr("data-alignment",i),i){case"t":a+=(l-d)/2,r-=u+n;break;case"b":a+=(l-d)/2,r+=c+n;break;case"l":a-=d+n,r+=(c-u)/2;break;case"r":a+=l+n,r+=(c-u)/2}switch(a=Math.min(Math.max(a,n),window.innerWidth-d-n),r=Math.min(Math.max(r,n),window.innerHeight-u-n),i){case"t":h=t.left-a-s+l/2,p=u;break;case"b":h=t.left-a-s+l/2,p=-f;break;case"l":h=d,p=t.top-r-o+c/2;break;case"r":h=-f,p=t.top-r-o+c/2}this.innerElement.css({left:a,top:r}),this.arrowElement.css({left:h,top:p})}},focus:function(e){var t=this.innerElement.find(".focus");if(t.length||(t=this.innerElement.find(".selected")),t.length){var n=e>0?t.next(".item"):t.prev(".item");n.length&&(t.removeClass("focus"),n.addClass("focus"))}else this.innerElement.find(".item").first().addClass("focus")},show:function(){var e=$(this.config.anchor);e.length&&e.addClass("focus"),this.domElement.appendTo(document.body),this.layout(),this.bind(),this.inputElement&&this.inputElement.focus()},hide:function(){var e=$(this.config.anchor);e.length&&e.removeClass("focus"),this.domElement.detach(),this.unbind()},getValue:function(){var e=void 0;return"input"===this.config.type&&(e=this.inputElement.val()),e},destroy:function(){this.destroyed.dispatch(),this.destroyed.dispose();var e=$(this.config.anchor);e.length&&e.removeClass("focus"),this.domElement.remove(),this.unbind(),this.confirmed.dispose(),this.canceled.dispose()},onBackgroundClicked:function(e){this.config.optional&&$(e.target).is(this.domElement)&&this.destroy()},onPromptCancelClick:function(e){var t=$(e.currentTarget).data("callback"),n=!0;"function"==typeof t&&(n=t.apply(null)),n!==!1&&(this.canceled.dispatch(this.getValue()),this.destroy())},onPromptConfirmClick:function(){this.confirmed.dispatch(this.getValue()),this.destroy()},onDocumentKeydown:function(e){if(27===e.keyCode&&(this.config.optional&&this.destroy(),e.preventDefault()),"select"===this.config.type||"list"===this.config.type)if(13===e.keyCode){var t=this.innerElement.find(".focus");0===t.length&&(t=this.innerElement.find(".selected")),t.length&&(t.trigger("click"),e.preventDefault())}else 37===e.keyCode||38===e.keyCode?(this.focus(-1),e.preventDefault()):39===e.keyCode||40===e.keyCode?(this.focus(1),e.preventDefault()):9===e.keyCode&&e.shiftKey?(this.focus(-1),e.preventDefault()):9===e.keyCode&&(this.focus(1),e.preventDefault());"input"===this.config.type&&13===e.keyCode&&this.config.multiline===!1&&this.onPromptConfirmClick(e)},onInputChanged:function(){if(this.config.data.maxlength){var e=this.inputWrapperElement.find(".input-status");0===e.length&&(e=$('<div class="input-status">').appendTo(this.inputWrapperElement));var t=this.inputElement.val().length,n=this.config.data.maxlength;e.text(t+"/"+n),e.toggleClass("negative",t>.95*n)}}}),SL.prompt=function(e){var t=new SL.components.Prompt(e);return t.show(),t},SL("components").Resizer=Class.extend({init:function(e,t){this.domElement=$(e),this.revealElement=this.domElement.closest(".reveal"),this.options=$.extend({padding:10,preserveAspectRatio:!1,useOverlay:!1},t),this.mouse={x:0,y:0},this.mouseStart={x:0,y:0},this.origin={x:0,y:0,width:0,height:0},this.resizing=!1,this.domElement.length?(this.onAnchorMouseDown=this.onAnchorMouseDown.bind(this),this.onDocumentMouseMove=this.onDocumentMouseMove.bind(this),this.onDocumentMouseUp=this.onDocumentMouseUp.bind(this),this.onElementDrop=this.onElementDrop.bind(this),this.layout=this.layout.bind(this),this.build(),this.bind(),this.layout()):console.warn("Resizer: invalid resize target.")},build:function(){this.options.useOverlay&&(this.overlay=$('<div class="editing-ui resizer-overlay"></div>').appendTo(document.body).hide()),this.anchorN=$('<div class="editing-ui resizer-anchor" data-direction="n"></div>').appendTo(document.body),this.anchorE=$('<div class="editing-ui resizer-anchor" data-direction="e"></div>').appendTo(document.body),this.anchorS=$('<div class="editing-ui resizer-anchor" data-direction="s"></div>').appendTo(document.body),this.anchorW=$('<div class="editing-ui resizer-anchor" data-direction="w"></div>').appendTo(document.body)},bind:function(){this.resizeStarted=new signals.Signal,this.resizeUpdated=new signals.Signal,this.resizeEnded=new signals.Signal,this.getAnchors().on("mousedown",this.onAnchorMouseDown),this.revealElement.on("drop",this.onElementDrop),$(document).on("keyup",this.layout),$(document).on("mouseup",this.layout),$(document).on("mousewheel",this.layout),$(document).on("DOMMouseScroll",this.layout),$(window).on("resize",this.layout)},layout:function(){if(!this.destroyIfDetached()){var e=SL.util.getRevealElementGlobalOffset(this.domElement),t=Reveal.getScale(),n=parseInt(this.domElement.css("margin-right"),10);marginBottom=parseInt(this.domElement.css("margin-bottom"),10);var i=e.left-this.options.padding,s=e.top-this.options.padding,o=(this.domElement.width()+n)*t+2*this.options.padding;height=(this.domElement.height()+marginBottom)*t+2*this.options.padding;var a=-this.anchorN.outerWidth()/2;this.anchorN.css({left:i+o/2+a,top:s+a}),this.anchorE.css({left:i+o+a,top:s+height/2+a}),this.anchorS.css({left:i+o/2+a,top:s+height+a}),this.anchorW.css({left:i+a,top:s+height/2+a}),this.overlay&&this.overlay.css({left:i,top:s,width:o,height:height})}},show:function(){this.getAnchors().addClass("visible"),this.layout()},hide:function(){this.getAnchors().removeClass("visible")},destroyIfDetached:function(){return 0===this.domElement.closest("body").length?(this.destroy(),!0):!1},getOptions:function(){return this.options},getAnchors:function(){return this.anchorN.add(this.anchorE).add(this.anchorS).add(this.anchorW)},isResizing:function(){return!!this.resizing},isDestroyed:function(){return!!this.destroyed},onAnchorMouseDown:function(e){var t=$(e.target).attr("data-direction");if(t){e.preventDefault(),this.resizeDirection=t,this.mouseStart.x=e.clientX,this.mouseStart.y=e.clientY;var n=SL.util.getRevealElementOffset(this.domElement);this.origin.x=n.left,this.origin.y=n.top,this.origin.width=this.domElement.width(),this.origin.height=this.domElement.height(),this.overlay&&this.overlay.show(),this.resizing=!0,$(document).on("mousemove",this.onDocumentMouseMove),$(document).on("mouseup",this.onDocumentMouseUp),this.resizeStarted.dispatch()}},onDocumentMouseMove:function(e){if(!this.destroyIfDetached()&&(this.mouse.x=e.clientX,this.mouse.y=e.clientY,this.resizing)){var t=Reveal.getScale(),n=(this.mouse.x-this.mouseStart.x)/t,i=(this.mouse.y-this.mouseStart.y)/t,s="",o="";switch(this.resizeDirection){case"e":s=Math.max(this.origin.width+n,1);break;case"w":s=Math.max(this.origin.width-n,1);break;case"s":o=Math.max(this.origin.height+i,1);break;case"n":o=Math.max(this.origin.height-i,1)}if(this.options.preserveAspectRatio?(""===s&&(s=this.origin.width*(o/this.origin.height)),""===o&&(o=this.origin.height*(s/this.origin.width))):(""===s&&(s=this.domElement.css("width")),""===o&&(o=this.domElement.css("height"))),"absolute"===this.domElement.css("position")&&("n"===this.resizeDirection||"w"===this.resizeDirection))switch(this.resizeDirection){case"w":this.domElement.css("left",Math.round(this.origin.x+n));break;case"n":this.domElement.css("top",Math.round(this.origin.y+i))}this.domElement.css({width:s?s:"",height:o?o:"",maxHeight:"none",maxWidth:"none"}),this.layout(),this.resizeUpdated.dispatch()}},onDocumentMouseUp:function(){this.resizing=!1,$(document).off("mousemove",this.onDocumentMouseMove),$(document).off("mouseup",this.onDocumentMouseUp),this.overlay&&this.overlay.hide(),this.resizeEnded.dispatch()},onElementDrop:function(){setTimeout(this.layout,1)},destroy:function(){this.destroyed||(this.destroyed=!0,this.resizeStarted.dispose(),this.resizeUpdated.dispose(),this.resizeEnded.dispose(),$(document).off("mousemove",this.onDocumentMouseMove),$(document).off("mouseup",this.onDocumentMouseUp),$(document).off("keyup",this.layout),$(document).off("mouseup",this.layout),$(document).off("mousewheel",this.layout),$(document).off("DOMMouseScroll",this.layout),$(window).off("resize",this.layout),this.revealElement.off("drop",this.onElementDrop),this.getAnchors().off("mousedown",this.onAnchorMouseDown),this.anchorN.remove(),this.anchorE.remove(),this.anchorS.remove(),this.anchorW.remove(),this.overlay&&this.overlay.remove())}}),SL.components.Resizer.delegateOnHover=function(e,t,n){function i(){c&&(c.destroy(),c=null,$(document).off("mousemove",a),$(document).off("mouseup",r))}function s(e,t){if(c&&c.isResizing())return!1;if(c&&d&&!d.is(e)&&i(),!c){var s={};$.extend(s,n),$.extend(s,t),d=$(e),c=new SL.components.Resizer(d,s),c.resizeUpdated.add(l),c.show(),$(document).on("mousemove",a),$(document).on("mouseup",r)}}function o(e){var t=$(e.currentTarget),n=null;t.data("resizer-options")&&(n=t.data("resizer-options")),t.data("target-element")&&(t=t.data("target-element")),s(t,n)}function a(e){if(c)if(c.isDestroyed())i();else if(!c.isResizing()){var t=Reveal.getScale(),n=SL.util.getRevealElementGlobalOffset(d),s=3*c.getOptions().padding,o={top:n.top-s,right:n.left+d.outerWidth(!0)*t+s,bottom:n.top+d.outerHeight(!0)*t+s,left:n.left-s};(e.clientX<o.left||e.clientX>o.right||e.clientY<o.top||e.clientY>o.bottom)&&i()}}function r(e){setTimeout(function(){a(e)},1)}function l(){u.dispatch(d)}e.delegate(t,"mouseover",o);var c=null,d=null,u=new signals.Signal;return{show:s,updated:u,layout:function(){c&&c.layout()},destroy:function(){i(),u.dispose(),e.undelegate(t,"mouseover",o)}}},SL("components").ScrollShadow=Class.extend({init:function(e){this.options=$.extend({threshold:20,shadowSize:10},e),this.bind(),this.render(),this.layout()},bind:function(){this.layout=this.layout.bind(this),this.sync=this.sync.bind(this),$(window).on("resize",this.layout),this.options.contentElement.on("scroll",this.sync)},render:function(){this.shadowTop=$('<div class="sl-scroll-shadow-top">').appendTo(this.options.parentElement),this.shadowBottom=$('<div class="sl-scroll-shadow-bottom">').appendTo(this.options.parentElement),this.shadowTop.height(this.options.shadowSize),this.shadowBottom.height(this.options.shadowSize)},layout:function(){var e=this.options.parentElement.height(),t=this.options.footerElement?this.options.footerElement.outerHeight():0,n=this.options.headerElement?this.options.headerElement.outerHeight():0;(this.options.footerElement||this.options.headerElement)&&this.options.contentElement.css("height",e-t-n),this.sync()},sync:function(){var e=this.options.footerElement?this.options.footerElement.outerHeight():0,t=this.options.headerElement?this.options.headerElement.outerHeight():0,n=this.options.contentElement.scrollTop(),i=this.options.contentElement.prop("scrollHeight"),s=this.options.contentElement.outerHeight(),o=i>s+this.options.threshold,a=n/(i-s);this.shadowTop.css({opacity:o?a:0,top:t}),this.shadowBottom.css({opacity:o?1-a:0,bottom:e})},destroy:function(){$(window).off("resize",this.layout),this.options.contentElement.off("scroll",this.sync),this.options=null}}),SL("components").Search=Class.extend({init:function(e){this.config=e,this.searchForm=$(".search .search-form"),this.searchFormInput=this.searchForm.find(".search-term"),this.searchFormSubmit=this.searchForm.find(".search-submit"),this.searchResults=$(".search .search-results"),this.searchResultsHeader=this.searchResults.find("header"),this.searchResultsTitle=this.searchResults.find(".search-results-title"),this.searchResultsSorting=this.searchResults.find(".search-results-sorting"),this.searchResultsList=this.searchResults.find("ul"),this.searchFormLoader=Ladda.create(this.searchFormSubmit.get(0)),this.bind(),this.checkQuery()
},bind:function(){this.searchForm.on("submit",this.onSearchFormSubmit.bind(this)),this.searchResultsSorting.find("input[type=radio]").on("click",this.onSearchSortingChange.bind(this))},checkQuery:function(){var e=SL.util.getQuery();e.search&&!this.searchFormInput.val()&&(this.searchFormInput.val(e.search),e.page?this.search(e.search,parseInt(e.page,10)):this.search(e.search))},renderSearchResults:function(e){if($(".search").removeClass("empty"),this.searchResults.show(),this.searchResultsList.empty(),this.renderSearchPagination(e),e.results&&e.results.length){this.searchResultsTitle.text(e.total+" "+SL.util.string.pluralize("result","s",e.total>1)+' for "'+this.searchTerm+'"');for(var t=0,n=e.results.length;n>t;t++)this.searchResultsList.append(SL.util.html.createDeckThumbnail(e.results[t]))}else this.searchResultsTitle.text(e.error||SL.locale.get("SEARCH_NO_RESULTS_FOR",{term:this.searchTerm}))},renderSearchPagination:function(e){"undefined"==typeof e.decks_per_page&&(e.decks_per_page=8);var t=Math.ceil(e.total/e.decks_per_page);this.searchPagination&&this.searchPagination.remove(),t>1&&(this.searchPagination=$('<div class="search-results-pagination"></div>').appendTo(this.searchResultsHeader),this.searchPagination.append('<span class="page">'+SL.locale.get("SEARCH_PAGINATION_PAGE")+" "+this.searchPage+"/"+t+"</span>"),this.searchPage>1&&this.searchPagination.append('<button class="button outline previous">'+SL.locale.get("PREVIOUS")+"</button>"),this.searchPagination.append('<button class="button outline next">'+SL.locale.get("NEXT")+"</button>"),this.searchPagination.find("button.previous").on("click",function(){this.search(this.searchTerm,Math.max(this.searchPage-1,1))}.bind(this)),this.searchPagination.find("button.next").on("click",function(){this.search(this.searchTerm,Math.min(this.searchPage+1,t))}.bind(this)))},search:function(e,t,n){if(this.searchTerm=e||this.searchFormInput.val(),this.searchPage=t||1,this.searchSort=n||this.searchSort,window.history&&"function"==typeof window.history.replaceState){var i="?search="+escape(this.searchTerm);t>1&&(i+="&page="+t),window.history.replaceState(null,null,"/explore"+i)}this.searchSort||(this.searchSort=this.searchResultsSorting.find("input[type=radio]:checked").val()),this.searchResultsSorting.find("input[type=radio]").prop("checked",!1),this.searchResultsSorting.find("input[type=radio][value="+this.searchSort+"]").prop("checked",!0),this.searchTerm?(this.searchFormLoader.start(),$.ajax({type:"GET",url:this.config.url,context:this,data:{q:this.searchTerm,page:this.searchPage,sort:this.searchSort}}).done(function(e){this.renderSearchResults(e)}).fail(function(){this.renderSearchResults({error:SL.locale.get("SEARCH_SERVER_ERROR")})}).always(function(){this.searchFormLoader.stop()})):SL.notify(SL.locale.get("SEARCH_NO_TERM_ERROR"))},sort:function(e){this.search(this.searchTerm,this.searchPage,e)},onSearchFormSubmit:function(e){return this.search(),e.preventDefault(),!1},onSearchSortingChange:function(){this.sort(this.searchResultsSorting.find("input[type=radio]:checked").val())}}),SL("components").ThemeOptions=Class.extend({init:function(e){if(!e.container)throw"Cannot build theme options without container";if(!e.model)throw"Cannot build theme options without model";this.config=$.extend({options:!0,colors:SL.config.THEME_COLORS,fonts:SL.config.THEME_FONTS,transitions:SL.config.THEME_TRANSITIONS,backgroundTransitions:SL.config.THEME_BACKGROUND_TRANSITIONS},e),this.theme=e.model,this.changed=new signals.Signal,this.render(),this.updateSelection(),this.toggleDeprecatedOptions(),this.scroll()},render:function(){this.domElement=$('<div class="sl-themeoptions">').appendTo(this.config.container),"string"==typeof this.config.className&&this.domElement.addClass(this.config.className),this.config.themes&&this.renderThemes(),this.config.options&&this.renderOptions(),this.config.colors&&this.renderColors(),this.config.fonts&&this.renderFonts(),this.config.transitions&&this.renderTransitions(),this.config.backgroundTransitions&&this.renderBackgroundTransitions()},renderThemes:function(){if(this.config.themes&&!this.config.themes.isEmpty()){var e=$('<div class="section selector theme"><h3>Theme</h3><ul></ul></div>').appendTo(this.domElement),t=e.find("ul");t.append(['<li data-theme="" class="custom">','<span class="thumb-icon icon i-equalizer"></span>','<span class="thumb-label">Custom</span>',"</li>"].join("")),this.config.themes.forEach(function(e){var n=$('<li data-theme="'+e.get("id")+'"><span class="thumb-label" title="'+e.get("name")+'">'+e.get("name")+"</span></li>").appendTo(t);e.hasThumbnail()&&n.css("background-image",'url("'+e.get("thumbnail_url")+'")')}),this.domElement.find(".theme li").on("click",this.onThemeClicked.bind(this))}},renderOptions:function(){var e=$('<div class="section options"><h3>Options</h3></div>').appendTo(this.domElement);e.append('<div class="options"><div class="unit sl-checkbox outline"><input id="theme-center" value="center" type="checkbox"><label for="theme-center" data-tooltip="Center slide contents vertically (not visible while editing)" data-tooltip-maxwidth="220" data-tooltip-delay="500">Vertical centering</label></div><div class="unit sl-checkbox outline"><input id="theme-rolling_links" value="rolling_links" type="checkbox"><label for="theme-rolling_links" data-tooltip="Use a 3D hover effect on links" data-tooltip-maxwidth="220" data-tooltip-delay="500">Rolling links</label></div></div>'),e.find("#theme-center").on("change",this.onOptionChanged.bind(this)),e.find("#theme-rolling_links").on("change",this.onOptionChanged.bind(this))},renderColors:function(){var e=$('<div class="section selector color"><h3>Color</h3><ul></ul></div>').appendTo(this.domElement),t=e.find("ul");this.config.colors.forEach(function(e){var n=$('<li data-color="'+e.id+'"><div class="theme-body-color-block"></div><div class="theme-link-color-block"></div></li>');n.addClass("theme-color-"+e.id),n.addClass("themed"),n.appendTo(t),e.tooltip&&n.attr({"data-tooltip":e.tooltip,"data-tooltip-delay":250,"data-tooltip-maxwidth":300}),!SL.current_user.isPro()&&e.pro&&n.attr("data-pro","true")}.bind(this)),this.domElement.find(".color li").on("click",this.onColorClicked.bind(this))},renderFonts:function(){var e=$('<div class="section selector font"><h3>Typography</h3><ul></ul></div>').appendTo(this.domElement),t=e.find("ul");this.config.fonts.forEach(function(e){var n=$('<li data-font="'+e.id+'" data-name="'+e.title+'"><h1>'+e.title+"</h1><a>Type</a></li>");n.addClass("theme-font-"+e.id),n.addClass("themed"),n.appendTo(t),e.tooltip&&n.attr({"data-tooltip":e.tooltip,"data-tooltip-delay":250,"data-tooltip-maxwidth":300})}.bind(this)),this.domElement.find(".font li").on("click",this.onFontClicked.bind(this))},renderTransitions:function(){var e=$('<div class="section selector transition"><h3>Transition</h3><ul></ul></div>').appendTo(this.domElement),t=e.find("ul");this.config.transitions.forEach(function(e){var n=$('<li data-transition="'+e.id+'"></li>').appendTo(t);e.deprecated===!0&&n.addClass("deprecated")}.bind(this)),this.domElement.find(".transition li").on("click",this.onTransitionClicked.bind(this))},renderBackgroundTransitions:function(){var e=$('<div class="section selector background-transition"></div>').appendTo(this.domElement);e.append('<h3 data-tooltip="Used when changing between background colors/images." data-tooltip-maxwidth="250" data-tooltip-delay="500">Background Transition</h3>'),e.append("<ul>");var t=e.find("ul");this.config.backgroundTransitions.forEach(function(e){var n=$('<li data-background-transition="'+e.id+'"></li>').appendTo(t);e.deprecated===!0&&n.addClass("deprecated")}.bind(this)),this.domElement.find(".background-transition li").on("click",this.onBackgroundTransitionClicked.bind(this))},populate:function(e){e&&(this.theme=e,this.updateSelection(),this.toggleDeprecatedOptions(),this.scroll())},scroll:function(){var e=this.domElement.find(".background-transition li.selected").get(0),t=this.domElement.find(".transition li.selected").get(0),n=this.domElement.find(".color li.selected").get(0),i=this.domElement.find(".font li.selected").get(0);SL.util.dom.scrollIntoViewIfNeeded(e,!0),SL.util.dom.scrollIntoViewIfNeeded(t,!0),SL.util.dom.scrollIntoViewIfNeeded(n,!0),SL.util.dom.scrollIntoViewIfNeeded(i,!0),this.domElement.scrollTop(0)},updateSelection:function(){this.config.themes&&!this.config.themes.isEmpty()&&this.domElement.toggleClass("using-theme",this.theme.has("id")),this.domElement.find("#theme-center").prop("checked",1==this.theme.get("center")),this.domElement.find("#theme-rolling_links").prop("checked",1==this.theme.get("rolling_links")),this.domElement.find(".theme li").removeClass("selected"),this.domElement.find(".theme li[data-theme="+this.theme.get("id")+"]").addClass("selected"),0!==this.domElement.find(".theme li.selected").length||this.theme.has("id")||this.domElement.find('.theme li[data-theme=""]').addClass("selected"),this.domElement.find(".color li").removeClass("selected"),this.domElement.find(".color li[data-color="+this.theme.get("color")+"]").addClass("selected"),this.domElement.find(".font li").removeClass("selected"),this.domElement.find(".font li[data-font="+this.theme.get("font")+"]").addClass("selected"),this.domElement.find(".font li").each(function(e,t){SL.util.html.removeClasses(t,function(e){return e.match(/^theme\-color\-/gi)}),$(t).addClass("theme-color-"+this.theme.get("color"))}.bind(this)),this.domElement.find(".transition li").removeClass("selected"),this.domElement.find(".transition li[data-transition="+this.theme.get("transition")+"]").addClass("selected"),this.domElement.find(".background-transition li").removeClass("selected"),this.domElement.find(".background-transition li[data-background-transition="+this.theme.get("background_transition")+"]").addClass("selected")},applySelection:function(){SL.helpers.ThemeController.paint(this.theme,{center:!1,js:!1})},toggleDeprecatedOptions:function(){this.domElement.find(".transition .deprecated").toggle(this.theme.isTransitionDeprecated()),this.domElement.find(".background-transition .deprecated").toggle(this.theme.isBackgroundTransitionDeprecated())},getTheme:function(){return this.theme},onThemeClicked:function(e){var t=$(e.currentTarget).data("theme");if(t){var n=this.config.themes.get({id:t});n?this.theme=n.clone():SL.notify("Could not find theme data","negative")}else this.theme.set("id",null),this.theme.set("js",null),this.theme.set("css",null),this.theme.set("less",null),this.theme.set("html",null);this.updateSelection(),this.applySelection(),SL.analytics.track("Theme.edit: Style theme clicked",{id:t}),this.changed.dispatch()},onOptionChanged:function(){this.theme.set("center",this.domElement.find("#theme-center").is(":checked")),this.theme.set("rolling_links",this.domElement.find("#theme-rolling_links").is(":checked")),this.updateSelection(),this.applySelection(),this.changed.dispatch()},onColorClicked:function(e){return $(e.currentTarget).is("[data-pro]")?void window.open("/pricing"):(this.theme.set("color",$(e.currentTarget).data("color")),this.updateSelection(),this.applySelection(),SL.analytics.track("Theme.edit: Style color clicked",{color:this.theme.get("color")}),void this.changed.dispatch())},onFontClicked:function(e){this.theme.set("font",$(e.currentTarget).data("font")),this.updateSelection(),this.applySelection(),SL.analytics.track("Theme.edit: Style font clicked",{font:this.theme.get("font")}),this.changed.dispatch()},onTransitionClicked:function(e){this.theme.set("transition",$(e.currentTarget).data("transition")),this.updateSelection(),this.applySelection(),SL.analytics.track("Theme.edit: Transition clicked",{transition:this.theme.get("transition")}),this.changed.dispatch()},onBackgroundTransitionClicked:function(e){this.theme.set("background_transition",$(e.currentTarget).data("background-transition")),this.updateSelection(),this.applySelection(),SL.analytics.track("Theme.edit: Background Transition clicked",{background_transition:this.theme.get("background_transition")}),this.changed.dispatch()},destroy:function(){this.changed.dispose(),this.domElement.remove(),this.theme=null,this.config=null}}),SL.tooltip=function(){function e(){a=$("<div>").addClass("sl-tooltip"),r=$('<p class="inner">').appendTo(a),l=$('<div class="arrow">').appendTo(a),t()}function t(){i=i.bind(this),$(document).on("keydown, mousedown",function(){SL.tooltip.hide()}),SL.util.device.IS_PHONE||SL.util.device.IS_TABLET||($(document.body).delegate("[data-tooltip]","mouseenter",function(e){var t=$(e.target);if(!t.is("[no-tooltip]")){var i=t.attr("data-tooltip"),s=t.attr("data-tooltip-delay"),o=t.attr("data-tooltip-align"),a=t.attr("data-tooltip-alignment"),r=t.attr("data-tooltip-maxwidth"),l=t.attr("data-tooltip-maxheight"),c=t.attr("data-tooltip-ox"),d=t.attr("data-tooltip-oy"),u=t.attr("data-tooltip-x"),h=t.attr("data-tooltip-y");if(i){var p={anchor:t,align:o,alignment:a,delay:parseInt(s,10),maxwidth:parseInt(r,10),maxheight:parseInt(l,10)};c&&(p.ox=parseFloat(c)),d&&(p.oy=parseFloat(d)),u&&h&&(p.x=parseFloat(u),p.y=parseFloat(h),p.anchor=null),n(i,p)}}}),$(document.body).delegate("[data-tooltip]","mouseleave",s))}function n(e,t){if(!SL.util.device.IS_PHONE&&!SL.util.device.IS_TABLET){c=t||{},clearTimeout(h);var s=Date.now()-p;if("number"==typeof c.delay&&s>500)return h=setTimeout(n.bind(this,e,c),c.delay),void delete c.delay;a.css("opacity",0),a.appendTo(document.body),r.html(e),a.css("max-width",c.maxwidth?c.maxwidth:null),a.css("max-height",c.maxheight?c.maxheight:null),c.align&&a.css("text-align",c.align),i(),a.stop(!0,!0).animate({opacity:1},{duration:150}),$(window).on("resize scroll",i)}}function i(){var e=$(c.anchor);if(e.length){var t=c.alignment||"auto",n=15,i=$(window).scrollLeft(),s=$(window).scrollTop(),o=e.offset();c.anchor.parents(".reveal .slides").length&&"undefined"!=typeof window.Reveal&&(o=SL.util.getRevealElementGlobalOffset(c.anchor));var h=e.outerWidth(),p=e.outerHeight(),f=r.outerWidth(),m=r.outerHeight(),g=o.left-$(window).scrollLeft(),v=o.top-$(window).scrollTop(),y=f/2,b=m/2;switch("number"==typeof c.ox&&(g+=c.ox),"number"==typeof c.oy&&(v+=c.oy),"auto"===t&&(t=o.top-(m+n+d)<s?"b":"t"),t){case"t":g+=(h-f)/2,v-=m+d+u;break;case"b":g+=(h-f)/2,v+=p+d+u;break;case"l":g-=f+d+u,v+=(p-m)/2;break;case"r":g+=h+d+u,v+=(p-m)/2}switch(g=Math.min(Math.max(g,n),window.innerWidth-f-n),v=Math.min(Math.max(v,n),window.innerHeight-m-n),t){case"t":y=o.left-g-i+h/2,b=m;break;case"b":y=o.left-g-i+h/2,b=-d;break;case"l":y=f,b=o.top-v-s+p/2;break;case"r":y=-d,b=o.top-v-s+p/2}l.css({left:Math.round(y),top:Math.round(b)}),a.css({left:Math.round(g),top:Math.round(v)}).attr("data-alignment",t)}}function s(){o()&&(p=Date.now()),clearTimeout(h),a.remove().stop(!0,!0),$(window).off("resize scroll",i)}function o(){return a.parent().length>0}var a,r,l,c,d=6,u=4,h=-1,p=-1;return e(),{show:function(e,t){n(e,t)},hide:function(){s()},anchorTo:function(e,t,n){var i={};"undefined"!=typeof t&&(i["data-tooltip"]=t),"number"==typeof n.delay&&(i["data-tooltip-delay"]=n.delay),"string"==typeof n.alignment&&(i["data-tooltip-alignment"]=n.alignment),$(e).attr(i)}}}(),SL("components").Uploader=Class.extend({init:function(e){this.options=e||{},this.loading=!1,this.failed=new signals.Signal,this.succeeded=new signals.Signal,this.progressed=new signals.Signal,e=$.extend({service:SL.config.AJAX_IMAGE_UPLOAD,timeout:6e4},e),this.uploader=new SL.helpers.FileUploader(e),this.bind()},bind:function(){this.onUploadSuccess=this.onUploadSuccess.bind(this),this.onUploadProgress=this.onUploadProgress.bind(this),this.onUploadError=this.onUploadError.bind(this)},destroy:function(){this.succeeded.dispose(),this.progressed.dispose(),this.failed.dispose(),this.uploader.destroy()}}),SL("views").Base=Class.extend({init:function(){this.header=new SL.components.Header,this.setupAce(),this.handleLogos(),this.handleOutlines(),this.handleFeedback(),this.handleWindowClose(),this.parseTimes(),this.parseLinks(),this.parseMeters(),this.parseSpinners(),this.parseNotifications(),this.parseScrollLinks()},setupAce:function(){"object"==typeof window.ace&&"object"==typeof window.ace.config&&"function"==typeof window.ace.config.set&&ace.config.set("workerPath","/assets")},handleLogos:function(){setTimeout(function(){$(".logo-animation").addClass("open")},600)},handleOutlines:function(){var e=$("<style>").appendTo("head").get(0),t=function(t){e.styleSheet?e.styleSheet.cssText=t:e.innerHTML=t};$(document).on("mousedown",function(){t("a, button, .sl-select, .sl-checkbox label, .radio label { outline: none !important; }")}),$(document).on("keydown",function(){t("")})},handleFeedback:function(){$("html").on("click","[data-feedback-mode]",function(e){var t=$(this);UserVoice.push(["show",{target:this,mode:t.attr("data-feedback-mode")||"contact",position:t.attr("data-feedback-position")||"top",screenshot_enabled:t.attr("data-feedback-screenshot_enabled")||"true"}]),e.preventDefault()})},handleWindowClose:function(){var e=SL.util.getQuery();if(e&&e.autoclose&&window.opener){var t=parseInt(e.autoclose,10)||0;setTimeout(function(){try{window.close()}catch(e){}},t)}},parseTimes:function(){$("time.ago").each(function(){var e=$(this).attr("datetime");e&&$(this).text(moment.utc(e).fromNow())}),$("time.date").each(function(){var e=$(this).attr("datetime");e&&$(this).text(moment.utc(e).format("MMM Do, YYYY"))})},parseLinks:function(){$(".linkify").each(function(){$(this).html(SL.util.string.linkify($(this).text()))})},parseMeters:function(){$(".sl-meter").each(function(){new SL.components.Meter($(this))})},parseSpinners:function(){SL.util.html.generateSpinners()},parseNotifications:function(){var e=$(".flash-notification");e.length&&SL.notify(e.remove().text(),e.attr("data-notification-type"))},parseScrollLinks:function(){$(document).delegate("a[data-scroll-to]","click",function(e){var t=e.currentTarget,n=$(t.getAttribute("href")),i=parseInt(t.getAttribute("data-scroll-to-offset"),10),s=parseInt(t.getAttribute("data-scroll-to-duration"),10);isNaN(i)&&(i=-20),isNaN(s)&&(s=1e3),n.length&&$("html, body").animate({scrollTop:n.offset().top+i},s),e.preventDefault()})}}),SL("views.decks").Edit=SL.views.Base.extend({init:function(){this._super(),SL.util.device.supportedByEditor()||($(document.body).append('<div class="not-supported"><h2>Not Supported</h2><p>The Slides editor doesn\'t currently support the browser you\'re using. Please consider changing to a newer browser, such as <a href="https://www.google.com/chrome">Google Chrome</a> or <a href="https://www.mozilla.org/firefox/">Firefox</a>.</p><a class="skip" href="#">Continue anyway</a></div>'),$(".not-supported .skip").on("click",function(){$(".not-supported").remove()})),SLConfig.deck.theme_font=SLConfig.deck.theme_font||SL.config.DEFAULT_THEME_FONT,SLConfig.deck.theme_color=SLConfig.deck.theme_color||SL.config.DEFAULT_THEME_COLOR,SLConfig.deck.transition=SLConfig.deck.transition||SL.config.DEFAULT_THEME_TRANSITION,SLConfig.deck.background_transition=SLConfig.deck.background_transition||SL.config.DEFAULT_THEME_BACKGROUND_TRANSITION,SLConfig.deck.visibility=SLConfig.deck.visibility||SL.models.Deck.VISIBILITY_ALL,this.addHorizontalSlideButton=$(".add-horizontal-slide"),this.addVerticalSlideButton=$(".add-vertical-slide"),this.exitPreviewButton=$(".exit-preview"),this.hasUnsavedChanges=!1,this.hasLoggedOut=!1,this.isEditing=!0,this.isSaving=!1,this.isNew=!SLConfig.deck.id,this.thumbnailInvalidated=!1;var e=SL.current_user.getDefaultTheme();this.isNew&&e&&(SLConfig.deck.theme_id=e.get("id")),this.loadTime=Date.now(),this.savedConfig=JSON.parse(JSON.stringify(SLConfig)),this.sidebar=new SL.views.decks.edit.Sidebar,SL.views.decks.edit.MediaController.init(),SL.views.decks.edit.HistoryController.init(),this.modes={css:new SL.views.decks.edit.modes.CSS(this),arrange:new SL.views.decks.edit.modes.Arrange(this),preview:new SL.views.decks.edit.modes.Preview(this),fragment:new SL.views.decks.edit.modes.Fragment(this),absolute:new SL.views.decks.edit.modes.Absolute(this)},this.slideOptions=new SL.views.decks.edit.SlideOptions(this),this.migrate(),this.setupToolbar(),this.setupReveal(),this.setupLinebreaker(),this.updateNavigationButtons(),this.updateEditableInstances(),this.changeInterval=setInterval(this.checkChanges.bind(this),SL.config.UNSAVED_CHANGES_INTERVAL),this.loginInterval=setInterval(this.checkLogin.bind(this),SL.config.LOGIN_STATUS_INTERVAL),this.saveInterval=setInterval(this.checkAutoSave.bind(this),SL.config.AUTOSAVE_INTERVAL),SLConfig.deck.data=this.getDeckAsString(),this.firstSlideData=this.getFirstSlideAsString(),$("html").toggleClass("is-new",this.isNew),$("html").toggleClass("rtl",SLConfig.deck.rtl),this.bind(),this.layout(),setTimeout(this.readURL.bind(this),1)},migrate:function(){var e={alert:"rgba( 200, 50, 30, 0.6 )",soothe:"rgba( 50, 200, 90, 0.4 )",blackout:"rgba( 0, 0, 0, 0.6 )",whiteout:"rgba( 255, 255, 255, 0.6 )",cobalt:"rgba( 22, 152, 213, 0.6 )",mint:"rgba( 22, 213, 75, 0.6 )",submerge:"rgba( 12, 25, 77, 0.6)",lila:"rgba( 180, 50, 140, 0.6 )",sunset:"rgba( 255, 122, 0, 0.6 )"};$(".reveal .slides section[data-state]").each(function(t,n){var i=n.getAttribute("data-state");!e[i]||n.getAttribute("data-background")||n.getAttribute("data-background-color")||(n.removeAttribute("data-state"),$(n).hasClass(".stack")||n.setAttribute("data-background-color",e[i]))})},setupToolbar:function(){SL.util.device.HAS_TOUCH&&($(".skriv [data-id=bold], .skriv [data-id=italic], .skriv [data-id=underline]").remove(),$(".skriv [data-id=divider]").first().remove()),SL.views.decks.edit.UndoButton.create(this),SL.views.decks.edit.SnippetsButton.create(this),$('.skriv [data-id="image"]').attr("data-maxsize",SL.config.MAX_IMAGE_UPLOAD_SIZE),this.toolbar=skriv.create(document.querySelector(".skriv")),SL.views.decks.edit.SnippetsButton.sync(this),skriv.util.execCommand("enableObjectResizing",!1,!1);var e={alignment:"b",delay:500},t=SL.util.getMetaKeyName();SL.tooltip.anchorTo($(".skriv .action.bold>button"),"Bold ("+t+" + B)",e),SL.tooltip.anchorTo($(".skriv .action.italic>button"),"Italic ("+t+" + I)",e),SL.tooltip.anchorTo($(".skriv .action.underline>button"),"Underline ("+t+" + U)",e),SL.tooltip.anchorTo($(".skriv .action.removeFormat>button"),"Clear format",e),SL.tooltip.anchorTo($(".skriv .action.foregroundColor>button"),"Text color",e),SL.tooltip.anchorTo($(".skriv .action.backgroundColor>button"),"Text background color",e),SL.tooltip.anchorTo($(".skriv .action.image>button"),"Insert image",e),SL.tooltip.anchorTo($(".skriv .action.link>button"),"Insert link ("+t+" + K)",e),SL.tooltip.anchorTo($(".skriv .action.unlink>button"),"Remove link",e)},setupReveal:function(){Reveal.initialize({controls:!0,progress:!1,history:!1,center:!1,touch:!1,fragments:!1,mouseWheel:!1,rollingLinks:!1,maxScale:1,margin:.16,keyboard:{27:null,70:null},rtl:SLConfig.deck.rtl,loop:SLConfig.deck.should_loop,transition:SLConfig.deck.transition,backgroundTransition:SLConfig.deck.background_transition,dependencies:[]}),Reveal.addEventListener("ready",function(e){this.updateNavigationButtons(),this.formatSlide(e.currentSlide)}.bind(this)),Reveal.addEventListener("slidechanged",function(e){this.updateNavigationButtons(),this.formatSlide(e.currentSlide),this.toolbar.setEditor(e.currentSlide)}.bind(this));var e=this.getCurrentTheme();e&&(SLConfig.deck.center=e.get("center"),SLConfig.deck.rolling_links=e.get("rolling_links"),SLConfig.deck.transition=e.get("transition"),SLConfig.deck.backgroundTransition=e.get("background_transition")),SL.helpers.ThemeController.paint(e,{center:!1})},setupLinebreaker:function(){var e=$(".reveal .slides"),t="section.present[contenteditable]",n=/^(h1|h2|h3|h4|h5|h6|p|a|b|i|u|span|code|pre)$/i;e.delegate(t,"keyup",function(e){var t=$(e.currentTarget).children().last(),n="pre, code, blockquote";(t.is(n)||t.children().last().is(n))&&e.currentTarget.appendChild(document.createElement("br"))}),e.delegate(t,"keypress",function(e){if(13===e.which&&window.getSelection){var t=window.getSelection(),i=t.anchorNode;"#text"===i.nodeName&&(i=i.parentNode);var s=$(i).is(".absolute-element");if(s&&"string"==typeof i.nodeName&&n.test(i.nodeName)){var o=t.getRangeAt(0),a=document.createElement("br");return o.deleteContents(),o.insertNode(a),o.setStartAfter(a),o.setEndAfter(a),o.collapse(!1),t.removeAllRanges(),t.addRange(o),!1}if("string"==typeof i.nodeName&&$(i).is("pre, code")){if(/\n$/gi.test(i.innerHTML)===!1){var r=document.createTextNode("\n");i.appendChild(r)}return document.execCommand("insertHTML",!1,"\n"),!1}}})},bind:function(){var e=$(".reveal .slides");e.on("focus","section.present:not(.stack)",this.onSlideFocused.bind(this)),e.on("blur","section.present:not(.stack)",this.onSlideBlurred.bind(this)),e.on("keydown","section",this.onSlideKeyDown.bind(this)),e.on("mousedown","section.present:not(.stack)",this.onSlideMouseDown),$(document).on("keydown",this.onDocumentKeyDown.bind(this)),$(window).on("keyup",this.onWindowKeyUp.bind(this)),$(window).on("beforeunload",this.onWindowBeforeUnload.bind(this)),$(window).on("resize",this.onWindowResize.bind(this)),this.addHorizontalSlideButton.on("click",this.onAddHorizontalSlideClicked.bind(this)),this.addVerticalSlideButton.on("click",this.onAddVerticalSlideClicked.bind(this)),this.exitPreviewButton.on("mousedown",this.onExitPreviewClicked.bind(this)),this.sidebar.saveClicked.add(this.save.bind(this)),this.sidebar.previewClicked.add(this.changeMode.bind(this,"preview")),this.toolbar.notified.add(SL.notify),this.onUndoOrRedo=this.onUndoOrRedo.bind(this),SL.views.decks.edit.HistoryController.undid.add(this.onUndoOrRedo),SL.views.decks.edit.HistoryController.redid.add(this.onUndoOrRedo)},readURL:function(){var e=SL.util.getQuery();e.panel&&this.sidebar.open(e.panel)},layout:function(){var e=$(".projector"),t=$(Reveal.getCurrentSlide()),n={left:e.width()/2+t.outerWidth()/2*Reveal.getScale(),top:e.height()/2-t.outerHeight()/2*Reveal.getScale()};this.slideOptions.domElement.css(n)},clearMode:function(){var e=this.getMode($("html").attr("data-mode"));e&&e.isActive()&&e.deactivate()},changeMode:function(e){this.clearMode();var t=this.getMode(e);t&&(t.activate(),SL.analytics.track('Deck.edit: Change mode ("'+e+'")'))},toggleMode:function(e){var t=this.getMode(e);t&&t.isActive()?t.deactivate():t&&t.activate()},getMode:function(e){return e||(e=$("html").attr("data-mode")),this.modes[e]?this.modes[e]:null},checkChanges:function(){if(!this.isSaving){var e=this.getDeckAsString();SL.views.decks.edit.HistoryController.push(e);var t=e!==SLConfig.deck.data,n=SLConfig.deck.dirty,i=SL.settings.getValue(SL.settings.EDITOR_AUTO_SAVE);this.hasUnsavedChanges=!!(t||n||this.isNew&&!i),this.sidebar.updateSaveButton(this.hasUnsavedChanges?"":"disabled")}this.formatSlide($(".reveal .slides .present:not(.stack)"))},checkAutoSave:function(){this.sidebar.isAutoSaveOn()&&this.hasUnsavedChanges&&this.save()},checkLogin:function(e){(this.hasUnsavedChanges&&!SL.modal.isOpen("no-session")||e)&&$.get(SL.config.AJAX_CHECK_STATUS).done(function(e){e&&e.user_signed_in?this.onLoggedIn():this.onLoggedOut()}.bind(this))},save:function(e){this.saveCallbacks||(this.saveCallbacks=[]),"function"==typeof e&&this.saveCallbacks.push(e),this.isSaving||(this.isSaving=!0,this.sidebar.updateSaveButton("disabled saving"),this.isNew?this.createDeck():this.updateDeck())},getSaveData:function(e){return{deck:{title:SL.util.unescapeHTMLEntities(SLConfig.deck.title),description:SL.util.unescapeHTMLEntities(SLConfig.deck.description),data:SL.util.string.trim(e),css_input:SLConfig.deck.css_input,css_output:SLConfig.deck.css_output,comments_enabled:SLConfig.deck.comments_enabled,forking_enabled:SLConfig.deck.forking_enabled,auto_slide_interval:SLConfig.deck.auto_slide_interval,transition:SLConfig.deck.transition,background_transition:SLConfig.deck.background_transition,theme_font:SLConfig.deck.theme_font,theme_color:SLConfig.deck.theme_color,rolling_links:SLConfig.deck.rolling_links,should_loop:SLConfig.deck.should_loop,center:SLConfig.deck.center,rtl:SLConfig.deck.rtl,notes:JSON.stringify(SLConfig.deck.notes)}}},createDeck:function(){var e=this.getDeckAsString(),t=SLConfig.deck.title;if(!t){var n=$(Reveal.getSlide(0)).find("h1").text();"untitled"!==n.toLowerCase()&&(SLConfig.deck.title=$(Reveal.getSlide(0)).find("h1").text().slice(0,200))}var i={type:"POST",url:SL.config.AJAX_CREATE_DECK(SLConfig.current_user.username),context:this,data:this.getSaveData(e)};SLConfig.deck.slug!==this.savedConfig.deck.slug&&(i.data.deck.custom_slug=SLConfig.deck.slug),SL.current_user.hasThemes()&&(i.data.deck.theme_id=SLConfig.deck.theme_id),$.ajax(i).done(function(t){$.extend(SLConfig.deck,t),SLConfig.deck.data=e,SLConfig.deck.dirty=!1,this.writeURL(),$("html").removeClass("is-new"),this.isNew=!1,this.generateThumbnail(),this.onSaveSuccess(t)}).fail(function(e){this.onSaveError(e)}).always(function(){this.onSaveFinished()})},updateDeck:function(){var e=this.getDeckAsString(),t={type:"PUT",url:SL.config.AJAX_UPDATE_DECK(this.savedConfig?this.savedConfig.deck.id:SLConfig.deck.id),context:this,data:this.getSaveData(e)};SLConfig.deck.slug!==this.savedConfig.deck.slug&&(t.data.deck.custom_slug=SLConfig.deck.slug),SL.current_user.hasThemes()&&(t.data.deck.theme_id=SLConfig.deck.theme_id),$.ajax(t).done(function(t){t&&t.deck&&t.deck.slug&&(SLConfig.deck.slug=t.deck.slug,this.writeURL()),SLConfig.deck.data=e,SLConfig.deck.dirty=!1;var n=this.getFirstSlideAsString();(this.firstSlideData!==n||this.thumbnailInvalidated)&&(this.firstSlideData=n,this.generateThumbnail()),this.onSaveSuccess(t)}).fail(function(e){this.onSaveError(e)}).always(function(){this.onSaveFinished()})},onSaveSuccess:function(e){this.savedConfig=JSON.parse(JSON.stringify(SLConfig)),e&&e.deck&&e.deck.sanitize_messages&&e.deck.sanitize_messages.length?SL.notify(e.deck.sanitize_messages[0],"negative"):this.sidebar.isAutoSaveOn()||SL.notify(SL.locale.get("DECK_SAVE_SUCCESS"),"positive"),this.triggerSaveCallbacks(!0)},onSaveError:function(e){401===e.status&&this.checkLogin(),SL.notify(SL.locale.get("DECK_SAVE_ERROR"),"negative"),this.triggerSaveCallbacks(!1)},onSaveFinished:function(){this.isSaving=!1,this.checkChanges()},triggerSaveCallbacks:function(e){this.saveCallbacks.forEach(function(t){"function"==typeof t&&t.apply(null,[e])}),this.saveCallbacks=[]},saveVisibility:function(e){if(this.isNew)return this.save(this.saveVisibility.bind(this,e)),!1;var t={type:"POST",url:SL.config.AJAX_PUBLISH_DECK(SLConfig.deck.id),context:this,data:{visibility:SLConfig.deck.visibility}};$.ajax(t).done(function(e){$("html").attr("data-visibility",SLConfig.deck.visibility),e.deck.visibility===SL.models.Deck.VISIBILITY_SELF?SL.notify(SL.locale.get("DECK_VISIBILITY_CHANGED_SELF")):e.deck.visibility===SL.models.Deck.VISIBILITY_TEAM?SL.notify(SL.locale.get("DECK_VISIBILITY_CHANGED_TEAM")):e.deck.visibility===SL.models.Deck.VISIBILITY_ALL&&SL.notify(SL.locale.get("DECK_VISIBILITY_CHANGED_ALL")),this.sidebar.updatePublishButton()}).fail(function(){this.sidebar.updatePublishButton(),SL.notify(SL.locale.get("DECK_VISIBILITY_CHANGED_ERROR"),"negative")})},generateThumbnail:function(){$.ajax({type:"POST",url:SL.config.AJAX_THUMBNAIL_DECK(SLConfig.deck.id)}),this.thumbnailInvalidated=!1},invalidateThumbnail:function(){this.thumbnailInvalidated=!0},writeURL:function(){window.history&&"function"==typeof window.history.replaceState&&window.history.replaceState(null,SLConfig.deck.title,SL.routes.DECK_EDIT(SLConfig.deck.user.username,SLConfig.deck.slug))},getDeckAsString:function(){var e=SL.util.html.muteSources($(".reveal .slides").html()),t=$("<div>").html(e);t.find("section").each(function(e,t){this.formatSlideForSave(t)}.bind(this));var n=SL.util.html.unmuteSources(t.html());return n=SL.util.string.trim(n)},getFirstSlideAsString:function(){var e=$(".reveal .slides section").first();e.find("section").length&&(e=e.find("section").first());var t=SL.util.html.muteSources(e.html());e=$("<div>").html(t),this.formatSlideForSave(e);var n=SL.util.html.unmuteSources(e.html());return n},getCurrentHorizontalSlide:function(){var e=$(Reveal.getCurrentSlide());return e.parent("section.stack").length&&(e=e.parent("section.stack")),e},getFocusedSlide:function(){return $(".reveal .slides .present[contenteditable]:focus")},formatSlide:function(e){if(e=$(e),e.length&&Date.now()>this.loadTime+1e3){var t=!this.getMode("preview").isActive();e.toggleClass("overflowing",t&&e.get(0).scrollHeight>e.outerHeight()+10)}e.find("*").each(function(e,t){t.style.fontFamily.match(/,/gi)&&(t.style.fontFamily=null),null===t.style.fontSize.match(/px/gi)&&(t.style.fontSize=null),t.style.lineHeight&&(t.style.lineHeight=null),t.style.letterSpacing&&(t.style.letterSpacing=null),""===t.getAttribute("class")&&t.removeAttribute("class"),""===t.getAttribute("style")&&t.removeAttribute("style")
})},formatSlideForSave:function(e){return e=$(e),SL.util.html.removeAttributes(e,function(e){return/(style|contenteditable|hidden|data\-index\-.|data\-previous\-indexv)/gi.test(e)}),SL.util.html.trimCode(e),e.removeClass("past present future"),e.find("img").css("cursor",""),e.find(".fragment").removeClass("visible"),e.removeClass("overflowing"),e.find(".editing-ui").remove(),e.find('[src="'+skriv.actions.image.PLACEHOLDER+'"]').remove(),e.find('[href="'+skriv.actions.link.PLACEHOLDER+'"]').each(function(){$(this).replaceWith(this.childNodes)}),e.find("*:not(iframe)").contents().each(function(){8===this.nodeType&&$(this).remove()}),e},navigateToSlide:function(e){if(e){var t=Reveal.getIndices(e);setTimeout(function(){Reveal.slide(t.h,t.v)},1)}},updateEditableInstances:function(){this.isEditing&&($(".reveal .slides section.stack").removeAttr("contenteditable"),$(".reveal .slides section:not(.stack)").attr("contenteditable","true"),this.toolbar.bind(),SL.util.deck.generateIdentifiers())},enableEditing:function(){this.isEditing=!0,this.updateEditableInstances()},disableEditing:function(){this.isEditing=!1,$(".reveal .slides section").removeAttr("contenteditable")},mergeHorizontalSlides:function(e,t){e.length&&t.length&&(stack=e.wrap('<section class="present">').parent(),stack.addClass("stack"),stack.append(t),this.updateEditableInstances(),Reveal.sync())},unwrapEmptyStacks:function(){$(".reveal .slides section.stack").each(function(){var e=$(this);1===e.find(">section").length&&e.find(">section").first().unwrap()})},addVerticalSlide:function(){var e=this.getCurrentHorizontalSlide();e.hasClass("stack")||(e=e.wrap('<section class="present">').parent(),e.addClass("stack"));var t=$('<section class="future"><h2>'+SL.locale.get("NEW_SLIDE_TITLE")+"</h2></section>"),n=e.find("section.present");n.length?t.insertAfter(n):e.append(t),Reveal.slide(),this.updateEditableInstances(),this.navigateToSlide(t.get(0)),this.navigateToSlide(t.get(0)),Reveal.sync()},addHorizontalSlide:function(){var e=SLConfig.deck.rtl?"past":"future";$('<section class="'+e+'"><h2>Title</h2></section>').insertAfter(this.getCurrentHorizontalSlide()),Reveal.slide(),Reveal.sync(),this.updateEditableInstances(),SLConfig.deck.rtl?setTimeout(Reveal.navigateLeft,1):setTimeout(Reveal.navigateRight,1)},removeCurrentSlide:function(){0===$(".reveal .slides .present .present").remove().length?$(".reveal .slides>section").length>1&&$(".reveal .slides>.present").remove():1===$(".reveal .slides .present>section").length&&$(".reveal .slides .present>section:eq(0)").unwrap(),Reveal.slide(),Reveal.sync(),this.updateNavigationButtons(),SL.analytics.track("Deck.edit: Remove slide")},updateNavigationButtons:function(){this.addHorizontalSlideButton.addClass("show"),this.addVerticalSlideButton.addClass("show"),this.slideOptions.syncRemoveSlide()},writeHTMLToCurrentSlide:function(e){Reveal.getCurrentSlide().innerHTML=e,SL.util.html.trimCode(Reveal.getCurrentSlide())},importSlides:function(e,t){if(e&&e.length){var n=$(".reveal .slides");t&&n.empty(),n.append(e),Reveal.sync(),Reveal.slide(0,0),this.updateEditableInstances()}},getCurrentTheme:function(){var e=SL.current_user.getThemes().get({id:SLConfig.deck.theme_id});return e||(e=SL.models.Theme.fromDeck(SLConfig.deck)),e},onThemeChanged:function(){SL.views.decks.edit.SnippetsButton.sync(this),this.slideOptions.syncCustomClasses()},onUserInput:function(){clearInterval(this.saveInterval),this.saveInterval=setInterval(this.checkAutoSave.bind(this),SL.config.AUTOSAVE_INTERVAL)},onLoggedIn:function(){this.hasLoggedOut&&(this.hasLoggedOut=!1,SL.modal.close())},onLoggedOut:function(){this.getMode("arrange").isActive()||this.hasLoggedOut||(this.hasLoggedOut=!0,SL.modal.open("no-session"))},onSlideFocused:function(){this.layout()},onSlideBlurred:function(){},onAddHorizontalSlideClicked:function(e){e.preventDefault(),this.addHorizontalSlide()},onAddVerticalSlideClicked:function(e){e.preventDefault(),this.addVerticalSlide()},onExitPreviewClicked:function(){this.changeMode(null)},onWindowKeyUp:function(){this.onUserInput()},onDocumentKeyDown:function(e){var t=this.sidebar.isExpanded();if((e.metaKey||e.ctrlKey)&&83===e.keyCode)this.hasUnsavedChanges&&this.save(),e.preventDefault();else if(t||!e.metaKey&&!e.ctrlKey||89!==e.keyCode)if(!t&&(e.metaKey||e.ctrlKey)&&e.shiftKey&&90===e.keyCode)SL.views.decks.edit.HistoryController.redo(),e.preventDefault();else if(t||!e.metaKey&&!e.ctrlKey||90!==e.keyCode)if(t||!e.metaKey&&!e.ctrlKey||70!==e.keyCode){if(!t&&e.shiftKey&&e.altKey&&70===e.keyCode)this.toggleMode("fragment"),e.preventDefault();else if(!t&&e.shiftKey&&e.altKey&&80===e.keyCode)this.toggleMode("absolute"),e.preventDefault();else if(!t&&e.shiftKey&&e.altKey&&72===e.keyCode)this.slideOptions.triggerHTML(),e.preventDefault();else if(!t&&e.shiftKey&&e.altKey&&78===e.keyCode)this.slideOptions.triggerNotes(),e.preventDefault();else if(9===e.keyCode)0===$("input:focus, textarea:focus, button:focus").length&&(skriv.util.execCommand(e.shiftKey?"outdent":"indent",!0,null),e.preventDefault());else if(27===e.keyCode){var n=$("input:focus, textarea:focus, [contenteditable]:focus"),i=$(Reveal.getCurrentSlide()),s=this.getMode();if(s&&s.isActive()&&"css"===s.getID())return;this.slideOptions.hasOpenPanel()&&this.slideOptions.collapse(),this.toolbar.getOpenAction()?this.toolbar.closeActions():s&&s.isActive()&&/(absolute|fragment|preview)/gi.test(s.getID())?(s.deactivate(),/(absolute|fragment)/gi.test(s.getID())&&i.focus()):n&&n.length?n.blur():this.sidebar.isExpanded()?this.sidebar.close():Reveal.toggleOverview()}}else this.toggleMode("preview"),e.preventDefault();else SL.views.decks.edit.HistoryController.push(this.getDeckAsString(),{skipTimeLimit:!0}),SL.views.decks.edit.HistoryController.undo(),e.preventDefault();else SL.views.decks.edit.HistoryController.redo(),e.preventDefault()},onWindowBeforeUnload:function(){return this.hasUnsavedChanges?SL.locale.get("LEAVE_UNSAVED_DECK"):void 0},onWindowResize:function(){Reveal.layout(),this.layout()},onSlideKeyDown:function(e){if(!(9!==e.keyCode||e.shiftKey||e.altKey||e.ctrlKey||e.metaKey)){var t=$(e.target);t.is("section")&&t.parents(".slides").length&&e.preventDefault()}},onSlideMouseDown:function(e){var t=$(e.target);if(t.is("section.present:not(.stack)")){var n=$(t.get(0).childNodes[0]).is(".absolute-element"),i=0===t.find(">*:not(.absolute-element)").length;n&&i&&t.prepend("&nbsp;")}},onUndoOrRedo:function(e){var t=$(document.activeElement).closest(".slides section.present[contenteditable]").length>0,n=Reveal.getIndices();this.clearMode();var i=$(".reveal .slides");i.addClass("no-transition"),setTimeout(function(){i.removeClass("no-transition")},1),i.html(e.data),Reveal.sync(),Reveal.slide(e.indices.h,e.indices.v),this.updateEditableInstances();var s=this.getMode(e.mode);if(s)s.activate();else if(t&&n.h===e.indices.h&&n.v===e.indices.v){var o=Reveal.getSlide(e.indices.h,e.indices.v||void 0);o&&SL.util.selection.moveCursorToEnd(o)}}}),SL("views.decks.edit").HistoryController={MAX_SIZE:100,MAX_FREQUENCY:1500,MODE_RESTING:1,MODE_UNDOING:2,MODE_REDOING:3,init:function(){this.past=[],this.future=[],this.mode=SL.views.decks.edit.HistoryController.MODE_RESTING,this.lastPushTime=-1,this.changed=new signals.Signal,this.undid=new signals.Signal,this.redid=new signals.Signal},push:function(e,t){t=t||{};var n=Date.now();if(n-this.lastPushTime>SL.views.decks.edit.HistoryController.MAX_FREQUENCY||t.skipTimeLimit){this.lastPushTime=Date.now();var i={data:e,indices:Reveal.getIndices()},s=SL.view.getMode();s&&(i.mode=s.id);var o=this.past[this.past.length-1],a=this.future[this.future.length-1];for(o&&i.data===o.data||a&&i.data===a.data||(this.future.length&&this.past.push(this.future.pop()),this.future.length=0,this.past.push(i),this.mode=SL.views.decks.edit.HistoryController.MODE_RESTING,this.changed.dispatch());this.past.length>SL.views.decks.edit.HistoryController.MAX_SIZE;)this.past.shift()}},undo:function(e){e=e||{};var t=this.past.pop();return t&&this.mode!==SL.views.decks.edit.HistoryController.MODE_UNDOING&&(this.future.push(t),t=this.past.pop()),t&&(this.mode=SL.views.decks.edit.HistoryController.MODE_UNDOING,this.future.push(t),this.lastPushTime=Date.now(),e.ignoreMode&&(t=JSON.parse(JSON.stringify(t)),t.mode=null),this.undid.dispatch(t),this.changed.dispatch()),t},redo:function(e){e=e||{};var t=this.future.pop();return t&&this.mode!==SL.views.decks.edit.HistoryController.MODE_REDOING&&(this.past.push(t),t=this.future.pop()),t&&(this.mode=SL.views.decks.edit.HistoryController.MODE_REDOING,this.past.push(t),this.lastPushTime=Date.now(),e.ignoreMode&&(t=JSON.parse(JSON.stringify(t)),t.mode=null),this.redid.dispatch(t),this.changed.dispatch()),t},canUndo:function(){return this.past.length>0},canRedo:function(){return this.future.length>0}},SL("views.decks.edit").MediaController={init:function(){this.bind(),this.setupDragAndDrop(),this.setupPasteFromClipboard()},bind:function(){$(".reveal").delegate("section.present[contenteditable] img","click",function(){if("function"==typeof window.getSelection&&"function"==typeof document.createRange){var e=window.getSelection(),t=document.createRange();t.selectNode(this),e.removeAllRanges()}e.addRange(t)}),SL.components.Resizer.delegateOnHover($(".reveal"),"section.present[contenteditable] img",{preserveAspectRatio:!0}),SL.components.Resizer.delegateOnHover($(".reveal"),"section.present[contenteditable] video",{preserveAspectRatio:!0}),SL.components.Resizer.delegateOnHover($(".reveal"),"section.present[contenteditable] iframe",{preserveAspectRatio:!1,useOverlay:!0})},setupDragAndDrop:function(){var e=$(document.documentElement),t=!1;$(document.body).append('<div class="drag-and-drop-instructions"></div>'),e.on("dragstart",function(){t=!0}),e.on("dragover dragenter",function(){return t?void 0:(e.addClass("drag-and-drop-over"),!1)}),e.on("dragleave",function(){return t?void 0:(e.removeClass("drag-and-drop-over"),!1)}),e.on("drop",function(n){if(!t){n.stopPropagation(),n.preventDefault(),e.removeClass("drag-and-drop-over");var i=$(Reveal.getCurrentSlide()),s=new SL.helpers.FileUploader({file:n.originalEvent.dataTransfer.files[0],service:SL.config.AJAX_IMAGE_UPLOAD,timeout:6e4}),o=$('<img class="spinner-bitmap file-placeholder editing-ui">').appendTo(i);return s.succeeded.add(function(e){s.destroy(),s=null,e&&"string"==typeof e.url?o.attr("src",e.url).removeClass("spinner-bitmap file-placeholder editing-ui"):(o.remove(),SL.notify("An error occurred while uploading your image.","negative"))}.bind(this)),s.failed.add(function(){s.destroy(),s=null,o.remove(),SL.notify("An error occurred while uploading your image.","negative")}.bind(this)),s.upload(),!1}t=!1})},setupPasteFromClipboard:function(){$(".reveal").on("paste",function(){setTimeout(function(){$("img[src^=webkit-fake-url]").remove()},1)}),$(".reveal").pasteImageReader(function(e){e&&e.file&&e.dataURL&&this.uploadImageBlob(e.file,"pasted-from-clipboard.png")}.bind(this))},uploadImageBlob:function(e,t){if(e&&t&&e.type.match(/image.*/)&&0!==$(SL.view.getFocusedSlide()).length){var n=SL.util.getPlaceholderImage(!0);skriv.util.execCommand("insertImage",!1,n);var i=$('img[src="'+n+'"]').addClass("spinner-bitmap file-placeholder editing-ui"),s=new SL.helpers.FileUploader({file:e,filename:t,service:SL.config.AJAX_IMAGE_UPLOAD,timeout:6e4});s.succeeded.add(function(e){s.destroy(),e&&"string"==typeof e.url?i.attr("src",e.url).removeClass("spinner-bitmap file-placeholder editing-ui"):(i.remove(),SL.notify("An error occurred while uploading your image.","negative"))}.bind(this)),s.failed.add(function(){s.destroy(),i.remove(),SL.notify("An error occurred while uploading your image.","negative")}.bind(this)),s.upload()}}},SL("views.decks.edit.modes").Base=Class.extend({init:function(e,t){this.id=t,this.editor=e,this.active=!1,this.activated=new signals.Signal,this.deactivated=new signals.Signal,this.onSlideChanged=this.onSlideChanged.bind(this),this.render(),this.bind()},bind:function(){},render:function(){},activate:function(){this.active=!0,$("html").attr("data-mode",this.id),this.deactivateOnSlideChange&&Reveal.addEventListener("slidechanged",this.onSlideChanged),this.activated.dispatch()},deactivate:function(){this.active=!1,$("html").removeAttr("data-mode"),this.deactivateOnSlideChange&&Reveal.removeEventListener("slidechanged",this.onSlideChanged),this.deactivated.dispatch()},toggle:function(){this.isActive()?this.deactivate():this.activate()},isActive:function(){return this.active},getID:function(){return this.id},onSlideChanged:function(){this.deactivate()}}),SL("views.decks.edit.modes").Absolute=SL.views.decks.edit.modes.Base.extend({MIN_Z:4,init:function(e){this.deactivateOnSlideChange=!0,this._super(e,"absolute"),this.onMoveElementToTop=this.onMoveElementToTop.bind(this),this.onMoveElementToBottom=this.onMoveElementToBottom.bind(this),this.onMakeElementRelative=this.onMakeElementRelative.bind(this),this.onOverlayMouseDown=this.onOverlayMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onResizerUpdate=this.onResizerUpdate.bind(this),this.mouseStartPosition={x:0,y:0},this.elementStartPosition={x:0,y:0}},render:function(){this._super(),this.toolbar=$('<div class="toolbar absolute-toolbar"><div class="inner"><p class="description">Drag elements to position them freely within the slide.</p><button class="button grey done">Done</button></div></div>').appendTo($(".projector"))},bind:function(){this._super(),this.toolbar.find(".done").on("click",this.deactivate.bind(this))},layout:function(){this.resizerDelegate&&this.resizerDelegate.layout(),this.syncOverlays()},activate:function(){if(!this.isActive()){var e=$(Reveal.getCurrentSlide());this.overlays=$('<div class="absolute-overlay editing-ui">').appendTo(e),e.find(">*").each(function(e,t){t=$(t);var n=t.is("img, video, iframe");if(!(t.hasClass("editing-ui")||""===t.get(0).innerHTML&&!n||1===t.children().length&&t.children().first().is("br")&&!/\w/i.test(t.text()))){var i=$('<div class="editing-ui absolute-overlay-item"><div class="inner"><div class="action z-index"><span class="icon move-to-bottom i-arrow-down" data-tooltip="Move to bottom (depth)" data-tooltip-ox="-2"></span><span class="icon move-to-top i-arrow-up" data-tooltip="Move to top (depth)" data-tooltip-ox="-2"></span></div><div class="action make-relative-button"><span class="icon i-minus" data-tooltip="Make relative" data-tooltip-ox="-2"></span></div></div></div>');i.data("target-element",t),t.is("img, video")&&i.data("resizer-options",{preserveAspectRatio:!0}),this.overlays.append(i)}}.bind(this)),this.overlays.find(".absolute-overlay-item .move-to-top").on("mousedown",this.onMoveElementToTop),this.overlays.find(".absolute-overlay-item .move-to-bottom").on("mousedown",this.onMoveElementToBottom),this.overlays.find(".absolute-overlay-item .make-relative-button").on("mousedown",this.onMakeElementRelative),this.overlays.find(".absolute-overlay-item").on("mousedown",this.onOverlayMouseDown),this.createResizeDelegate(),this.editor.disableEditing(),this.editor.slideOptions.collapse(),this.syncOverlays(),this._super()}},deactivate:function(){this.isActive()&&(this.overlays.find(".move-to-top").off(),this.overlays.find(".move-to-bottom").off(),this.overlays.find(".make-relative-button").off(),this.overlays.off().remove(),this.overlays=null,this.destroyResizeDelegate(),this.editor.enableEditing(),this._super())},createResizeDelegate:function(){$(Reveal.getCurrentSlide());this.overlays&&this.overlays.length&&(this.resizerDelegate=SL.components.Resizer.delegateOnHover(this.overlays,".absolute-overlay-item.is-absolute"),this.resizerDelegate.updated.add(this.onResizerUpdate))},destroyResizeDelegate:function(){this.resizerDelegate&&(this.resizerDelegate.destroy(),this.resizerDelegate=null)},makeAbsoluteElement:function(e){if(!e.hasClass("absolute-element")){e.addClass("absolute-element"),e.css({position:"absolute"});var t=0;return e.is("img, video, iframe")||(t=10),e.is("img, video, iframe")&&e.css({maxHeight:"none",maxWidth:"none"}),e.css({width:e.outerWidth()+t,height:e.outerHeight(),zIndex:4}),this.layout(),!0}},unmakeAbsoluteElement:function(e){e.hasClass("absolute-element")&&(e.css({position:"",width:"",height:"",left:"",top:"",zIndex:""}),e.removeClass("absolute-element"),this.layout())},syncOverlays:function(){this.overlays.children().each(function(e,t){var n=$(t),i=n.data("target-element"),s=SL.util.getRevealElementOffset(i,!0);n.css({left:s.left,top:s.top,width:i.outerWidth(!0),height:i.outerHeight(!0),zIndex:i.css("z-index")}),n.toggleClass("is-absolute",i.hasClass("absolute-element"))})},onMakeElementRelative:function(e){var t=$(e.target).closest(".absolute-overlay-item").data("target-element");return t&&t.length?(SL.tooltip.hide(),this.unmakeAbsoluteElement(t),!1):void 0},onMoveElementToTop:function(e){var t=$(e.target).closest(".absolute-overlay-item").data("target-element");if(t&&t.length){var n=$(Reveal.getCurrentSlide()).find(".absolute-element");n.sort(function(e,t){return Number(e.style.zIndex)-Number(t.style.zIndex)});var i=this.MIN_Z;n.each(function(e,t){$(t).css("z-index",i++)}.bind(this)),t.css("z-index",i),this.syncOverlays()}},onMoveElementToBottom:function(e){var t=$(e.target).closest(".absolute-overlay-item").data("target-element");if(t&&t.length){var n=$(Reveal.getCurrentSlide()).find(".absolute-element");n.sort(function(e,t){return Number(e.style.zIndex)-Number(t.style.zIndex)}),n.each(function(e,t){$(t).css("z-index",this.MIN_Z+e+1)}.bind(this)),t.css("z-index",this.MIN_Z),this.syncOverlays()}},onOverlayMouseDown:function(e){if(this.dragOverlay=$(e.currentTarget),this.dragTarget=this.dragOverlay.data("target-element"),this.dragOverlay.length&&this.dragTarget&&this.dragTarget.length){var t=SL.util.getRevealElementOffset(this.dragTarget,!0),n=this.dragTarget.width(),i=this.dragTarget.height();this.makeAbsoluteElement(this.dragTarget)&&this.dragTarget.css({left:t.left+(n-this.dragTarget.width())/2,top:t.top+(i-this.dragTarget.height())/2});var s=SL.util.getRevealElementOffset(this.dragTarget,!0),o=SL.util.getRevealCounterScale();this.elementStartPosition={x:s.left,y:s.top},this.mouseStartPosition={x:e.clientX*o,y:e.clientY*o},this.dragTarget.find("[data-tooltip]").attr("no-tooltip",""),this.dragOverlay.addClass("is-dragging"),$(window).on("mousemove",this.onMouseMove),$(window).on("mouseup",this.onMouseUp),this.onMouseMove(e),this.destroyResizeDelegate()}else this.dragTarget=null;return!1},onMouseMove:function(e){var t=SL.util.getRevealCounterScale();return this.dragTarget.css({left:Math.round(this.elementStartPosition.x+(e.clientX*t-this.mouseStartPosition.x)),top:Math.round(this.elementStartPosition.y+(e.clientY*t-this.mouseStartPosition.y))}),this.layout(),!1},onMouseUp:function(e){this.dragOverlay&&this.dragOverlay.length&&this.dragOverlay.removeClass("is-dragging"),this.dragTarget&&this.dragTarget.length&&this.dragTarget.find("[data-tooltip]").removeAttr("no-tooltip",""),this.createResizeDelegate();var t=$(e.target).closest(".absolute-overlay-item").data("target-element");return this.dragTarget&&this.dragTarget.is(t)&&this.resizerDelegate.show(this.dragTarget,this.dragOverlay.data("resizer-options")),this.dragOverlay=null,this.dragTarget=null,$(window).off("mousemove",this.onMouseMove),$(window).off("mouseup",this.onMouseUp),!1},onResizerUpdate:function(){this.layout()}}),SL("views.decks.edit.modes").Arrange=SL.views.decks.edit.modes.Base.extend({init:function(e){this._super(e,"arrange")},bind:function(){Reveal.addEventListener("overviewshown",this.onRevealOverviewShown.bind(this)),Reveal.addEventListener("overviewhidden",this.onRevealOverviewHidden.bind(this))},activate:function(e){e||Reveal.toggleOverview(!0),this.editor.disableEditing(),this.editor.sidebar.updateArrangeButton("arranging");var t=['<div class="arrange-controls editing-ui">','<div class="move-left i-arrow-left-alt1"></div>','<div class="move-right i-arrow-right-alt1"></div>','<div class="move-up i-arrow-up-alt1"></div>','<div class="move-down i-arrow-down-alt1"></div>','<div class="merge-left i-previous" data-tooltip-delay="500"></div>','<div class="merge-right i-next" data-tooltip-delay="500"></div>',"</div>"].join("");$(".reveal .slides section:not(.stack)").append(t).addClass("disabled"),$(".reveal .slides section.stack").each(function(e,t){0===$(t).find(".present").length&&$(t).find("section").first().addClass("present")}),$(".reveal .slides section .move-left").on("click",this.onMoveSlideLeft.bind(this)),$(".reveal .slides section .move-right").on("click",this.onMoveSlideRight.bind(this)),$(".reveal .slides section .move-up").on("click",this.onMoveSlideUp.bind(this)),$(".reveal .slides section .move-down").on("click",this.onMoveSlideDown.bind(this)),$(".reveal .slides section .merge-left").on("click",this.onMergeLeft.bind(this)),$(".reveal .slides section .merge-right").on("click",this.onMergeRight.bind(this)),this.syncControls(),SL.analytics.track("Deck.edit: Arrange",{state:"on"}),$(document.activeElement).blur(),this._super()},deactivate:function(e){e||Reveal.toggleOverview(!1),this.editor.enableEditing(),this.editor.sidebar.updateArrangeButton(),$(".reveal .slides section:not(.stack)").removeClass("disabled"),$(".reveal .slides section .arrange-controls").remove(),this.isActive()&&SL.analytics.track("Deck.edit: Arrange",{state:"off"}),this._super()},syncControls:function(){},onRevealOverviewShown:function(){this.isActive()||(this.editor.clearMode(),this.activate(!0))},onRevealOverviewHidden:function(){this.isActive()&&this.deactivate(!0)},onMoveSlideLeft:function(e){var t=$(e.target).parents("section").first();t.parents("section.stack").length&&(t=t.parents("section.stack"));var n=t.prev();t.length&&n.length&&(t.after(n),Reveal.slide(t.index()),Reveal.slide(t.index()),Reveal.toggleOverview(!0),Reveal.sync(),this.syncControls())},onMoveSlideRight:function(e){var t=$(e.target).parents("section").first();t.parents("section.stack").length&&(t=t.parents("section.stack"));var n=t.next();t.length&&n.length&&(t.before(n),Reveal.slide(t.index()),Reveal.slide(t.index()),Reveal.toggleOverview(!0),Reveal.sync(),this.syncControls())},onMoveSlideUp:function(e){var t=$(e.target).parents("section").first(),n=t.prev();t.length&&n.length&&(t.after(n),Reveal.slide(t.parents("section.stack").index(),t.index()),Reveal.slide(t.parents("section.stack").index(),t.index()),Reveal.toggleOverview(!0),Reveal.sync(),this.syncControls())},onMoveSlideDown:function(e){var t=$(e.target).parents("section").first(),n=t.next();t.length&&n.length&&(t.before(n),Reveal.slide(t.parents("section.stack").index(),t.index()),Reveal.slide(t.parents("section.stack").index(),t.index()),Reveal.toggleOverview(!0),Reveal.sync(),this.syncControls())},onMergeLeft:function(e){var t=$(e.target).parents("section").first(),n=t.prev();if(t.parents("section.stack").prev().length&&(n=t.parents("section.stack").prev()),t.length){t.parents("section.stack").length?t.insertBefore(t.parents("section.stack")):n.is("section.stack")?n.prepend(t):this.editor.mergeHorizontalSlides(n,t),this.editor.unwrapEmptyStacks();var i=Reveal.getIndices(t.get(0));Reveal.slide(i.h,i.v),Reveal.slide(i.h,i.v),Reveal.toggleOverview(!0),Reveal.sync(),this.syncControls()}},onMergeRight:function(e){var t=$(e.target).parents("section").first(),n=t.next();if(t.parents("section.stack").next().length&&(n=t.parents("section.stack").next()),t.length){t.parents("section.stack").length?t.insertAfter(t.parents("section.stack")):n.is("section.stack")?n.prepend(t):this.editor.mergeHorizontalSlides(n,t),this.editor.unwrapEmptyStacks();var i=Reveal.getIndices(t.get(0));Reveal.slide(i.h,i.v),Reveal.slide(i.h,i.v),Reveal.toggleOverview(!0),Reveal.sync(),this.syncControls()}}}),SL("views.decks.edit.modes").CSS=SL.views.decks.edit.modes.Base.extend({init:function(e){this.userCSSInput=$("#user-css-input"),this.userCSSOutput=$("#user-css-output"),this.parseTimeout=-1,this.userCSSInput.length&&(SLConfig.deck.css_input=this.userCSSInput.html()||void 0),this.userCSSOutput.length&&(SLConfig.deck.css_output=this.userCSSOutput.html()||void 0),this._super(e,"css")},render:function(){this.domElement=$('<div class="css-editor">').appendTo(document.body),this.headerElemenet=$("<header>").appendTo(this.domElement),this.headerElemenet.append('<p>Enter custom styles using LESS or plain CSS. All selectors are prefixed with .reveal on save. <a href="http://help.slides.com/knowledgebase/articles/253052-css-editor-pro-" target="_blank">Find out more and see examples.</a></p>'),this.contentsElement=$('<div class="contents">').appendTo(this.domElement),this.contentsElement.append('<div id="ace-less" class="editor"></div>'),this.errorElement=$('<div class="error">').appendTo(this.contentsElement),this.footerElement=$("<footer>").appendTo(this.domElement),this.cancelButton=$('<button class="button cancel negative grey xl">Cancel</button>').appendTo(this.footerElement),this.saveButton=$('<button class="button save positive xl">OK</button>').appendTo(this.footerElement)},renderEditor:function(){if(!this.cssEditor){try{this.cssEditor=ace.edit("ace-less"),this.cssEditor.setTheme("ace/theme/monokai"),this.cssEditor.setDisplayIndentGuides(!0),this.cssEditor.setShowPrintMargin(!1),this.cssEditor.getSession().setMode("ace/mode/less")}catch(e){console.log("An error occurred while initializing the Ace editor.")}this.cssEditor.env.editor.on("change",this.onInputChange.bind(this))}},bind:function(){this.cancelButton.on("click",this.onCancelClicked.bind(this)),this.saveButton.on("click",this.onSaveClicked.bind(this))},activate:function(){this.renderEditor(),this.editor.disableEditing(),this.editor.sidebar.close(!0),this.domElement.addClass("visible"),this.savedCSSInput=SLConfig.deck.css_input,this.savedCSSOutput=SLConfig.deck.css_output,this.currentCSSInput=SLConfig.deck.css_input,this.errorElement.text("").removeClass("visible"),this.cssEditor.env.document.setValue(SLConfig.deck.css_input),this.cssEditor.focus(),SL.util.layoutReveal(500,30),this._super()},deactivate:function(){this.editor.enableEditing(),this.domElement.removeClass("visible"),SL.util.layoutReveal(500,30),this._super()},saveAndClose:function(){this.compile(function(e){SLConfig.deck.css_input=this.cssEditor.env.document.getValue(),SLConfig.deck.css_output=e,SLConfig.deck.dirty=!0,this.editor.invalidateThumbnail(),this.deactivate()}.bind(this),function(){SL.notify("Please fix all errors before saving.","negative")}.bind(this))},compile:function(e,t){this.cssParser||(this.cssParser=new less.Parser);var n=this.cssEditor.env.document.getValue();this.cssParser.parse(".reveal { "+n+" }",function(n,i){if(n)this.errorElement.addClass("visible"),this.errorElement.html(n.message),t&&t.call(null,n);else{this.errorElement.removeClass("visible");var s=i.toCSS();this.userCSSOutput.html(s),e&&e.call(null,s)}}.bind(this)),this.currentCSSInput=n},discard:function(){SLConfig.deck.css_input=this.savedCSSInput,SLConfig.deck.css_output=this.savedCSSOutput,this.userCSSOutput.html(SLConfig.deck.css_output||"")},onInputChange:function(){clearTimeout(this.parseTimeout),this.parseTimeout=setTimeout(this.compile.bind(this),500)},onCancelClicked:function(e){this.currentCSSInput!==this.savedCSSInput?SL.prompt({anchor:$(e.currentTarget),title:"You will lose all unsaved changes.",alignment:"t",type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Continue</h3>",className:"negative",callback:function(){this.discard(),this.deactivate()}.bind(this)}]}):(this.discard(),this.deactivate())},onSaveClicked:function(){this.saveAndClose()}}),SL("views.decks.edit.modes").Fragment=SL.views.decks.edit.modes.Base.extend({init:function(e){this.deactivateOnSlideChange=!0,this._super(e,"fragment"),this.onFragmentMouseDown=this.onFragmentMouseDown.bind(this)},render:function(){this._super();var e="Fragments are invisible until stepped through when<br>you present. Preview to see them in action.";this.toolbar=$('<div class="toolbar fragment-toolbar"><div class="inner"><p class="description">Click on elements to turn them into <u data-tooltip="'+e+'" data-tooltip-alignment="b">fragments</u>.</p><button class="button grey done">Done</button></div></div>').appendTo($(".projector"))},bind:function(){this._super(),this.toolbar.find(".done").on("click",this.deactivate.bind(this))},activate:function(){if(!this.isActive()){var e=$(Reveal.getCurrentSlide());this.overlays=$('<div class="fragment-overlay editing-ui">').appendTo(e),e.find(">*").each(function(e,t){t=$(t);var n=t.is("img, video, iframe");if(!(t.hasClass("editing-ui")||""===t.get(0).innerHTML&&!n||1===t.children().length&&t.children().first().is("br")&&!/\w/i.test(t.text()))){var i=t.find("li");i.length>0&&(t=i),t.each(function(e,t){var n=$('<div class="editing-ui fragment-overlay-item"><div class="inner"><span class="icon i-check-alt"></span></div></div>');n.data("target-element",$(t)),this.overlays.append(n)}.bind(this))}}.bind(this)),this.overlays.find(".fragment-overlay-item").on("mousedown",this.onFragmentMouseDown),this.editor.disableEditing(),this.editor.slideOptions.collapse(),this.syncOverlays(),this._super()}},deactivate:function(){this.isActive()&&(this.overlays.find(".fragment-overlay-item").off(),this.overlays.off().remove(),this.overlays=null,this.editor.enableEditing(),this._super())},syncOverlays:function(){this.overlays.children().each(function(e,t){var n=$(t),i=n.data("target-element"),s=SL.util.getRevealElementOffset(i,!0);n.css({left:s.left,top:s.top,width:i.outerWidth(!0),height:i.outerHeight(!0),zIndex:i.css("z-index")}),n.toggleClass("is-active",i.hasClass("fragment"))})},onFragmentMouseDown:function(e){var t=$(e.target).data("target-element");return t.length&&(t.toggleClass("fragment"),this.syncOverlays()),!1}}),SL("views.decks.edit.modes").Preview=SL.views.decks.edit.modes.Base.extend({init:function(e){this._super(e,"preview")},activate:function(){Reveal.isOverview()&&Reveal.toggleOverview(!1),this.editor.disableEditing(),this.editor.sidebar.close(),this.editor.toolbar.closeActions(),SL.analytics.track("Deck.edit: Preview",{state:"on"}),this._super(),Reveal.configure({progress:!0,overview:!1,touch:!0,fragments:!0,center:SLConfig.deck.center,autoSlide:SLConfig.deck.auto_slide_interval||0});var e=Reveal.getIndices();Reveal.slide(e.h,e.v,0),SL.util.layoutReveal(500),$(document.activeElement).blur()},deactivate:function(){this.editor.enableEditing(),this.isActive()&&SL.analytics.track("Deck.edit: Preview",{state:"off"}),this._super(),Reveal.configure({progress:!1,overview:!0,touch:!1,center:!1,fragments:!1,autoSlide:0}),SL.util.layoutReveal(500)}}),SL("views.decks.edit.panels").Base=Class.extend({init:function(){this.saved=!1,this.onWindowResize=this.onWindowResize.bind(this),this.onDocumentKeyDown=this.onDocumentKeyDown.bind(this),this.onSaveClicked=this.onSaveClicked.bind(this),this.onCancelClicked=this.onCancelClicked.bind(this),this.onCloseClicked=this.onCloseClicked.bind(this),this.bind(),this.createSignals()},bind:function(){this.domElement.find(".save").on("click",this.onSaveClicked),this.domElement.find(".cancel").on("click",this.onCancelClicked),this.domElement.find(".close").on("click",this.onCloseClicked)},createSignals:function(){this.onclose=new signals.Signal},buffer:function(){this.config=JSON.parse(JSON.stringify(SLConfig))},open:function(){this.saved=!1,this.domElement.addClass("visible"),this.layout(),$(window).on("resize",this.onWindowResize),$(document).on("keydown",this.onDocumentKeyDown)},close:function(){this.domElement.removeClass("visible"),$(window).off("resize",this.onWindowResize),$(document).off("keydown",this.onDocumentKeyDown),this.saved===!1&&this.revert()},layout:function(){var e=this.domElement.find(".panel-body"),t=this.domElement.find(".panel-footer");if(e.length&&t.length){var n=e.get(0).scrollHeight,i=t.outerHeight(!0)+parseInt(t.css("margin-top"),10);this.domElement.toggleClass("overflowing",n>window.innerHeight-i)}},revert:function(){this.buffer(),this.updateSelection(),this.applySelection()},save:function(){return this.saved=!0,!0},updateSelection:function(){},applySelection:function(){},onSaveClicked:function(){this.save()&&this.onclose.dispatch()},onCancelClicked:function(){this.onclose.dispatch()},onCloseClicked:function(){this.onclose.dispatch()},onDocumentKeyDown:function(){},onWindowResize:function(){this.layout()}}),SL("views.decks.edit.panels").Export=SL.views.decks.edit.panels.Base.extend({init:function(){this.domElement=$(".sidebar-panel .export"),this.htmlOutputElement=this.domElement.find(".deck-html-contents"),this.downloadElement=this.domElement.find(".section.download"),this.downloadHTMLButton=this.domElement.find(".download-html"),this.downloadPDFButton=this.domElement.find(".download-pdf"),this.downloadPDFButtonLabel=this.domElement.find(".download-pdf .label"),this.downloadPDFButtonLabel.length&&(this.downloadPDFButtonLoader=Ladda.create(this.downloadPDFButton.get(0))),this.syncElement=this.domElement.find(".section.sync"),this.syncContents=this.syncElement.find(".contents"),this.dropboxPollGoal=null,this.pdfExportId=null,this.onDropboxPoll=this.onDropboxPoll.bind(this),this.onDropboxPollTimeout=this.onDropboxPollTimeout.bind(this),this.dropboxPollJob=new SL.helpers.PollJob({interval:2e3,timeout:3e5}),this.dropboxPollJob.polled.add(this.onDropboxPoll),this.dropboxPollJob.ended.add(this.onDropboxPollTimeout),this.onPDFExportPoll=this.onPDFExportPoll.bind(this),this.onPDFExportPollTimeout=this.onPDFExportPollTimeout.bind(this),this.pdfPollJob=new SL.helpers.PollJob({interval:1e3,timeout:18e4}),this.pdfPollJob.polled.add(this.onPDFExportPoll),this.pdfPollJob.ended.add(this.onPDFExportPollTimeout),this._super(),this.updatePDFExportButton()
},bind:function(){this._super(),this.downloadHTMLButton.on("click",this.onDownloadHTMLClicked.bind(this)),this.downloadPDFButton.on("click",this.onDownloadPDFClicked.bind(this)),this.htmlOutputElement.on("click",this.onHTMLOutputClicked.bind(this))},open:function(){this._super();var e='<div class="slides">'+SL.view.getDeckAsString()+"</div>";this.htmlOutputElement.text(SL.util.html.indent(e)),this.checkDropboxStatus(),this.pdfPollJob.stop()},close:function(){this._super(),this.dropboxStatusXHR&&this.dropboxStatusXHR.abort(),this.dropboxPollJob.stop(),this.dropboxPollGoal=null},checkDropboxStatus:function(){0!==this.syncElement.length&&(this.dropboxStatusXHR&&this.dropboxStatusXHR.abort(),this.dropboxStatusXHR=$.get(SL.config.AJAX_SERVICES_USER).done(function(e){var t="string"==typeof this.dropboxPollGoal;e&&e.dropbox_connected?(this.syncContents.html('<p>Your changes are automatically synced with Dropbox. Press the button below if you wish to disconnect.</p><button class="button negative disconnect-dropbox l">Disconnect</button>'),this.syncContents.find("button").on("click",this.onDropboxDisconnectClicked.bind(this)),t&&"connected"===this.dropboxPollGoal&&(this.dropboxPollJob.stop(),this.dropboxPollGoal=null,$.ajax({type:"POST",url:SL.config.AJAX_DROPBOX_SYNC_DECK(SLConfig.deck.id),data:{}})),this.layout()):(this.syncContents.html('<p>Connect with Dropbox to automatically sync your work. Presentations in your Dropbox folder can be viewed offline.</p><button class="button connect-dropbox l">Connect Dropbox</button>'),this.syncContents.find("button").on("click",this.onDropboxConnectClicked.bind(this)),t&&"disconnected"===this.dropboxPollGoal&&(this.dropboxPollJob.stop(),this.dropboxPollGoal=null),this.layout()),this.dropboxStatusXHR=null}.bind(this)))},startPDFExport:function(){this.pdfExportXHR&&this.pdfExportXHR.abort(),this.pdfExportXHR=$.post(SL.config.AJAX_PDF_EXPORT_START(SLConfig.deck.id)).done(function(e){this.pdfExportId=e.id,this.pdfExportXHR=null,this.pdfPollJob.start()}.bind(this)).fail(function(){this.updatePDFExportButton(!1),SL.notify(SL.locale.get("EXPORT_PDF_ERROR"),"negative")}.bind(this))},updatePDFExportButton:function(e){e?(this.downloadPDFButtonLabel.text(SL.locale.get("EXPORT_PDF_BUTTON_WORKING")),this.downloadPDFButtonLoader&&this.downloadPDFButtonLoader.start()):(this.downloadPDFButtonLabel.text(SL.locale.get("EXPORT_PDF_BUTTON")),this.downloadPDFButtonLoader&&this.downloadPDFButtonLoader.stop())},showPreviousPDF:function(e){if("string"==typeof e&&e.length){this.previousPDFElement&&(this.previousPDFElement.remove(),this.previousPDFElement=null);var t=(SLConfig.deck.slug||"deck")+".pdf";this.previousPDFElement=$('<p class="previous-pdf">Recent: <a href="'+e+'" download="'+t+'" target="_blank">'+t+"</a></p>").appendTo(this.downloadElement),this.layout()}},hidePreviousPDF:function(){this.previousPDFElement&&(this.previousPDFElement.remove(),this.previousPDFElement=null,this.layout())},onDownloadHTMLClicked:function(){window.open(SL.config.AJAX_EXPORT_DECK(SLConfig.deck.user.username,SLConfig.deck.slug)),this.onclose.dispatch(),SL.analytics.track("Deck.edit: Download as HTML")},onDownloadPDFClicked:function(){this.updatePDFExportButton(!0),this.startPDFExport(),SL.analytics.track("Deck.edit: Download as PDF")},onDropboxConnectClicked:function(){this.dropboxPollGoal="connected",this.dropboxPollJob.start(),SL.util.openPopupWindow(SL.config.AJAX_DROPBOX_CONNECT,"Sync with Dropbox",1024,650)},onDropboxDisconnectClicked:function(){this.dropboxPollGoal="disconnected",this.dropboxPollJob.start(),window.open(SL.config.AJAX_DROPBOX_DISCONNECT)},onDropboxPoll:function(){this.checkDropboxStatus()},onDropboxPollTimeout:function(){},onPDFExportPoll:function(){this.pdfStatusXHR&&this.pdfStatusXHR.abort(),this.pdfStatusXHR=$.get(SL.config.AJAX_PDF_EXPORT_STATUS(SLConfig.deck.id,this.pdfExportId)).done(function(e){if("string"==typeof e.url&&e.url.length){var t=$('<iframe style="display: none;">');t.appendTo(document.body),t.attr("src",e.url),setTimeout(t.remove,1e3),this.showPreviousPDF(e.url),this.updatePDFExportButton(!1),this.pdfPollJob.stop()}}.bind(this))},onPDFExportPollTimeout:function(){this.updatePDFExportButton(!1),SL.notify(SL.locale.get("EXPORT_PDF_ERROR"),"negative")},onHTMLOutputClicked:function(){this.htmlOutputElement.select()}}),SL("views.decks.edit.panels").Import=SL.views.decks.edit.panels.Base.extend({init:function(){this.domElement=$(".sidebar-panel .import"),this.html=this.domElement.find(".from-html"),this.htmlInput=this.domElement.find(".from-html .html-input"),this.htmlStatus=this.domElement.find(".from-html .html-status"),this.htmlStatusText=this.domElement.find(".from-html .html-status .text"),this.htmlStatusIcon=this.domElement.find(".from-html .html-status .icon"),this.htmlStatusProceed=this.domElement.find(".from-html .html-status .proceed"),this._super()},bind:function(){this._super(),this.htmlInput.on("input",this.onHTMLInputChange.bind(this)),this.htmlStatusProceed.on("click",this.onHTMLImportConfirmed.bind(this))},open:function(){this._super()},close:function(){this._super()},resetHTML:function(){this.htmlInput.val(""),this.htmlStatus.removeClass("visible")},validateHTML:function(){var e,t,n=$.trim(this.htmlInput.val());if(n.length>2){try{e=$(n)}catch(i){t="Failed to read HTML, make sure it's valid"}if(e&&(e=e.not("meta, script, link, style"),e.find("meta, script, link, style").remove(),e.is(".slides")&&(e=$("<div>").append(e)),0===e.find(".slides>section").length&&(t="Couldn't find any sections inside of .slides"),0===e.find(".slides").length&&(t="Couldn't find a .slides container")),window.contentsHTML=e,this.htmlStatus.addClass("visible"),!t){var s=e.find(".slides section").length;return this.htmlStatus.attr("data-state","success"),this.htmlStatusText.html("Ready to import <strong>"+s+"</strong> slides."),this.htmlStatusIcon.removeClass("i-bolt").addClass("i-checkmark"),e.find(".slides>section")}this.htmlStatus.attr("data-state","error"),this.htmlStatusText.html(t),this.htmlStatusIcon.removeClass("i-checkmark").addClass("i-bolt")}else this.htmlStatus.removeClass("visible");return null},onHTMLInputChange:function(){this.validateHTML()},onHTMLImportConfirmed:function(e){var t=this.validateHTML();t&&t.length&&SL.prompt({anchor:$(e.currentTarget),title:SL.locale.get("DECK_IMPORT_HTML_CONFIRM"),type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Import</h3>",selected:!0,className:"positive",callback:function(){SL.view.importSlides(t,!0),this.resetHTML(),this.close(),this.onclose.dispatch()}.bind(this)}]})}}),SL("views.decks.edit.panels").Revisions=SL.views.decks.edit.panels.Base.extend({init:function(){this.domElement=$(".sidebar-panel .revisions"),this.listElement=this.domElement.find(".version-list"),this.panelBody=this.domElement.find(".panel-body"),this._super()},bind:function(){this._super(),this.onPanelScroll=this.onPanelScroll.bind(this),this.onPanelScroll=$.debounce(this.onPanelScroll,200)},reset:function(){this.loadedAllPages=!1,this.loading=!1,this.page=1,this.listElement.empty(),this.domElement.attr("data-state","loading")},open:function(){this.reset(),this.load(),this.panelBody.on("scroll",this.onPanelScroll),this._super()},close:function(){this._super(),this.panelBody.off("scroll",this.onPanelScroll)},load:function(){this.loading||this.loadedAllPages||(this.loading=!0,$.ajax({url:SL.config.AJAX_GET_DECK_VERSIONS(SLConfig.deck.id,this.page),data:{page:this.page},context:this}).done(function(e){this.addVersions(e.results),this.layout(),0===e.results.length&&(this.loadedAllPages=!0)}).fail(function(){SL.notify(SL.locale.get("GENERIC_ERROR")),this.domElement.attr("data-state","error"),this.layout()}).always(function(){this.loading=!1,this.page+=1}))},addVersions:function(e){e.forEach(this.addVersion.bind(this)),this.listElement.find("li").length>0?this.domElement.attr("data-state","populated"):this.domElement.attr("data-state","empty")},addVersion:function(e){var t=$("<li>").appendTo(this.listElement),n=$('<span class="text">').appendTo(t);n.append(moment(e.created_at).format("MMM DD, hh:mm a")),n.append(' <span class="de-em">('+moment(e.created_at).fromNow()+")</span>");var i=$('<div class="actions">').appendTo(t),s=$('<button class="button outline restore" data-tooltip="Restore" data-tooltip-delay="500"><span class="icon i-undo"></button>').appendTo(i);s.on("click",this.onRestoreClicked.bind(this,e,s));var o=$('<a class="button outline preview" data-tooltip="Preview" data-tooltip-delay="500"><span class="icon i-eye"></span></a>').appendTo(i);o.attr({href:SL.config.AJAX_PREVIEW_DECK_VERSION(SLConfig.deck.user.username,SLConfig.deck.slug,e.content_uuid),target:"_blank"}),o.on("click",this.onPreviewClicked.bind(this,e,o))},onPreviewClicked:function(e,t,n){{var i=t.attr("href"),s=$("<span>"),o=($('<a href="'+i+'" target="_blank" class="button outline l">Open in new tab</a>').appendTo(s),$('<button class="button grey negative restore l">Restore</button>').appendTo(s));$('<button class="button grey close l">Close</button>').appendTo(s)}o.on("click",this.onRestoreClicked.bind(this,e,o)),SL.modal.open("preview-deck",{src:i,footer:s}),SL.analytics.track("Deck.edit: Revision preview"),n.preventDefault()},onRestoreClicked:function(e,t,n){SL.prompt({anchor:$(n.currentTarget),title:SL.locale.get("DECK_RESTORE_CONFIRM",{time:moment(e.created_at).fromNow()}),type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Restore</h3>",selected:!0,className:"negative",callback:this.onRestoreConfirmed.bind(this,e,t)}]}),n.preventDefault()},onRestoreConfirmed:function(e){SL.analytics.track("Deck.edit: Revision restore"),SL.helpers.PageLoader.show("Restoring..."),$.ajax({type:"post",url:SL.config.AJAX_RESTORE_DECK_VERSION(SLConfig.deck.id,e.id),data:e,context:this}).done(function(e){e&&"string"==typeof e.slug?window.location=SL.routes.DECK_EDIT(SLConfig.deck.user.username,e.slug):window.location.reload()}).fail(function(){SL.notify(SL.locale.get("GENERIC_ERROR")),this.layout(),SL.helpers.PageLoader.hide()})},onPanelScroll:function(){var e=this.panelBody.scrollTop(),t=this.panelBody.prop("scrollHeight"),n=this.panelBody.outerHeight(),i=e/(t-n);i>.8&&this.load()}}),SL("views.decks.edit.panels").Settings=SL.views.decks.edit.panels.Base.extend({init:function(){this.domElement=$(".sidebar-panel .settings"),this.rtlToggle=this.domElement.find('.sl-checkbox input[value="rtl"]'),this.loopToggle=this.domElement.find('.sl-checkbox input[value="should_loop"]'),this.commentsEnabledToggle=this.domElement.find('.sl-checkbox input[value="comments_enabled"]'),this.forkingEnabledToggle=this.domElement.find('.sl-checkbox input[value="forking_enabled"]'),this.titleInput=this.domElement.find("#deck-input-title"),this.descriptionInput=this.domElement.find("#deck-input-description"),this.slug=this.domElement.find(".slug"),this.slugInput=this.domElement.find("#deck-input-slug"),this.slugPrefix=this.domElement.find(".slug .text-prefix"),this.autoSlideInput=this.domElement.find("#deck-input-autoslide"),this.renderAutoSlideOptions(),this._super()},renderAutoSlideOptions:function(){var e='<option value="0">Off</option>';SL.config.AUTO_SLIDE_OPTIONS.forEach(function(t){e+='<option value="'+1e3*t+'">'+t+" seconds</option>"}),this.autoSlideInput.html(e)},bind:function(){this._super(),this.domElement.find(".sl-checkbox input").on("change",this.onToggleChange.bind(this)),this.titleInput.on("input",this.onTitleInput.bind(this)),this.slugInput.on("focus",this.onSlugFocus.bind(this)),this.slugInput.on("blur",this.onSlugBlur.bind(this)),this.descriptionInput.on("keypress",this.onDescriptionKeyPress.bind(this))},open:function(){this._super(),this.buffer(),this.updateSelection(),this.titleInput.val(SL.util.unescapeHTMLEntities(this.config.deck.title)),this.slugInput.val(this.config.deck.slug),this.descriptionInput.val(SL.util.unescapeHTMLEntities(this.config.deck.description)),this.autoSlideInput.val(this.config.deck.auto_slide_interval||0),this.slugPrefix.text(window.location.host+"/"+SLConfig.current_user.username+"/"),this.slugInput.css("padding-left",this.slugPrefix.position().left+this.slugPrefix.width())},close:function(){this._super()},save:function(){var e=this.titleInput.val(),t=this.slugInput.val(),n=this.descriptionInput.val();return e?t?(this._super(),SLConfig.deck.title=e,SLConfig.deck.description=n?n.replace(/\n/g," "):"",SLConfig.deck.slug=t,SLConfig.deck.rtl=this.rtlToggle.is(":checked"),SLConfig.deck.should_loop=this.loopToggle.is(":checked"),SLConfig.deck.comments_enabled=this.commentsEnabledToggle.is(":checked"),SLConfig.deck.forking_enabled=this.forkingEnabledToggle.is(":checked"),SLConfig.deck.auto_slide_interval=parseInt(this.autoSlideInput.val(),10)||0,SLConfig.deck.dirty=!0,SL.analytics.track("Deck.edit: Setting saved",{rtl:SLConfig.deck.rtl,should_loop:SLConfig.deck.should_loop,comments_enabled:SLConfig.deck.comments_enabled,forking_enabled:SLConfig.deck.forking_enabled,auto_slide_interval:SLConfig.deck.auto_slide_interval}),$("html").toggleClass("rtl",SLConfig.deck.rtl),!0):(SL.notify(SL.locale.get("DECK_EDIT_INVALID_SLUG"),"negative"),!1):(SL.notify(SL.locale.get("DECK_EDIT_INVALID_TITLE"),"negative"),!1)},updateSelection:function(){this.rtlToggle.prop("checked",this.config.deck.rtl),this.loopToggle.prop("checked",this.config.deck.should_loop),this.commentsEnabledToggle.prop("checked",this.config.deck.comments_enabled),this.forkingEnabledToggle.prop("checked",this.config.deck.forking_enabled)},applySelection:function(){Reveal.configure({rtl:this.rtlToggle.is(":checked"),loop:this.loopToggle.is(":checked")})},generateSlug:function(){if(this.deckIsPrivate()&&this.slugIsUnchanged()){var e=this.titleInput.val(),t=SL.util.string.slug(e);this.slugInput.val(t)}},deckIsPrivate:function(){return SLConfig.deck.visibility===SL.models.Deck.VISIBILITY_SELF},slugIsUnchanged:function(){return(SLConfig.deck.slug||"")===(SL.util.string.slug(SLConfig.deck.title)||"")},onToggleChange:function(){this.applySelection()},onTitleInput:function(){this.generateSlug()},onDescriptionKeyPress:function(e){return 13==e.keyCode?!1:void 0},onSlugFocus:function(){this.deckIsPrivate()||SL.tooltip.show("Changing the URL of your deck will break existing links to it.",{anchor:this.slugInput,alignment:"r",maxwidth:220})},onSlugBlur:function(){SL.tooltip.hide(),this.slugInput.val(SL.util.string.slug(this.slugInput.val()))}}),SL("views.decks.edit.panels").Share=SL.views.decks.edit.panels.Base.extend({init:function(){this.domElement=$(".sidebar-panel .share"),this.sharer=new SL.components.DeckSharer("light"),this.sharer.appendTo(this.domElement.find(".contents")),this._super()},open:function(){this._super(),this.sharer.render(SLConfig.deck),this.domElement.find(".url input").addClass("xl")}}),SL("views.decks.edit.panels").Style=SL.views.decks.edit.panels.Base.extend({init:function(){this.domElement=$(".sidebar-panel .style"),this._super()},bind:function(){this._super(),this.domElement.find(".edit-style").on("click",this.onAdvancedStylesCLicked.bind(this))},scroll:function(){this.domElement.find(".panel-body").scrollTop(0),$(".page-wrapper").scrollTop(0)},open:function(){this._super(),this.themeoptions?this.themeoptions.populate(SL.models.Theme.fromDeck(SLConfig.deck)):(this.themeoptions=new SL.components.ThemeOptions({themes:SL.current_user.getThemes(),model:SL.models.Theme.fromDeck(SLConfig.deck),container:this.domElement.find(".panel-body")}),this.themeoptions.changed.add(this.layout.bind(this))),this.scroll(),this.layout()},close:function(){this._super()},revert:function(){this._super(),SL.helpers.ThemeController.paint(SL.view.getCurrentTheme(),{center:!1,js:!1})},save:function(){var e=SL.view.getCurrentTheme(),t=this.themeoptions.getTheme(),n=e.get("id")==t.get("id"),i=(e.get("js")||"")==(t.get("js")||"");return n||i?(this._super(),this.saveData(),!0):(this.promptReload(),!1)},saveData:function(){var e=this.themeoptions.getTheme();SLConfig.deck.dirty=!0,SLConfig.deck.theme_id=e.get("id"),SLConfig.deck.theme_font=e.get("font"),SLConfig.deck.theme_color=e.get("color"),SLConfig.deck.center=e.get("center"),SLConfig.deck.rolling_links=e.get("rolling_links"),SLConfig.deck.transition=e.get("transition"),SLConfig.deck.background_transition=e.get("background_transition"),Reveal.configure({center:!1,rolling_links:SLConfig.deck.rolling_links,transition:SLConfig.deck.transition,backgroundTransition:SLConfig.deck.background_transition}),SL.view.invalidateThumbnail(),SL.view.onThemeChanged()},promptReload:function(){SL.prompt({anchor:this.domElement.find(".save"),title:"The editor needs to reload to apply your changes.",alignment:"t",type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Continue</h3>",className:"positive",callback:this.saveAndReload.bind(this)}]})},saveAndReload:function(){this.saveData(),SL.view.save(function(){window.location.reload()}),SL.prompt({anchor:this.domElement.find(".save"),title:'Saving and reloading...<div class="spinner centered-horizontally"></div>',alignment:"t",optional:!1,options:[]}),SL.util.html.generateSpinners()},onAdvancedStylesCLicked:function(){SL.view.changeMode("css")}}),SL("views.decks.edit").Sidebar=Class.extend({init:function(){this.sidebarElement=$(".sidebar"),this.sidebarPrimary=this.sidebarElement.find(".primary"),this.sidebarSecondary=this.sidebarElement.find(".secondary"),this.sidebarHeader=this.sidebarElement.find(".global-header"),this.sidebarScrollShadowTop=this.sidebarElement.find(".scroll-shadow-top"),this.sidebarScrollShadowBottom=this.sidebarElement.find(".scroll-shadow-bottom"),this.panelElement=$(".sidebar-panel"),this.saveButton=this.sidebarElement.find(".button.save"),this.previewButton=this.sidebarElement.find(".button.preview"),this.exportButton=this.sidebarElement.find(".button.export"),this.importButton=this.sidebarElement.find(".button.import"),this.publishButton=this.sidebarElement.find(".button.publish"),this.settingsButton=this.sidebarElement.find(".button.settings"),this.revisionsButton=this.sidebarElement.find(".button.revisions"),this.arrangeButton=this.sidebarElement.find(".button.arrange"),this.styleButton=this.sidebarElement.find(".button.style"),this.shareButton=this.sidebarElement.find(".button.share"),this.autoSaveToggle=this.sidebarElement.find(".sl-toggle.auto-save"),this.autoHideToggle=this.sidebarElement.find(".sl-toggle.auto-hide"),SL.settings.getValue(SL.settings.EDITOR_AUTO_SAVE)&&this.autoSaveToggle.addClass("on"),SL.settings.getValue(SL.settings.EDITOR_AUTO_HIDE)&&(SL.util.skipCSSTransitions(),this.autoHideToggle.addClass("on")),SL.tooltip.anchorTo(this.previewButton,"Preview ("+SL.util.getMetaKeyName()+" + F)",{alignment:"r",delay:500}),this.isAutoHiding=!1,this.currentPanel=null,this.createSignals(),this.render(),this.bind(),this.layout(),this.updatePublishButton(),this.updateAutoHideState()},bind:function(){this.saveButton.on("click",this.onSaveClicked.bind(this)),this.previewButton.on("click",this.onPreviewClicked.bind(this)),this.exportButton.on("click touchstart",this.onExportClicked.bind(this)),this.importButton.on("click touchstart",this.onImportClicked.bind(this)),this.settingsButton.on("click touchstart",this.onSettingsClicked.bind(this)),this.revisionsButton.on("click touchstart",this.onRevisionsClicked.bind(this)),this.publishButton.on("click touchstart",this.onPublishClicked.bind(this)),this.arrangeButton.on("click touchstart",this.onArrangeClicked.bind(this)),this.styleButton.on("click touchstart",this.onStyleClicked.bind(this)),this.shareButton.on("click touchstart",this.onShareClicked.bind(this)),this.autoSaveToggle.on("click",this.onAutoSaveClicked.bind(this)),this.autoHideToggle.on("click",this.onAutoHideClicked.bind(this)),this.panelElement.on("click",this.onPanelElementClicked.bind(this)),this.sidebarSecondary.on("scroll",this.layout.bind(this)),this.settingsPanel.onclose.add(this.close.bind(this)),this.exportPanel.onclose.add(this.close.bind(this)),this.importPanel.onclose.add(this.close.bind(this)),this.revisionsPanel.onclose.add(this.close.bind(this)),this.stylePanel.onclose.add(this.close.bind(this)),this.sharePanel.onclose.add(this.close.bind(this)),$(window).on("mousemove click",this.onMouseImpulse.bind(this)),$(window).on("resize",this.layout.bind(this))},createSignals:function(){this.saveClicked=new signals.Signal,this.previewClicked=new signals.Signal},render:function(){this.revisionsPanel=new SL.views.decks.edit.panels.Revisions,this.settingsPanel=new SL.views.decks.edit.panels.Settings,this.exportPanel=new SL.views.decks.edit.panels.Export,this.importPanel=new SL.views.decks.edit.panels.Import,this.stylePanel=new SL.views.decks.edit.panels.Style,this.sharePanel=new SL.views.decks.edit.panels.Share},layout:function(){var e=window.innerHeight-(this.sidebarPrimary.outerHeight(!0)+this.sidebarHeader.outerHeight(!0));this.sidebarSecondary.css("max-height",e);var t=this.sidebarSecondary.scrollTop(),n=this.sidebarSecondary.prop("scrollHeight"),i=this.sidebarSecondary.outerHeight(),s=n>i,o=t/(n-i);this.sidebarScrollShadowBottom.css({opacity:s?1-o:0,bottom:this.sidebarHeader.outerHeight()}),this.sidebarScrollShadowTop.css({opacity:s?o:0,top:this.sidebarSecondary.offset().top})},open:function(e){switch(this.currentPanel&&this.currentPanel.close(),SL.view.clearMode(),e){case"settings":this.currentPanel=this.settingsPanel;break;case"export":this.currentPanel=this.exportPanel;break;case"import":this.currentPanel=this.importPanel;break;case"style":this.currentPanel=this.stylePanel;break;case"revisions":this.currentPanel=this.revisionsPanel;break;case"share":this.currentPanel=this.sharePanel}this.setActiveButton(e),this.currentPanel.open(),this.panelElement.addClass("visible"),SL.analytics.track("Deck.edit: Open panel",{type:e})},close:function(e){this.currentPanel&&(e===!0&&this.currentPanel.save(),this.currentPanel.close()),this.setActiveButton(null),this.panelElement.removeClass("visible")},toggle:function(e){this.isExpanded(e)?this.close():this.open(e)},setActiveButton:function(e){e?(this.sidebarElement.addClass("has-active-panel"),this.sidebarSecondary.find(".active").removeClass("active"),this.sidebarSecondary.find(".button."+e).addClass("active")):(this.sidebarElement.removeClass("has-active-panel"),this.sidebarSecondary.find(".active").removeClass("active"))},isExpanded:function(e){return e?this.panelElement.find("."+e).hasClass("visible"):this.panelElement.hasClass("visible")},updateSaveButton:function(e){this.saveButton.attr("class","button save "+(e||""))},updatePublishButton:function(){this.publishButton.removeAttr("data-tooltip-alignment"),this.publishButton.removeAttr("data-tooltip-delay"),this.publishButton.removeAttr("data-tooltip");var e=this.publishButton.find(".text"),t=this.publishButton.find(".icon");SLConfig.deck.visibility===SL.models.Deck.VISIBILITY_SELF?(e.text("Private"),t.removeClass("i-unlock-stroke").addClass("i-lock-stroke")):SLConfig.deck.visibility===SL.models.Deck.VISIBILITY_TEAM?(e.text("Internal"),t.removeClass("i-lock-stroke").addClass("i-unlock-stroke")):SLConfig.deck.visibility===SL.models.Deck.VISIBILITY_ALL&&(e.text("Public"),t.removeClass("i-lock-stroke").addClass("i-unlock-stroke")),SLConfig.deck.visibility===SL.models.Deck.VISIBILITY_SELF||SL.util.user.isPro()||(this.publishButton.attr("data-tooltip-alignment","r"),this.publishButton.attr("data-tooltip-delay","800"),this.publishButton.attr("data-tooltip","You need a Pro account to<br>make decks private."),e.text("Make private"))},updateArrangeButton:function(e){this.setActiveButton("arranging"===e?"arrange":null)},updateAutoHideState:function(){this.isAutoHiding=this.isAutoHideOn()||this.isAutoHideForced(),$("html").toggleClass("sidebar-auto-hide",this.isAutoHiding)},isAutoSaveOn:function(){return this.autoSaveToggle.hasClass("on")},isAutoHideOn:function(){return this.autoHideToggle.hasClass("on")},isAutoHideForced:function(){return!1},onSaveClicked:function(e){e.preventDefault(),this.saveClicked.dispatch()},onPreviewClicked:function(e){e.preventDefault(),this.previewClicked.dispatch()},onExportClicked:function(){var e=$(".reveal .slides").children().map(function(){var e=$(this).clone();return e.find("section").add(e).each(function(){var e=$.map(this.attributes,function(e){return e.name}),t=$(this);$.each(e,function(e,n){t.removeAttr(n)})}),e.wrap("<div>").parent().html()}).toArray().join("");return e='<div class="slides">'+e+"</div>",$(".sidebar .export textarea").text(SL.util.html.indent(e)),this.toggle("export"),!1},onImportClicked:function(){return this.toggle("import"),!1},onArrangeClicked:function(){return this.close(),SL.view.getMode("arrange").toggle(),!1},onSettingsClicked:function(){return this.toggle("settings"),!1},onRevisionsClicked:function(){return this.toggle("revisions"),!1},onStyleClicked:function(){return this.toggle("style"),!1},onShareClicked:function(){return this.toggle("share"),!1},onPublishClicked:function(e){if(e.preventDefault(),SL.util.user.isPro()||SLConfig.deck.visibility===SL.models.Deck.VISIBILITY_SELF){var t=[];t.push({html:SL.locale.get("DECK_VISIBILITY_CHANGE_SELF"),selected:SLConfig.deck.visibility===SL.models.Deck.VISIBILITY_SELF,callback:function(){SLConfig.deck.visibility=SL.models.Deck.VISIBILITY_SELF,SL.view.saveVisibility(),this.updatePublishButton(),SL.analytics.track("Deck.edit: Visibility click (SELF)")}.bind(this)}),SL.current_user.isEnterprise()&&t.push({html:SL.locale.get("DECK_VISIBILITY_CHANGE_TEAM"),selected:SLConfig.deck.visibility===SL.models.Deck.VISIBILITY_TEAM,className:"divider",callback:function(){SLConfig.deck.visibility=SL.models.Deck.VISIBILITY_TEAM,SL.view.saveVisibility(),this.updatePublishButton(),SL.analytics.track("Deck.edit: Visibility click (TEAM)")}.bind(this)}),t.push({html:SL.locale.get("DECK_VISIBILITY_CHANGE_ALL"),selected:SLConfig.deck.visibility===SL.models.Deck.VISIBILITY_ALL,callback:function(){SLConfig.deck.visibility=SL.models.Deck.VISIBILITY_ALL,SL.view.saveVisibility(),this.updatePublishButton(),SL.analytics.track("Deck.edit: Visibility click (ALL)")}.bind(this)}),SL.prompt({anchor:this.publishButton,alignment:"r",type:"select",data:t}),SL.analytics.track("Deck.edit: Visibility menu opened ("+SLConfig.deck.visibility+")")}else window.open("/pricing")},onAutoSaveClicked:function(){this.autoSaveToggle.toggleClass("on"),SL.settings.setValue(SL.settings.EDITOR_AUTO_SAVE,this.autoSaveToggle.hasClass("on")),SL.analytics.track("Deck.edit: Auto-save clicked")},onAutoHideClicked:function(){this.autoHideToggle.toggleClass("on"),this.sidebarElement.addClass("visible"),SL.settings.setValue(SL.settings.EDITOR_AUTO_HIDE,this.autoHideToggle.hasClass("on")),this.updateAutoHideState(),SL.analytics.track("Deck.edit: Auto-hide clicked")},onMouseImpulse:function(e){this.isAutoHiding&!this.isExpanded()&&(e.clientX>this.sidebarElement.width()?this.sidebarElement.removeClass("visible"):e.clientX<50&&this.sidebarElement.addClass("visible"))},onPanelElementClicked:function(e){e.target==this.panelElement.get(0)&&this.close()}}),SL("views.decks.edit").SlideOptions=Class.extend({init:function(e){this.editor=e,this.render(),this.bind()},render:function(){this.domElement=$('<div class="slide-options"></div>').appendTo($(".projector")),this.listElement=$("<ul></ul>").appendTo(this.domElement),this.removeSlideElement=$('<li class="remove-slide"><span class="icon i-trash-stroke"></span></li>').appendTo(this.listElement),this.backgroundColorElement=$('<li class="background"><span class="icon i-droplet"></span></li>').appendTo(this.listElement),this.backgroundImageElement=$('<li class="background-image"><span class="icon i-image"></span></li>').appendTo(this.listElement),this.customClassesElement=$('<li class="custom-classes"><span class="icon i-star"></span></li>').appendTo(this.listElement),this.fragmentElement=$('<li class="fragment"><span class="icon i-bolt"></span></li>').appendTo(this.listElement),this.absoluteElement=$('<li class="absolute"><span class="icon i-move"></span></li>').appendTo(this.listElement),this.htmlElement=$('<li class="html"><span class="icon i-file-xml"></span></li>').appendTo(this.listElement),this.notesElement=$('<li class="html"><span class="icon i-book-alt2"></span></li>').appendTo(this.listElement);var e={alignment:"l"};SL.tooltip.anchorTo(this.removeSlideElement,"Remove current slide",e),SL.tooltip.anchorTo(this.backgroundColorElement,"Slide background color",e),SL.tooltip.anchorTo(this.backgroundImageElement,"Slide background image",e),SL.tooltip.anchorTo(this.customClassesElement,"Slide classes",e),SL.tooltip.anchorTo(this.fragmentElement,"Create fragments<br>(SHIFT + ALT + F)",e),SL.tooltip.anchorTo(this.absoluteElement,"Position elements freely<br>(SHIFT + ALT + P)",e),SL.tooltip.anchorTo(this.htmlElement,"Edit HTML<br>(SHIFT + ALT + H)",e),SL.tooltip.anchorTo(this.notesElement,"Speaker notes<br>(SHIFT + ALT + N)",e),this.renderBackgroundColorMenu(),this.renderBackgroundImageMenu(),this.syncCustomClasses()},renderBackgroundColorMenu:function(){var e=[{value:"none"},{value:"rgba( 200, 50, 30, 0.6 )",display:"rgba( 200, 50, 30, 1 )"},{value:"rgba( 50, 200, 90, 0.4 )",display:"rgba( 50, 200, 90, 1 )"},{value:"rgba( 0, 0, 0, 0.6 )",display:"rgba( 0, 0, 0, 1 )"},{value:"rgba( 255, 255, 255, 0.6 )",display:"rgba( 255, 255, 255, 1 )"},{value:"rgba( 22, 152, 213, 0.6 )",display:"rgba( 22, 152, 213, 1 )"},{value:"rgba( 22, 213, 75, 0.6 )",display:"rgba( 22, 213, 75, 1 )"},{value:"rgba( 12, 25, 77, 0.6)",display:"rgba( 12, 25, 77,16)"},{value:"rgba( 180, 50, 140, 0.6 )",display:"rgba( 180, 50, 140, 1 )"},{value:"rgba( 255, 122, 0, 0.6 )",display:"rgba( 255, 122, 0, 1 )"}];this.backgroundColorMenu=$('<div class="background-color-menu">').appendTo(this.domElement);var t=$("<ul></ul>").appendTo(this.backgroundColorMenu);e.forEach(function(e){t.append("none"===e.value?'<li data-value="none"><span class="icon i-denied"></span></li>':'<li data-value="'+e.value+'" style="background: '+e.display+';"></li>')})},renderBackgroundImageMenu:function(){this.backgroundImageMenu=$('<div class="background-image-menu">').appendTo(this.domElement),this.backgroundImageInner=$('<div class="inner"></div>').appendTo(this.backgroundImageMenu);var e=$('<div class="upload-input"></div>').appendTo(this.backgroundImageInner);e.append('<span class="icon i-cloud-upload"></span>'),e.append('<span class="label">Upload image</span>');var t=$('<div class="upload-progress"></div>').appendTo(this.backgroundImageInner);t.append('<span class="spinner centered"></span>'),t.append('<span class="label">Uploading...</span>'),SL.util.html.generateSpinners();var n=$('<div class="upload-output"></div>').appendTo(this.backgroundImageInner);n.append('<div class="thumbnail"></div>');var i=$('<div class="background-image-options"></div>').appendTo(n);i.append(['<select class="sl-select white background-size">','<option value="cover" selected>Stretch</option>','<option value="contain">Fit</option>','<option value="initial">Original</option>',"</select>"].join("")),i.append('<button class="button remove-background">Remove</button>'),this.renderBackgroundImageMenuInput()},renderBackgroundImageMenuInput:function(){this.backgroundImageMenu.find(".upload-input .file-input").remove(),this.backgroundImageMenu.find(".upload-input").append('<input class="file-input" type="file">'),this.backgroundImageFileInput=this.backgroundImageMenu.find(".file-input"),this.backgroundImageFileInput.on("change",this.onBackgroundImageFileInputChanged.bind(this))},bind:function(){this.onDocumentMouseDown=this.onDocumentMouseDown.bind(this),this.removeSlideElement.on("mousedown",this.onRemoveSlideClicked.bind(this)),this.backgroundColorElement.on("mousedown",this.onBackgroundColorClicked.bind(this)),this.backgroundImageElement.on("mousedown",this.onBackgroundImageClicked.bind(this)),this.customClassesElement.on("mousedown",this.onCustomClassesClicked.bind(this)),this.fragmentElement.on("mousedown",this.onFragmentClicked.bind(this)),this.absoluteElement.on("mousedown",this.onAbsoluteClicked.bind(this)),this.htmlElement.on("mousedown",this.onHTMLClicked.bind(this)),this.notesElement.on("mousedown",this.onNotesClicked.bind(this)),this.backgroundImageMenu.find(".background-transition").on("change",this.onBackgroundImageTransitionChanged.bind(this)),this.backgroundImageMenu.find(".background-size").on("change",this.onBackgroundImageSizeChanged.bind(this)),this.backgroundImageMenu.find(".remove-background").on("click",this.onBackgroundImageRemoveClicked.bind(this)),this.backgroundColorMenu.find("li").on("mousedown",this.onBackgroundColorItemClicked.bind(this)),$(document).on("mousedown touchstart",this.onDocumentMouseDown)},collapse:function(){this.hideOpenPanels()},hideOpenPanels:function(){this.backgroundColorMenu.removeClass("show"),this.backgroundImageMenu.removeClass("show")},hasOpenPanel:function(){return this.backgroundColorMenu.hasClass("show")||this.backgroundImageMenu.hasClass("show")
},syncRemoveSlide:function(){this.removeSlideElement.toggleClass("disabled",$(".reveal .slides section").length<2)},syncCustomClasses:function(){var e=this.editor.getCurrentTheme();if(e){var t=SL.util.string.getCustomClassesFromLESS(e.get("less"));this.customClassesElement.toggleClass("disabled",0===t.length)}},syncBackgroundImageMenu:function(){var e=$(Reveal.getCurrentSlide()),t=e.attr("data-background-image"),n=e.attr("data-background-size"),i=e.attr("data-background-transition"),s=this.backgroundImageMenu.find(".upload-output .thumbnail"),o=this.backgroundImageMenu.find(".upload-output .background-size"),a=this.backgroundImageMenu.find(".upload-output .background-transition");"string"==typeof t&&t.length?(s.css({"background-image":'url("'+t+'")',"background-repeat":"no-repeat","background-size":"cover"}),o.val(n),a.val(i),this.backgroundImageMenu.attr("data-state","uploaded")):this.fileUploader?(s.css("background-image","none"),this.backgroundImageMenu.attr("data-state","uploading")):(s.css("background-image","none"),this.backgroundImageMenu.attr("data-state",""))},triggerBackgroundImage:function(){$(Reveal.getCurrentSlide).focus(),this.backgroundImageMenu.addClass("show")},triggerNotes:function(){if(!this.notesPrompt){SL.util.deck.generateIdentifiers();var e=$(Reveal.getCurrentSlide()).attr("data-id"),t=200;this.notesPrompt=SL.prompt({anchor:this.notesElement,alignment:"l",title:"Speaker Notes",type:"input",data:{value:SLConfig.deck.notes[e],placeholder:"Plain text, max "+t+" characters...",multiline:!0,maxlength:t}}),this.notesPrompt.confirmed.add(function(t){SLConfig.deck.notes[e]=t,SLConfig.deck.dirty=!0}),this.notesPrompt.destroyed.add(function(){this.notesPrompt=null}.bind(this))}},triggerHTML:function(){SL.modal.open("edit-html")},triggerCustomClasses:function(){if(!this.customClassesPrompt){var e=this.editor.getCurrentTheme();if(e){var t=SL.util.string.getCustomClassesFromLESS(e.get("less"));if(t.length){var n=$(Reveal.getCurrentSlide()),i=t.map(function(e){return{value:e,selected:n.hasClass(e),callback:function(e){n.toggleClass(e),Reveal.sync()}}});this.customClassesPrompt=SL.prompt({anchor:this.customClassesElement,alignment:"l",title:"Slide classes",type:"list",data:i,multiselect:!0,optional:!0}),this.customClassesPrompt.destroyed.add(function(){this.customClassesPrompt=null}.bind(this))}}}},onRemoveSlideClicked:function(e){SL.prompt({anchor:$(e.currentTarget),title:SL.locale.get("DECK_DELETE_SLIDE_CONFIRM"),alignment:"l",type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Remove</h3>",selected:!0,className:"negative",callback:function(){this.editor.removeCurrentSlide()}.bind(this)}]})},onFragmentClicked:function(e){e.preventDefault(),this.editor.changeMode("fragment")},onAbsoluteClicked:function(e){e.preventDefault(),this.editor.changeMode("absolute")},onBackgroundColorClicked:function(e){e.preventDefault(),this.backgroundImageMenu.removeClass("show"),this.backgroundColorMenu.toggleClass("show"),this.backgroundColorMenu.css("top",this.backgroundColorElement.position().top),SL.analytics.track("Deck.edit: Show background color menu")},onBackgroundColorItemClicked:function(e){e.preventDefault();var t=$(e.currentTarget).attr("data-value");t&&("none"===t?(Reveal.getCurrentSlide().removeAttribute("data-background-color"),this.backgroundColorMenu.removeClass("show")):Reveal.getCurrentSlide().setAttribute("data-background-color",t),Reveal.sync())},onBackgroundImageClicked:function(e){e.preventDefault(),this.syncBackgroundImageMenu(),this.backgroundColorMenu.removeClass("show"),this.backgroundImageMenu.toggleClass("show").addClass("immediate"),this.backgroundImageMenu.css("top",this.backgroundImageElement.position().top),setTimeout(function(){this.backgroundImageMenu.removeClass("immediate")}.bind(this),1),SL.analytics.track("Deck.edit: Show background image menu")},onBackgroundImageRemoveClicked:function(e){Reveal.getCurrentSlide().removeAttribute("data-background-image"),Reveal.getCurrentSlide().removeAttribute("data-background-transition"),Reveal.sync(),this.syncBackgroundImageMenu(),SL.analytics.track("Deck.edit: Remove background image"),e.preventDefault()},onBackgroundImageTransitionChanged:function(){var e=this.backgroundImageMenu.find(".background-transition");Reveal.getCurrentSlide().setAttribute("data-background-transition",e.val()),Reveal.sync(),this.syncBackgroundImageMenu()},onBackgroundImageSizeChanged:function(){var e=this.backgroundImageMenu.find(".background-size");Reveal.getCurrentSlide().setAttribute("data-background-size",e.val()),Reveal.sync(),this.syncBackgroundImageMenu()},onBackgroundImageFileInputChanged:function(e){var t=Reveal.getCurrentSlide(),n=Reveal.getIndices(t),i=this.backgroundImageFileInput.get(0).files[0];return this.triggerBackgroundImage(),i&&i.type.match(/image.*/)?"number"==typeof i.size&&i.size/1024>SL.config.MAX_IMAGE_UPLOAD_SIZE?void SL.notify("No more than "+Math.round(SL.config.MAX_IMAGE_UPLOAD_SIZE/1024)+"mb please","negative"):(this.fileUploader=new SL.helpers.FileUploader({file:i,service:SL.config.AJAX_IMAGE_UPLOAD,timeout:6e4}),this.syncBackgroundImageMenu(),this.fileUploader.succeeded.add(function(e){this.fileUploader.destroy(),this.fileUploader=null,e&&"string"==typeof e.url?(t.setAttribute("data-background-image",e.url),Reveal.sync()):SL.notify("An error occurred while uploading your image.","negative"),this.syncBackgroundImageMenu(),n&&0===n.h&&0===n.v&&this.editor.invalidateThumbnail(),this.renderBackgroundImageMenuInput()}.bind(this)),this.fileUploader.failed.add(function(){this.fileUploader.destroy(),this.fileUploader=null,SL.notify("An error occurred while uploading your image.","negative"),this.syncBackgroundImageMenu(),this.renderBackgroundImageMenuInput()}.bind(this)),this.fileUploader.upload(),void e.preventDefault()):void SL.notify("Only image files, please")},onHTMLClicked:function(e){e.preventDefault(),this.triggerHTML()},onNotesClicked:function(e){e.preventDefault(),this.triggerNotes()},onCustomClassesClicked:function(e){e.preventDefault(),this.triggerCustomClasses()},onDocumentMouseDown:function(e){var t=$(e.target);0===t.parents(".slide-options").length&&this.collapse()}}),SL("views.decks.edit").SnippetsButton={create:function(){skriv.actions.snippets=skriv.actions.dropdown.extend({init:function(e,t){t.openOnHover=!0,t.leaveHeader=!0,this.options=[],this._super(e,t)},build:function(){this._super(),this.domElement.style.width="80px",this.panelElement.style.width="auto",this.panelElement.style.maxWidth="300px",this.buttonElement.textContent="Snippets"},trigger:function(){var e=parseInt(this.getValue(),10),t=this.options[e].model;if(t){var n=$(Reveal.getCurrentSlide());if(t.templateHasVariables())SL.modal.open("insert-snippet",{snippet:t,callback:function(e){n.append(e)}.bind(this)});else{var i=t.get("template"),s=i.split(SL.models.ThemeSnippet.TEMPLATE_SELECTION_TAG),o=SL.util.selection.getSelectedHTML().trim();t.templateHasSelection()&&o.length>0?(document.execCommand("insertHTML",!1,'<span class="editing-ui snippet-selection-placeholder"></span>'),n.find(".snippet-selection-placeholder").replaceWith(s[0]+o+s[1]),setTimeout(function(){$(".reveal section").find(".snippet-selection-placeholder")},1)):$(SL.view.getFocusedSlide()).length?document.execCommand("insertHTML",!1,s.join("")):n.append(s.join(""))}}}})},sync:function(e){var t=e.getCurrentTheme();if(t){var n=t.get("snippets");if(n){var i=n.map(function(e,t){return{value:t,name:e.get("title"),model:e}});if(i&&i.length)return $(".skriv .snippets-button, .skriv .snippets-divider").show(),e.toolbar.getAction("snippets").populate(i),!0}}return $(".skriv .snippets-button, .skriv .snippets-divider").hide(),!1}},SL("views.decks.edit").UndoButton={create:function(){skriv.actions.undo=skriv.actions.dropdown.extend({init:function(e,t){this.isOver=!1,this.options=[{name:"Redo",value:"redo"}],this._super(e,t),SL.views.decks.edit.HistoryController.changed.add(this.sync.bind(this)),this.sync()},build:function(){this._super(),this.buttonElement.classList.add("undo"),this.buttonElement.classList.add("icon"),this.domElement.style.width="40px",this.panelElement.style.width="50px"},addOption:function(e){this.redoButton=document.createElement("li"),this.redoButton.setAttribute("data-value",e.value),this.bindOption(this.redoButton,e);var t=document.createElement("div");t.className="redo icon "+e.value,this.redoButton.appendChild(t),this.dropdownElement.appendChild(this.redoButton)},bindOption:function(e,t){e.addEventListener("click",function(){SL.views.decks.edit.HistoryController.redo({ignoreMode:!0})}.bind(this,t.value),!1)},sync:function(){SL.views.decks.edit.HistoryController.canUndo()?this.buttonElement.classList.remove("disabled"):this.buttonElement.classList.add("disabled"),SL.views.decks.edit.HistoryController.canRedo()?this.isOver&&this.open():this.close()},trigger:function(){},toggle:function(){},onClick:function(e){this._super(e),SL.views.decks.edit.HistoryController.undo({ignoreMode:!0})},onMouseOver:function(){this.isOver=!0,SL.views.decks.edit.HistoryController.canRedo()&&this.open()},onMouseOut:function(){this.isOver=!1,this.close()}})}},SL("views.decks").Embed=SL.views.Base.extend({init:function(){this._super(),this.footerElement=$(".embed-footer"),this.revealElement=$(".reveal"),SL.util.setupReveal({embedded:!0,openLinksInTabs:!0}),$(window).on("resize",this.layout.bind(this)),$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",this.layout.bind(this)),this.footerElement.find(".fullscreen").on("click",this.onFullScreenClicked.bind(this));var e=SL.util.getQuery().style;"hidden"!==e||SL.current_deck.isPro()||(e=null),e&&$("html").attr("data-embed-style",e),Modernizr.fullscreen===!1&&this.footerElement.find(".fullscreen").hide(),this.layout()},layout:function(){this.revealElement.height(this.footerElement.is(":visible")?window.innerHeight-$(".embed-footer").height():"100%"),Reveal.layout()},onFullScreenClicked:function(){var e=$("html").get(0);return e?(SL.helpers.Fullscreen.enter(e),!1):void 0}}),SL("views.decks").Fullscreen=SL.views.Base.extend({init:function(){this._super(),SL.util.setupReveal({history:!navigator.userAgent.match(/(iphone|ipod|ipad|android)/gi),openLinksInTabs:!0})}}),SL("views.decks").LiveClient=SL.views.Base.extend({init:function(){this._super(),SL.util.setupReveal({touch:!1,history:!1,keyboard:!1,controls:!1,progress:!1,openLinksInTabs:!0,autoSlide:0}),this.stream=new SL.helpers.Stream,this.stream.ready.add(this.onStreamReady.bind(this)),this.stream.statusChanged.add(this.onStreamStatusChanged.bind(this)),this.render(),this.bind(),this.stream.connect()},render:function(){var e=SL.current_deck.get("user"),t=SL.routes.DECK(e.username,SL.current_deck.get("slug")),n=e.thumbnail_url;this.summaryBubble=$(['<a class="summary-bubble" href="'+t+'" target="_blank">','<div class="summary-bubble-picture" style="background-image: url('+n+')"></div>','<div class="summary-bubble-content"></div>',"</a>"].join("")).appendTo(document.body),this.summaryBubbleContent=this.summaryBubble.find(".summary-bubble-content"),this.renderUserSummary()},renderUserSummary:function(){var e=SL.current_deck.get("user");this.summaryBubbleContent.html(["<h4>"+SL.current_deck.get("title")+"</h4>","<p>By "+(e.name||e.username)+"</p>"].join(""))},renderWaitingSummary:function(){this.summaryBubbleContent.html(["<h4>Waiting for presenter</h4>",'<p class="retry-status"></p>'].join("")),this.summaryBubbleRetryStatus=this.summaryBubbleContent.find(".retry-status")},renderConnectionLostSummary:function(){this.summaryBubbleContent.html(["<h4>Connection lost</h4>","<p>Attempting to reconnect</p>"].join(""))},startUpdatingTimer:function(){var e=function(){if(this.summaryBubbleRetryStatus&&this.summaryBubbleRetryStatus.length){var e=Date.now()-this.stream.getRetryStartTime(),t=Math.ceil((SL.helpers.Stream.CONNECTION_RETRY_INTERVAL-e)/1e3);this.summaryBubbleRetryStatus.text(isNaN(t)?"Retrying":t>0?"Retrying in "+t+"s":"Retrying now")}}.bind(this);clearInterval(this.updateTimerInterval),this.updateTimerInterval=setInterval(e,100),e()},stopUpdatingTimer:function(){clearInterval(this.updateTimerInterval)},bind:function(){this.summaryBubble.on("mouseover",this.expandSummary.bind(this)),this.summaryBubble.on("mouseout",this.collapseSummary.bind(this))},expandSummary:function(e){clearTimeout(this.collapseSummaryTimeout);var t=window.innerWidth-(this.summaryBubbleContent.find("h4, p").offset().left+40);t=Math.min(t,400),this.summaryBubbleContent.find("h4, p").css("max-width",t),this.summaryBubble.width(this.summaryBubble.height()+this.summaryBubbleContent.outerWidth()),"number"==typeof e&&(this.collapseSummaryTimeout=setTimeout(this.collapseSummary.bind(this),e))},expandSummaryError:function(){this.summaryBubbleError=!0,this.expandSummary()},collapseSummary:function(){this.summaryBubbleError||(clearTimeout(this.collapseSummaryTimeout),this.summaryBubble.width(this.summaryBubble.height()))},onStreamReady:function(){this.expandSummary(5e3)},onStreamStatusChanged:function(e){e===SL.helpers.Stream.STATUS_WAITING_FOR_PUBLISHER?(this.renderWaitingSummary(),this.expandSummaryError(),this.startUpdatingTimer()):e===SL.helpers.Stream.STATUS_CONNECTION_LOST?(this.renderConnectionLostSummary(),this.expandSummaryError(),this.stopUpdatingTimer()):(this.summaryBubbleError=!1,this.renderUserSummary(),this.stopUpdatingTimer())}}),SL("views.decks").LiveServer=SL.views.Base.extend({init:function(){this._super(),SL.util.setupReveal({history:!0,openLinksInTabs:!0,autoSlide:0}),this.stream=new SL.helpers.Stream({publisher:!0}),this.stream.connect(),this.render()},render:function(){var e=SL.current_deck.getTokenedAbsoluteURL("live"),t=SL.current_deck.getTokenedAbsoluteURL("speaker"),n="http://help.slides.com/knowledgebase/articles/333924",i="http://help.slides.com/knowledgebase/articles/333923";this.presentationControls=$(['<aside class="presentation-controls">','<div class="presentation-controls-content">',"<h2>Presentation Controls</h2>",'<div class="presentation-controls-section">',"<h2>Speaker View</h2>",'<p>The control panel for your presentation. Includes speaker notes, an upcoming slide preview and more. It can be used as a remote control when opened from a mobile device. <a href="'+i+'" target="_blank">Learn more.</a></p>','<a class="button l outline" href="'+t+'" target="_blank">Open speaker view</a>',"</div>",'<div class="presentation-controls-section">',"<h2>Present Live</h2>",'<p>Share this link with your audience to have them follow along with the presentation in real-time. <a href="'+n+'" target="_blank">Learn more.</a></p>','<input class="live-view-url input-field" type="text" value="'+e+'" readonly />',"</div>",'<div class="presentation-controls-section sl-form">',"<h2>Options</h2>",'<div class="sl-checkbox outline fullscreen-toggle">','<input id="fullscreen-checkbox" type="checkbox">','<label for="fullscreen-checkbox">Fullscreen</label>',"</div>",'<div class="sl-checkbox outline controls-toggle">','<input id="controls-checkbox" type="checkbox">','<label for="controls-checkbox">Hide controls</label>',"</div>",'<div class="sl-checkbox outline progress-toggle">','<input id="progress-checkbox" type="checkbox">','<label for="progress-checkbox">Hide progress bar</label>',"</div>","</div>","</div>",'<footer class="presentation-controls-footer">','<button class="button xl positive start-presentation">Start presentation</button>',"</footer>","</aside>"].join("")).appendTo(document.body),this.presentationControlsScrollShadow=new SL.components.ScrollShadow({parentElement:this.presentationControls,contentElement:this.presentationControls.find(".presentation-controls-content"),footerElement:this.presentationControls.find(".presentation-controls-footer")}),this.presentationControls.find(".live-view-url").on("mousedown",this.onLiveURLMouseDown.bind(this)),this.presentationControls.find(".fullscreen-toggle").on("click",this.onFullscreenToggled.bind(this)),this.presentationControls.find(".controls-toggle").on("click",this.onControlsToggled.bind(this)),this.presentationControls.find(".progress-toggle").on("click",this.onProgressToggled.bind(this)),this.presentationControls.find(".button.start-presentation").on("click",this.onStartPresentationClicked.bind(this)),$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",this.onFullscreenChange.bind(this)),this.syncPresentationControls()},syncPresentationControls:function(){this.presentationControls.find(".fullscreen-toggle input").prop("checked",SL.helpers.Fullscreen.isActive()),this.presentationControls.find(".controls-toggle input").prop("checked",!Reveal.getConfig().controls),this.presentationControls.find(".progress-toggle input").prop("checked",!Reveal.getConfig().progress)},showStatus:function(e){this.statusElement?this.statusElement.find(".stream-status-message").html(e):this.statusElement=$(['<div class="stream-status">','<p class="stream-status-message">'+e+"</p>","</div>"].join("")).appendTo(document.body)},clearStatus:function(){this.statusElement&&(this.statusElement.remove(),this.statusElement=null)},onLiveURLMouseDown:function(e){$(e.target).focus().select(),e.preventDefault()},onControlsToggled:function(e){e.preventDefault(),Reveal.configure({controls:!Reveal.getConfig().controls}),this.syncPresentationControls()},onProgressToggled:function(e){e.preventDefault(),Reveal.configure({progress:!Reveal.getConfig().progress}),this.syncPresentationControls()},onFullscreenToggled:function(e){e.preventDefault(),SL.helpers.Fullscreen.toggle()},onFullscreenChange:function(){this.syncPresentationControls(),Reveal.layout()},onStartPresentationClicked:function(){$("html").addClass("presentation-started")}}),SL("views.decks").Show=SL.views.Base.extend({init:function(){this._super(),this.summaryBubble=$(".summary-bubble"),SL.util.setupReveal({history:!0,embedded:!0,openLinksInTabs:!0,margin:.1}),this.setupDisqus(),this.showSummaryTimeout=setTimeout(this.showSummary.bind(this),1e3),this.hideSummaryTimeout=setTimeout(this.hideSummary.bind(this),8e3),$("header .deck-promotion").length&&$("header").addClass("extra-wide"),Modernizr.fullscreen===!1&&$(".deck-options .fullscreen-button").hide(),this.bind(),this.layout()},bind:function(){this.editButton=$(".deck-options .edit-button"),this.editButtonOriginalLink=this.editButton.attr("href"),$(".deck-options .fork-button").on("click",this.onForkClicked.bind(this)),$(".deck-options .share-button").on("click",this.onShareClicked.bind(this)),$(".deck-options .comment-button").on("click",this.onCommentsClicked.bind(this)),$(".deck-options .fullscreen-button").on("click",this.onFullScreenClicked.bind(this)),this.visibilityButton=$(".deck-options .visibility-button"),this.visibilityButton.on("click",this.onVisibilityClicked.bind(this)),$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",Reveal.layout),this.onWindowScroll=$.debounce(this.onWindowScroll,200),$(window).on("resize",this.layout.bind(this)),$(window).on("scroll",this.onWindowScroll.bind(this)),this.hideSummary=this.hideSummary.bind(this),Reveal.addEventListener("slidechanged",this.onSlideChanged.bind(this)),Reveal.addEventListener("fragmentshown",this.hideSummary),Reveal.addEventListener("fragmenthidden",this.hideSummary),this.summaryBubble.on("click",this.hideSummary)},setupDisqus:function(){if($("#disqus_thread").length){{var e=window.disqus_shortname="slidesapp";window.disqus_identifier=SLConfig.deck.id}!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="//"+e+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(t)}()}else $(".options .comment-button").hide()},showSummary:function(){this.summaryBubble&&this.summaryBubble.addClass("visible")},hideSummary:function(){this.summaryBubble&&(this.summaryBubble.removeClass("visible"),this.summaryBubble.on("transitionend",function(){$(this).remove()}),this.summaryBubble=null)},layout:function(){this.summaryBubble&&this.summaryBubble.css("left",(window.innerWidth-this.summaryBubble.width())/2);var e=$(".reveal .playback"),t=$(".deck-kudos"),n={opacity:1};t.length&&e.length&&(n.marginLeft=e.offset().left+e.outerWidth()-10),t.css(n)},saveVisibility:function(e){var t={type:"POST",url:SL.config.AJAX_PUBLISH_DECK(SL.current_deck.get("id")),context:this,data:{visibility:e}};$.ajax(t).done(function(e){e.deck.visibility===SL.models.Deck.VISIBILITY_SELF?SL.notify(SL.locale.get("DECK_VISIBILITY_CHANGED_SELF")):e.deck.visibility===SL.models.Deck.VISIBILITY_TEAM?SL.notify(SL.locale.get("DECK_VISIBILITY_CHANGED_TEAM")):e.deck.visibility===SL.models.Deck.VISIBILITY_ALL&&SL.notify(SL.locale.get("DECK_VISIBILITY_CHANGED_ALL")),"string"==typeof e.deck.slug&&SL.current_deck.set("slug",e.deck.slug),"string"==typeof e.deck.visibility&&SL.current_deck.set("visibility",e.deck.visibility)}).fail(function(){SL.notify(SL.locale.get("DECK_VISIBILITY_CHANGED_ERROR"),"negative")})},onShareClicked:function(){return"undefined"!=typeof SLConfig&&"string"==typeof SLConfig.deck.user.username&&"string"==typeof SLConfig.deck.slug?SL.modal.open("share-deck",SLConfig.deck):SL.notify(SL.locale.get("GENERIC_ERROR"),"negative"),SL.analytics.track("Deck.show: Share clicked"),!1},onCommentsClicked:function(){SL.analytics.track("Deck.show: Comments clicked")},onFullScreenClicked:function(){var e=$(".reveal-viewport").get(0);return e?(SL.helpers.Fullscreen.enter(e),!1):void SL.analytics.track("Deck.show: Fullscreen clicked")},onForkClicked:function(){return SL.analytics.track("Deck.show: Fork clicked"),$.ajax({type:"POST",url:SL.config.AJAX_FORK_DECK(SLConfig.deck.id),context:this}).done(function(){window.location=SL.current_user.getProfileURL()}).fail(function(){SL.notify(SL.locale.get("GENERIC_ERROR"),"negative")}),!1},onVisibilityClicked:function(e){e.preventDefault();var t=SL.current_deck.get("visibility"),n=[];n.push({html:SL.locale.get("DECK_VISIBILITY_CHANGE_SELF"),selected:t===SL.models.Deck.VISIBILITY_SELF,callback:function(){this.saveVisibility(SL.models.Deck.VISIBILITY_SELF),SL.analytics.track("Deck.show: Visibility click (SELF)")}.bind(this)}),SL.current_user.isEnterprise()&&n.push({html:SL.locale.get("DECK_VISIBILITY_CHANGE_TEAM"),selected:t===SL.models.Deck.VISIBILITY_TEAM,className:"divider",callback:function(){this.saveVisibility(SL.models.Deck.VISIBILITY_TEAM),SL.analytics.track("Deck.show: Visibility click (TEAM)")}.bind(this)}),n.push({html:SL.locale.get("DECK_VISIBILITY_CHANGE_ALL"),selected:t===SL.models.Deck.VISIBILITY_ALL,callback:function(){this.saveVisibility(SL.models.Deck.VISIBILITY_ALL),SL.analytics.track("Deck.show: Visibility click (ALL)")}.bind(this)}),SL.prompt({anchor:$(e.currentTarget),type:"select",data:n}),SL.analytics.track("Deck.show: Visibility menu opened ("+SL.current_deck.get("visibility")+")")},onSlideChanged:function(e){this.hideSummary();var t="#";e.indexh&&(t+="/"+e.indexh,e.indexv&&(t+="/"+e.indexv)),this.editButton.attr("href",this.editButtonOriginalLink+t)},onWindowScroll:function(){$(window).scrollTop()>10&&this.hideSummary()}}),SL("views.decks").Speaker=SL.views.Base.extend({init:function(){this._super(),this.notesElement=$(".speaker-controls .notes"),this.notesValue=$(".speaker-controls .notes .value"),this.timeElement=$(".speaker-controls .time"),this.timeTimerValue=$(".speaker-controls .time .timer-value"),this.timeClockValue=$(".speaker-controls .time .clock-value"),this.subscribersElement=$(".speaker-controls .subscribers"),this.subscribersValue=$(".speaker-controls .subscribers .subscribers-value"),this.currentElement=$(".current-slide"),this.upcomingElement=$(".upcoming-slide"),this.upcomingFrame=$(".upcoming-slide iframe"),this.upcomingFrame.length?this.upcomingFrame.on("load",this.onUpcomingFrameLoaded.bind(this)):this.setup(),SL.helpers.PageLoader.show()},setup:function(){Reveal.addEventListener("ready",function(){this.currentReveal=window.Reveal,this.currentReveal.addEventListener("slidechanged",this.onCurrentSlideChanged.bind(this)),this.currentReveal.addEventListener("fragmentshown",this.onCurrentFragmentChanged.bind(this)),this.currentReveal.addEventListener("fragmenthidden",this.onCurrentFragmentChanged.bind(this)),this.upcomingFrame.length&&(this.upcomingReveal=this.upcomingFrame.get(0).contentWindow.Reveal,this.upcomingReveal.configure({history:!1,controls:!1,progress:!1,overview:!1,autoSlide:0,transition:"none",backgroundTransition:"none"}),this.upcomingReveal.addEventListener("slidechanged",this.onUpcomingSlideChanged.bind(this)),this.upcomingFrame.get(0).contentWindow.document.body.className+=" no-transition"),this.stream=new SL.helpers.Stream({reveal:this.currentReveal,publisher:!0}),this.stream.ready.add(this.onStreamReady.bind(this)),this.stream.subscribersChanged.add(this.onStreamSubscribersChange.bind(this)),this.stream.connect(),this.setupTimer(),this.setupTouch()}.bind(this)),SL.util.setupReveal({touch:!1,history:!1,autoSlide:0,openLinksInTabs:!0})},setupTouch:function(){if($("html").hasClass("speaker-mobile")&&SL.util.device.HAS_TOUCH){this.touchControls=$(['<div class="touch-controls">','<div class="touch-controls-content">','<span class="status">',"Swipe to change slide","</span>",'<span class="slide-number"></span>',"</div>",'<div class="touch-controls-progress"></div>',"</div>"].join("")).appendTo(document.body),this.touchControlsProgress=this.touchControls.find(".touch-controls-progress"),this.touchControlsSlideNumber=this.touchControls.find(".slide-number"),this.touchControlsStatus=this.touchControls.find(".status"),setTimeout(function(){this.touchControls.addClass("visible")}.bind(this),1e3);var e=Hammer(document.body),t=!1;e.on("swipe drag",function(e){if(e.gesture.preventDefault(),!t)switch(e.gesture.direction){case Hammer.DIRECTION_LEFT:this.currentReveal.right(),this.showTouchStatus("Slide right"),t=!0;break;case Hammer.DIRECTION_RIGHT:this.currentReveal.left(),this.showTouchStatus("Slide left"),t=!0;break;case Hammer.DIRECTION_UP:this.currentReveal.down(),this.showTouchStatus("Slide down"),t=!0;break;case Hammer.DIRECTION_DOWN:this.currentReveal.up(),this.showTouchStatus("Slide up"),t=!0}}.bind(this)),e.on("tap",function(){this.currentReveal.next(),this.showTouchStatus("Next slide")}.bind(this)),e.on("hold",function(){this.currentReveal.togglePause(),this.showTouchStatus(this.currentReveal.isPaused()?"Paused":"Resumed"),t=!0}.bind(this)),e.on("release",function(){t=!1}.bind(this))}},setupTimer:function(){this.timeTimerValue.on("click",this.restartTimer.bind(this)),this.restartTimer(),setInterval(this.syncTimer.bind(this),1e3)},restartTimer:function(){this.startTime=Date.now(),this.syncTimer()},sync:function(){setTimeout(function(){this.syncUpcomingSlide(),this.syncTouchControls(),this.syncNotes(),this.syncTimer()}.bind(this),1)},syncTimer:function(){var e=moment();this.timeClockValue.html(e.format("hh:mm")+' <span class="dim">'+e.format("A")+"<span>"),e.hour(0).minute(0).second((Date.now()-this.startTime)/1e3);var t=e.format("HH")+":",n=e.format("mm")+":",i=e.format("ss");"00:"===t&&(t='<span class="dim">'+t+"</span>","00:"===n&&(n='<span class="dim">'+n+"</span>")),this.timeTimerValue.html(t+n+i)},syncUpcomingSlide:function(){if(this.upcomingReveal){var e=this.currentReveal.getIndices();this.upcomingReveal.slide(e.h,e.v,e.f),this.upcomingReveal.next()}},syncNotes:function(){var e=$(this.currentReveal.getCurrentSlide()).attr("data-notes")||"";e?(this.notesElement.show(),this.notesValue.text($(this.currentReveal.getCurrentSlide()).attr("data-notes")||"")):this.notesElement.hide()},syncTouchControls:function(){if(this.touchControls){var e=this.currentReveal.getProgress();this.touchControlsProgress.css({"-webkit-transform":"scale("+e+", 1)","-moz-transform":"scale("+e+", 1)","-ms-transform":"scale("+e+", 1)",transform:"scale("+e+", 1)"});var t=$(".reveal .slides section:not(.stack)").length,n=this.currentReveal.getIndices().h+this.currentReveal.getIndices().v;n+=$(".reveal .slides>section.present").prevAll("section").find(">section:gt(0)").length,n+=1,this.touchControlsSlideNumber.html(n+"/"+t)}},showTouchStatus:function(e){clearTimeout(this.touchControlsStatusTimeout),this.currentReveal&&this.currentReveal.isPaused()&&(e="Paused (tap+hold to resume)"),this.touchControlsStatus&&(this.touchControlsStatus.text(e).removeClass("hidden"),this.touchControlsStatusTimeout=setTimeout(function(){this.touchControlsStatus.addClass("hidden")}.bind(this),1e3))},onUpcomingFrameLoaded:function(){this.setup()},onStreamReady:function(){SL.helpers.PageLoader.hide(),this.sync()},onStreamSubscribersChange:function(e){"number"==typeof this.subscriberCount&&(this.subscribersValue.removeClass("flash green flash-red"),e>this.subscriberCount?setTimeout(function(){this.subscribersValue.addClass("flash-green")}.bind(this),1):e<this.subscriberCount&&setTimeout(function(){this.subscribersValue.addClass("flash-red")}.bind(this),1)),this.subscriberCount=e,this.subscriberCount>0?(this.subscribersValue.html('<span class="icon i-eye"></span>'+e),this.subscribersElement.addClass("visible")):this.subscribersElement.removeClass("visible")},onCurrentSlideChanged:function(){this.sync()},onCurrentFragmentChanged:function(){this.sync()},onUpcomingSlideChanged:function(){}}),SL("views.devise").All=SL.views.Base.extend({init:function(){this._super(),this.setupForm()},setupForm:function(){if(this.formElement=$("form"),this.formElement.length){this.formElement.find(".unit[data-validate]").each(function(e,t){new SL.components.FormUnit(t)});var e=this.formElement.find("button[type=submit]");if(e.length){var t=Ladda.create(e.get(0));this.formElement.on("submit",function(e){e.isDefaultPrevented()||t.start()}.bind(this))}}}}),SL("views.devise").Edit=SL.views.devise.All.extend({init:function(){this._super(),$(".delete-account-toggle").on("click",this.onDeleteAccountToggleClicked.bind(this)),$(".delete-profile-photo").on("click",this.onDeleteProfilePhotoClicked.bind(this)),$("#user_email").on("change keyup",this.onEmailChanged.bind(this)),$("#user_password").on("change keyup",this.onNewPasswordChanged.bind(this)),this.undoAutoFill()},undoAutoFill:function(){if(navigator.userAgent.toLowerCase().indexOf("chrome")>=0)var e=window.setInterval(function(){var t=$("input:-webkit-autofill");t.length>0&&(window.clearInterval(e),t.each(function(){var e=$(this).clone(!0,!0);e.is("[type=password]")&&e.val(""),$(this).after(e).remove();var t=e.parent(".unit");t.length&&new SL.components.FormUnit(t)}))},20)},updatePasswordVerification:function(){var e=$("#user_email").parents(".unit"),t=$("#user_password").parents(".unit"),n=$("#user_current_password").parents(".unit"),i=e.data("controller"),s=t.data("controller");i&&s&&i.isUnchanged()&&s.isUnchanged()?(n.removeAttr("data-required"),n.addClass("hidden")):(n.attr("data-required","true"),n.removeClass("hidden"))},onDeleteAccountToggleClicked:function(e){e.preventDefault(),$(".delete-account").toggleClass("visible")},onDeleteProfilePhotoClicked:function(e){e.preventDefault(),$.ajax({url:SL.config.AJAX_UPDATE_USER,type:"PUT",context:this,data:{user:{profile_photo:""}}}).done(function(){$(".photo-editor").attr("data-photo-type","gravatar")}).fail(function(){SL.notify("An error occured while saving","negative")})},onEmailChanged:function(){this.updatePasswordVerification()},onNewPasswordChanged:function(){this.updatePasswordVerification()}}),SL("views.home").Explore=SL.views.Base.extend({init:function(){this._super(),new SL.components.Search({url:SL.config.AJAX_SEARCH})}}),SL("views.home").Index=SL.views.Base.extend({MARQUEE_MIN_HEIGHT:600,init:function(){this._super(),this.sharingElement=$(".marquee .sharing"),this.learnMoreButton=$(".marquee .learn-more"),this.backgroundElement=$(".marquee .marquee-background"),this.paginateLeftButton=$(".marquee .paginate-left"),this.paginateRightButton=$(".marquee .paginate-right"),this.setupBackground(),this.setupReveal(),this.setupVideo(),this.bind()},setupBackground:function(){this.backgroundImage=$("<img>",{src:SL.util.getStaticAsset("homepage-background.jpg?1"),load:this.onBackgroundLoaded.bind(this)})},setupReveal:function(){Reveal.initialize({controls:!0,progress:!1,history:!1,center:!0,rollingLinks:!1,hideAddressBar:!1,embedded:!0,width:1e3,height:"100%",maxScale:1,minScale:.5,margin:0,transition:"linear"}),SL.util.device.HAS_TOUCH&&$(".reveal .navigation-instructions").text("Swipe left or right to navigate.")},setupVideo:function(){$(".features video").each(function(e,t){var n="";t=$(t),t.find("span[data-src]").each(function(e,t){t=$(t),n+='<source src="'+t.attr("data-src")+'" type="'+t.attr("data-type")+'">'}),n&&t.html(n)})},bind:function(){this.sharingElement.on("mouseover",this.onSharingMouseOver.bind(this)),this.learnMoreButton.on("click",this.onLearnMoreClicked.bind(this)),this.paginateLeftButton.on("touchstart click",this.onPaginateLeftClicked.bind(this)),this.paginateRightButton.on("touchstart click",this.onPaginateRightClicked.bind(this)),this.paginateRightButton.on("mouseover",this.onPaginateRightOver.bind(this)),Reveal.addEventListener("ready",this.onRevealReady.bind(this)),Reveal.addEventListener("slidechanged",this.onSlideChanged.bind(this)),SL.util.device.IS_PHONE||(this.updateFeatureAnimations=$.debounce(this.updateFeatureAnimations,300),$(window).on("resize",this.updateFeatureAnimations.bind(this)),$(window).on("scroll",this.updateFeatureAnimations.bind(this)))
},updatePaginationButtons:function(){var e=Reveal.availableRoutes();this.paginateLeftButton.toggleClass("disabled",!(e.left||e.up)),this.paginateRightButton.toggleClass("disabled",!(e.right||e.down))},updateFeatureAnimations:function(){var e,t=$(window).scrollTop(),n=Number.MAX_VALUE;$(".features .feature .video-wrapper, .features .feature .animation-wrapper").each(function(i,s){s=$(s);var o=s.offset().top,a=o-t;a>-100&&500>a&&n>a&&(n=a,e=s)}),this.activeFeature&&!this.activeFeature.is(e)&&this.stopFeatureAnimation(),e&&!e.hasClass("playing")&&(this.activeFeature=e,this.startFeatureAnimation())},startFeatureAnimation:function(){if(this.activeFeature.addClass("playing"),this.activeFeature.is(".video-wrapper"))this.activeFeature.find("video").get(0).play();else if(this.activeFeature.is(".animation-wrapper")){var e=parseInt(this.activeFeature.attr("data-animation-steps"),10),t=parseInt(this.activeFeature.attr("data-animation-duration"),10),n=1;this.activeFeature.attr("data-animation-step",n),this.activeFeatureInterval=setInterval(function(){n+=1,n=n>e?1:n,this.activeFeature.attr("data-animation-step",n)}.bind(this),t/e)}SL.analytics.track("Home: Start feature animation")},stopFeatureAnimation:function(){this.activeFeature.removeClass("playing"),this.activeFeature.removeAttr("data-animation-step"),clearInterval(this.activeFeatureInterval),this.activeFeature.is(".video-wrapper")&&this.activeFeature.find("video").get(0).pause()},onPaginateLeftClicked:function(e){return Reveal.left(),e.preventDefault(),!1},onPaginateRightClicked:function(e){return Reveal.next(),e.preventDefault(),!1},onPaginateRightOver:function(){clearInterval(this.highlightRightArrowInterval)},onHighlightRightArrow:function(){this.paginateRightButton.removeClass("bounce"),setTimeout(function(){this.paginateRightButton.addClass("bounce")}.bind(this),1)},onRevealReady:function(){$(".marquee .example").addClass("show"),this.updatePaginationButtons(),this.highlightRightArrowInterval=setInterval(this.onHighlightRightArrow.bind(this),2500)},onSlideChanged:function(){this.updatePaginationButtons(),clearInterval(this.highlightRightArrowInterval),clearInterval(this.duringPresentationElementTimeout),0===Reveal.getIndices().h?($("html").removeClass("inside-of-example"),$(".during-presentation").removeClass("visible")):($("html").addClass("inside-of-example"),$(".reveal .slides [data-src]").each(function(e,t){t=$(t),t.attr("src",t.attr("data-src")),t.removeAttr("data-src")}),this.duringPresentationElementTimeout=setTimeout(function(){$(".during-presentation").addClass("visible")}.bind(this),1e3),this.hasEnteredPresentation||(this.hasEnteredPresentation=!0,SL.analytics.track("Home: Entered example deck")))},onBackgroundLoaded:function(){this.backgroundElement.css("background-image","url("+this.backgroundImage.attr("src")+")").addClass("show")},onSharingMouseOver:function(){this.sharingElement.hasClass("parsed")||(this.sharingElement.addClass("parsed"),this.sharingElement.html('<iframe src="//www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.facebook.com%2Fslidesapp&amp;send=false&amp;layout=button_count&amp;width=100&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font&amp;height=20&amp" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:100px; height:20px;" allowTransparency="true"></iframe><a href="https://twitter.com/share" class="twitter-share-button" data-url="http://slides.com" data-text="Create, present and share beautiful presentations with @slidesapp" data-count="horizontal" data-related="slidesapp"></a>'),!function(e,t,n){var i,s=e.getElementsByTagName(t)[0];e.getElementById(n)||(i=e.createElement(t),i.id=n,i.src="//platform.twitter.com/widgets.js",s.parentNode.insertBefore(i,s))}(document,"script","twitter-wjs"))},onLearnMoreClicked:function(){SL.analytics.track("Home: Clicked learn more")}}),SL("views.statik").All=SL.views.Base.extend({init:function(){this._super(),$("img.click-to-expand").on("click",function(){$(this).toggleClass("expanded")})}}),SL("views.statik").Pricing=SL.views.statik.All.extend({init:function(){this._super(),$(".tier").each(this.setupTier.bind(this))},setupTier:function(e,t){var t=$(t),n=t.find(".cta a");n.length&&!n.hasClass("disabled")&&(t.on("click",function(e){e.preventDefault(),window.location=n.attr("href")}),t.on("mouseenter",function(){t.addClass("hover")}),t.on("mouseleave",function(){t.removeClass("hover")}))}}),SL("views.subscriptions").EditPeriod=SL.views.Base.extend({init:function(){this._super(),Ladda.bind($("#payment-form button[type=submit]").get(0))}}),SL("views.subscriptions").New=SL.views.Base.extend({init:function(){this._super(),this.onFormSubmit=this.onFormSubmit.bind(this),this.onStripeResponse=this.onStripeResponse.bind(this),this.formElement=$("#payment-form"),this.formElement.on("submit",this.onFormSubmit),this.formSubmitButton=this.formElement.find("button[type=submit]"),this.formSubmitLoader=Ladda.create(this.formSubmitButton.get(0)),$("#stripe-card-number").payment("formatCardNumber"),$("#stripe-card-cvc").payment("formatCardCVC"),$("#stripe-month").payment("restrictNumeric"),$("#stripe-year").payment("restrictNumeric"),SL.util.device.supportedByEditor()||$(".column").prepend("<section class=\"critical-error\"><h2>Not supported</h2><p>It looks like you're using a browser which isn't suported by the Slides editor. Please make sure to try the editor before upgrading.</p></section>")},onFormSubmit:function(e){return this.formSubmitLoader.start(),Stripe.createToken(this.formElement,this.onStripeResponse),e.preventDefault(),!1},onStripeResponse:function(e,t){if(t.error)SL.notify(t.error.message,"negative"),this.formSubmitLoader.stop();else{var n=t.id;this.formElement.find('input[name="subscription[token]"]').remove(),this.formElement.append($('<input type="hidden" name="subscription[token]" />').val(n)),this.formElement.get(0).submit()}}}),SL("views.subscriptions").Show=SL.views.Base.extend({DOTTED_CARD_PREFIX:"&bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull; ",init:function(){this._super(),this.strings={CONFIRM_UNSUBSCRIBE_ACTION:"Unsubscribe",CONFIRM_UNSUBSCRIBE_DESCRIPTION:SL.locale.get("REMOVE_PRO_CONFIRM")},this.load()},bindLadda:function(){$(".column section .ladda-button").each(function(e,t){t=$(t),t.data("ladda")||t.data("ladda",Ladda.create(t.get(0)))})},load:function(){$.ajax({url:SL.config.AJAX_SUBSCRIPTIONS_STATUS,type:"GET",context:this}).done(this.onDataLoaded).fail(this.onDataFailed)},onDataLoaded:function(e){this.data=new SL.models.Customer(e.customer),this.render()},onDataFailed:function(){$(".billing-loader").text(SL.locale.get("BILLING_DETAILS_ERROR"))},render:function(){$(".billing-loader").remove(),this.renderDetails(),this.renderHistory(),(!SL.current_user.isEnterprise()||SL.current_user.billing_address)&&this.renderAddress(),this.bindLadda()},renderDetails:function(){var e=$('<section class="billing-details"><h2>Billing details</h2></section>').appendTo(".billing-wrapper"),t=this.data.hasActiveSubscription();if(t){if(e.append('<div class="field status"><span class="label">Status</span><span class="value">Active</span></div>'),this.data.has("active_card")&&e.append('<div class="field card"><span class="label">Card</span><span class="value">'+this.DOTTED_CARD_PREFIX+this.data.get("active_card.last4")+"</span></div>"),this.data.has("subscription")){var n=moment.unix(this.data.getNextInvoiceDate()).format("MMMM Do, YYYY"),i="$"+this.data.getNextInvoiceSum();e.append('<div class="field payment-cycle"><span class="label">Next invoice</span><span class="value">'+i+" on "+n+"</span></div>")}e.append('<footer class="actions"><a class="button s outline" href="'+SL.routes.SUBSCRIPTIONS_EDIT_CARD+'">Change credit card</a><button class="button s negative outline cancel-subscription ladda-button" data-style="expand-right" data-spinner-color="#222">'+this.strings.CONFIRM_UNSUBSCRIBE_ACTION+"</button></footer>"),this.data.get("can_change_period")&&e.find(".actions").prepend('<a class="button s outline" href="'+SL.routes.SUBSCRIPTIONS_EDIT_PERIOD+'">Change billing period</a>')}else{var s=moment.unix(this.data.get("subscription.current_period_end")).format("MMM Do, YYYY");e.append('<div class="field status"><span class="label">Status</span><span class="value">Pro until '+s+"</span></div>"),e.append('<footer class="actions"><a class="button s outline positive" href="'+SL.routes.SUBSCRIPTIONS_NEW+'">Return to Pro</a></footer>')}this.cancelButton=$(".billing-details .cancel-subscription"),this.cancelButton.length&&(this.cancelButton.on("click",this.onCancelSubscriptionClicked.bind(this)),this.cancelLoader=Ladda.create(this.cancelButton.get(0)))},renderHistory:function(){var e=$(['<section class="billing-history">',"<h2>Receipts</h2>",'<table class="sl-table"></table>','<div class="sl-checkbox outline">','<input type="checkbox" id="receipt-notifications">','<label for="receipt-notifications">Send receipts via email</label>',"</div>","</section>"].join("")).appendTo(".billing-wrapper"),t=e.find("table"),n=e.find("#receipt-notifications");n.on("change",this.onEmailNotificationChanged.bind(this)),SL.current_user.notify_on_receipt&&n.prop("checked",!0),t.html(["<tr>",'<th class="amount">Amount</th>','<th class="date">Date</th>','<th class="card">Card</th>','<th class="download">PDF</th>',"</tr>"].join(""));var i=this.data.get("charges");i&&i.length?i.forEach(function(e){var n=$(['<tr data-charge-id="'+e.id+'">','<td class="amount">$'+(e.amount/100).toFixed(2)+"</td>",'<td class="date">'+moment.unix(e.created).format("DD-MM-YYYY")+"</td>",'<td class="card">'+this.DOTTED_CARD_PREFIX+e.card.last4+"</td>",'<td class="download">','<form action="'+SL.config.AJAX_SUBSCRIPTIONS_PRINT_RECEIPT(e.id)+'" method="post">','<button type="submit" class="button outline ladda-button download-button" data-style="slide-right" data-spinner-color="#222">','<span class="icon i-arrow-down"></span>',"</button>","</form>","</td>","</tr>"].join(""));n.appendTo(t),SL.util.dom.insertCSRF(n.find(".download form"))}.bind(this)):t.replaceWith("<p>"+SL.locale.get("BILLING_DETAILS_NOHISTORY")+"</p>")},renderAddress:function(){var e=$(['<section class="billing-address">',"<h2>Billing address</h2>",'<div class="sl-form">','<div class="unit">','<p class="unit-description">If you wish to include a billing address on your receipts please enter it below.</p>','<textarea class="billing-address-input" rows="4" maxlength="100">',SL.current_user.billing_address||"","</textarea>","</div>",'<div class="footer">','<button class="button l positive billing-address-save">Save</button>',"</div>","</div>","</section>"].join("")).appendTo(".billing-wrapper");this.addressInputField=e.find(".billing-address-input"),this.addressSaveButton=e.find(".billing-address-save"),this.addressInputField.on("change keyup mouseup",this.checkAddress.bind(this)),this.addressSaveButton.on("click",this.saveAddress.bind(this)),this.checkAddress()},checkAddress:function(){this.addressInputField.val()===(SL.current_user.billing_address||"")?this.addressSaveButton.hide():this.addressSaveButton.show()},saveAddress:function(){this.billingAddressXHR&&this.billingAddressXHR.abort();var e=this.addressInputField.val()||"";this.billingAddressXHR=$.ajax({url:SL.config.AJAX_UPDATE_USER,type:"PUT",context:this,data:{user:{billing_address:e}}}).done(function(){SL.current_user.billing_address=e,SL.notify("Billing address saved")}).fail(function(){SL.notify(SL.locale.get("GENERIC_ERROR"),"negative")}).always(function(){this.billingAddressXHR=null,this.checkAddress()})},onCancelSubscriptionClicked:function(e){SL.prompt({anchor:$(e.currentTarget),title:this.strings.CONFIRM_UNSUBSCRIBE_DESCRIPTION,type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Continue</h3>",selected:!0,className:"negative",callback:function(){this.cancelLoader.start(),$.ajax({url:SL.config.AJAX_SUBSCRIPTIONS,type:"DELETE",context:this}).done(this.onCancelSubscriptionSuccess).fail(this.onCancelSubscriptionError)}.bind(this)}]})},onCancelSubscriptionSuccess:function(){SL.notify(SL.locale.get("REMOVE_PRO_SUCCESS")),window.location.reload()},onCancelSubscriptionError:function(){SL.notify(SL.locale.get("GENERIC_ERROR")),this.cancelLoader.stop()},onEmailNotificationChanged:function(e){this.emailNotificationXHR&&this.emailNotificationXHR.abort(),this.emailNotificationXHR=$.ajax({url:SL.config.AJAX_UPDATE_USER,type:"PUT",context:this,data:{user:{notify_on_receipt:e.currentTarget.value}}}).done(function(){SL.notify("Notification change saved")}).fail(function(){SL.notify(SL.locale.get("GENERIC_ERROR"),"negative")}).always(function(){this.emailNotificationXHR=null})}}),SL("views.teams").New=SL.views.Base.extend({init:function(){this._super(),this.formElement=$("#payment-form"),this.formSubmitButton=this.formElement.find("button[type=submit]"),this.formSubmitLoader=Ladda.create(this.formSubmitButton.get(0)),this.bind(),this.summarize()},bind:function(){this.summarize=this.summarize.bind(this),this.formElement.on("keydown",this.onFormKeyDown.bind(this)),this.formSubmitButton.on("click",this.onFormSubmitClicked.bind(this)),this.formElement.find("#team-name").on("input",this.onTeamNameChange.bind(this)),this.formElement.find('input[name="billing-period"]').on("change",this.summarize),$("#stripe-card-number").payment("formatCardNumber"),$("#stripe-card-cvc").payment("formatCardCVC"),$("#stripe-month").payment("restrictNumeric"),$("#stripe-year").payment("restrictNumeric"),this.formElement.find(".unit[data-validate], .unit[data-required]").each(function(e,t){$(t).data("unit",new SL.components.FormUnit(t))})},summarize:function(){var e=this.formElement.find(".purchase-summary"),t=e.find(".message"),n="monthly"===this.formElement.find('input[name="billing-period"]:checked').val(),i={period:n?"month":"year",cost:"$"+(n?14:140)};t.html(["You are starting a <strong>30 day free trial</strong>. If you cancel anytime in that period you will not be charged at all.","<br><br>After the trial you will begin paying <strong>"+i.cost+" per "+i.period+"</strong> for each team member."].join(""))},validate:function(){var e=!0;return this.formElement.find(".unit[data-validate], .unit[data-required]").each(function(t,n){var i=$(n).data("unit");i.validate(!0)===!1&&(e&&i.focus(),e=!1)}),e},captureData:function(){this.formData={team:{name:this.formElement.find("#team-name").val(),slug:this.formElement.find("#team-slug").val()},user:{username:this.formElement.find("#user-name").val(),email:this.formElement.find("#user-email").val(),password:this.formElement.find("#user-password").val()},subscription:{billing_period:this.formElement.find('input[name="billing-period"]:checked').val()}}},submitToStripe:function(){this.validate()&&(this.captureData(),this.formSubmitLoader.start(),Stripe.createToken(this.formElement,this.onStripeResponse.bind(this)))},submitToApp:function(e){this.formData.subscription.token=e,$.ajax({type:"POST",url:SL.config.AJAX_TEAMS_CREATE,data:JSON.stringify(this.formData),dataType:"json",context:this,contentType:"application/json"}).done(function(e){window.location=e.team&&"string"==typeof e.team.root_url?window.location.protocol+"//"+e.team.root_url:window.location.protocol+"//"+this.formData.team.slug+"."+window.location.host}).fail(function(e){var t=JSON.parse(e.responseText);t&&t.user&&t.user.email&&t.user.email.length?SL.notify("Email error: "+t.user.email[0],"negative"):SL.notify(SL.locale.get("GENERIC_ERROR"),"negative"),this.formSubmitLoader.stop()})},onStripeResponse:function(e,t){t.error?(SL.notify(t.error.message,"negative"),this.formSubmitLoader.stop()):this.submitToApp(t.id)},onFormKeyDown:function(e){return 13===e.keyCode?(this.submitToStripe(),e.preventDefault(),!1):void 0},onFormSubmitClicked:function(e){return this.submitToStripe(),e.preventDefault(),!1},onTeamNameChange:function(){var e=this.formElement.find("#team-name"),t=this.formElement.find("#team-slug");t.val(SL.util.string.slug(e.val()));var n=t.data("unit");n&&n.validate()}}),SL("views.teams.subscriptions").Show=SL.views.subscriptions.Show.extend({init:function(){this._super()},render:function(){this.data.isTrial()?(this.strings.CONFIRM_UNSUBSCRIBE_ACTION="Delete my team",this.strings.CONFIRM_UNSUBSCRIBE_DESCRIPTION="Your trial will be canceled immediately and this team will be inaccessible."):(this.strings.CONFIRM_UNSUBSCRIBE_ACTION="Cancel subscription",this.strings.CONFIRM_UNSUBSCRIBE_DESCRIPTION="Your subscription will be canceled and this team will be inaccessible after the end of the current billing cycle."),this._super()},renderDetails:function(){var e=$('<section class="billing-details"><h2>Billing details</h2></section>').appendTo(".billing-wrapper"),t=this.data.hasActiveSubscription(),n=this.data.isTrial();if(t){if(e.append(n?'<div class="field status"><span class="label">Status</span><span class="value">Trial</span></div>':'<div class="field status"><span class="label">Status</span><span class="value">Active</span></div>'),SL.current_team.has("user_count")&&e.append('<div class="field active-users"><span class="label" data-tooltip="The current number of users that you have invited to the team." data-tooltip-maxwidth="260">Team members</span><span class="value">'+SL.current_team.get("user_count")+"</span></div>"),this.data.has("subscription.period")&&e.append('<div class="field period"><span class="label">Billing period</span><span class="value">'+("year"===this.data.get("subscription.period")?"Yearly":"Monthly")+"</span></div>"),this.data.has("active_card")&&e.append('<div class="field card"><span class="label">Card</span><span class="value">'+this.DOTTED_CARD_PREFIX+this.data.get("active_card.last4")+"</span></div>"),this.data.has("subscription")){var i=moment.unix(this.data.getNextInvoiceDate()).format("MMMM Do, YYYY"),s=n?"First invoice":"Next invoice",o="$"+this.data.getNextInvoiceSum();e.append('<div class="field payment-cycle"><span class="label">'+s+'</span><span class="value">'+o+" on "+i+"</span></div>")}e.append('<footer class="actions"><a class="button s outline" href="'+SL.routes.SUBSCRIPTIONS_EDIT_CARD+'">Change credit card</a><button class="button s negative outline cancel-subscription ladda-button" data-style="expand-right" data-spinner-color="#222">'+this.strings.CONFIRM_UNSUBSCRIBE_ACTION+"</button></footer>"),this.data.get("can_change_period")&&e.find(".actions").prepend('<a class="button s outline" href="'+SL.routes.SUBSCRIPTIONS_EDIT_PERIOD+'">Change billing period</a>')}else{var a=moment.unix(this.data.get("subscription.current_period_end")).format("MMM Do, YYYY");e.append('<div class="field status"><span class="label">Status</span><span class="value">Canceled, available until '+a+"</span></div>")}this.cancelButton=$(".billing-details .cancel-subscription"),this.cancelButton.length&&(this.cancelButton.on("click",this.onCancelSubscriptionClicked.bind(this)),this.cancelLoader=Ladda.create(this.cancelButton.get(0)))},onCancelSubscriptionSuccess:function(){SL.notify("Subscription canceled"),window.location="http://slides.com"}}),SL("views.teams.teams").Edit=SL.views.Base.extend({init:function(){this._super(),this.render()},render:function(){if(this.formElement=$("form"),this.formElement.length){this.formElement.find(".unit[data-factory]").each(function(e,t){var n=null;$(t).attr("data-factory").split(".").forEach(function(e){n=n?n[e]:window[e]}),"function"==typeof n&&new n(t)}),this.formElement.find(".unit[data-validate]:not([data-factory])").each(function(e,t){new SL.components.FormUnit(t)});var e=this.formElement.find("button[type=submit]");if(e.length){var t=Ladda.create(e.get(0));this.formElement.on("submit",function(e){e.isDefaultPrevented()||t.start()}.bind(this))}}}}),SL("views.teams.teams").EditMembers=SL.views.Base.extend({init:function(){this._super(),this.domElement=$("section.users"),this.load()},bindLadda:function(){$(".column section .ladda-button").each(function(e,t){t=$(t),t.data("ladda")||t.data("ladda",Ladda.create(t.get(0)))})},load:function(){$.ajax({type:"GET",url:SL.config.AJAX_ORGANIZATION_MEMBERS_LIST,context:this}).done(function(e){this.userData=new SL.models.Collection,this.userLimit=e.max,e.results.forEach(function(e){this.userData.push(new SL.models.User(e))}.bind(this))}).fail(function(){SL.notify(SL.locale.get("ORG_USERS_LIST_LOAD_ERROR"),"negative")}).always(this.render)},render:function(){var e=this.domElement.find(".contents");e.empty(),this.renderTable(e),this.renderInviteForm(e),this.syncInviteForm()},renderTable:function(e){if(this.userData.isEmpty())e.html('<p class="empty-notice">'+SL.locale.get("ORG_USERS_LIST_EMPTY")+"</p>");else{var t=$('<table class="sl-table">').appendTo(e);t.append('<tr><th class="name">Name</th><th class="username">Username</th><th class="email">Email</th><th class="actions">Actions</th></tr>'),this.userData.forEach(this.renderUser.bind(this))}},renderInviteForm:function(e){var t=$('<form class="create-user-form"><h4>Add a user to this team</h4><div class="unit text" data-validate="email" data-required><input type="text" placeholder="Email" name="email" size="35"></div><div class="unit text" data-validate="username" data-required><input type="text" placeholder="Username" name="username"></div><button type="submit" class="button positive l ladda-button create-user" data-style="zoom-out">Add</button></form>').appendTo(e),n=t.find("[name=email]"),i=t.find("[name=username]");t.find(".unit[data-validate]").each(function(e,t){new SL.components.FormUnit(t)}),t.on("submit",function(e){return this.createUser(),e.preventDefault(),!1}.bind(this)),n.on("blur",function(){var e=n.val(),t=i.val();t||0!==SL.util.validate.email(e).length||i.val(SL.util.string.slug(e.slice(0,e.indexOf("@"))))}.bind(this)),this.bindLadda()},renderUser:function(e){var t=$("<tr>"),n='<div class="avatar" style="background-image: url('+e.thumbnail_url+')"></div>';if(t.append("<td>"+n+(e.name||"N/A")+"</td>"),t.append('<td><a href="/'+e.username+'" target="_blank">'+e.username+"</a></td>"),t.append("<td>"+e.email+"</td>"),SL.current_user.username&&SL.current_user.username!==e.username){var i=$("<td>");i.append('<button class="button outline ladda-button remove-user" data-style="zoom-out" data-spinner-color="#222" data-tooltip="Remove this user from the team"><span class="i-trash-stroke"></span></button>'),e.registered||(i.append('<button class="button outline ladda-button welcome-user" data-style="zoom-out" data-spinner-color="#222" data-tooltip="Re-send invite email"><span class="i-mail"></span></button>'),t.addClass("disabled")),t.append(i),t.find(".welcome-user").on("click",function(n){this.welcomeUser(n,e,t)}.bind(this)),t.find(".remove-user").on("click",function(n){this.removeUser(n,e,t)}.bind(this))}else t.append("<td></td>");t.appendTo(this.domElement.find("table")),this.bindLadda()},syncInviteForm:function(){$(".team-is-full-notice").remove(),this.isTeamFull()&&$(".create-user-form").append('<div class="team-is-full-notice"><h4>This team is full</h4><p>To add new members please <a href="mailto:support@slides.com" data-feedback-mode="contact" data-feedback-screenshot_enabled="false">contact support</a>.</p></div>')},createUser:function(){if(this.isTeamFull())return SL.notify("Your team is full, please contact support"),!1;var e=$(".create-user-form"),t=e.find("button.create-user").data("ladda");t&&t.start(),$.ajax({type:"POST",url:SL.config.AJAX_ORGANIZATION_MEMBER_CREATE,data:{user:{email:e.find("[name=email]").val(),username:e.find("[name=username]").val()}},dataType:"json",context:this}).done(function(n){var i=new SL.models.User(n);this.userData.isEmpty()?(this.userData.push(i),this.render()):(this.userData.push(i),this.renderUser(i)),e.find("[name=email]").val(""),e.find("[name=username]").val(""),this.syncInviteForm(),t&&t.stop(),SL.notify(SL.locale.get("ORG_USERS_INVITE_SEND_SUCCESS"))}).fail(function(e){e=$.parseJSON(e.responseText)||{},t&&t.stop(),"object"==typeof e.email&&e.email.length?SL.notify("Email error: "+e.email[0],"negative"):"object"==typeof e.username&&e.username.length?SL.notify("Username error: "+e.username[0],"negative"):SL.notify("Failed to add user","negative")})},removeUser:function(e,t,n){SL.prompt({anchor:$(e.currentTarget),title:SL.locale.get("ORG_USERS_REMOVE_CONFIRM",{name:t.name||t.username}),type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Delete</h3>",selected:!0,className:"negative",callback:function(){var e=n.find(".remove-user").data("ladda");e&&e.start(),$.ajax({type:"DELETE",url:SL.config.AJAX_ORGANIZATION_MEMBER_DELETE(t.id),context:this}).done(function(){n.remove(),this.userData.remove({id:t.id}),this.syncInviteForm(),e&&e.stop(),SL.notify(SL.locale.get("ORG_USERS_REMOVE_SUCCESS"))}).fail(function(){e&&e.stop(),SL.notify(SL.locale.get("ORG_USERS_REMOVE_ERROR"),"negative")})}.bind(this)}]})},welcomeUser:function(e,t){var n=t.find(".welcome-user").data("ladda");n&&n.start(),$.ajax({type:"POST",url:SL.config.AJAX_ORGANIZATION_MEMBER_WELCOME(e.id),context:this}).done(function(){n&&n.stop(),SL.notify(SL.locale.get("ORG_USERS_INVITE_SEND_SUCCESS"))}).fail(function(){n&&n.stop(),SL.notify(SL.locale.get("ORG_USERS_INVITE_SEND_ERROR"),"negative")})},isTeamFull:function(){return this.userLimit>0&&this.userData.size()>=this.userLimit}}),SL("views.teams.teams").Show=SL.views.Base.extend({init:function(){this._super(),new SL.components.Search({url:SL.config.AJAX_SEARCH_ORGANIZATION})}}),SL("views.themes").Edit=SL.views.Base.extend({init:function(){this._super(),this.themeData=new SL.models.Collection,this.domElement=$(".page-wrapper"),this.sidebarElement=$(".page-wrapper .sidebar"),this.contentsElement=$(".page-wrapper .contents"),this.listElement=this.sidebarElement.find(".theme-list"),this.load(),this.bindLadda(),this.setupPreview(),$(window).on("beforeunload",this.onWindowBeforeUnload.bind(this))},bindLadda:function(){$(".page-wrapper .ladda-button").each(function(e,t){t=$(t),t.data("ladda")||t.data("ladda",Ladda.create(t.get(0)))})},setupPreview:function(){this.previewFrame=$(".preview .preview-frame"),this.previewReloader=$(".preview .preview-reloader"),this.previewReloader.on("click",this.reloadPreview.bind(this)),window.addEventListener("message",function(e){e.data&&"theme-preview-ready"===e.data.type&&this.refreshPreview()}.bind(this))},load:function(){SL.helpers.PageLoader.show("Loading themes..."),$.ajax({type:"GET",url:SL.config.AJAX_THEMES_LIST,context:this}).done(function(e){this.themeData.clear(),e.results.forEach(function(e){this.themeData.push(new SL.models.Theme(e))}.bind(this))}).fail(function(){SL.notify(SL.locale.get("THEME_LIST_LOAD_ERROR"),"negative")}).always(function(){this.renderList(),SL.helpers.PageLoader.hide()})},renderList:function(){if(this.listElement.empty(),this.themeData.isEmpty())this.listElement.html('<p class="empty-notice">'+SL.locale.get("THEME_LIST_EMPTY")+"</p>");else{{$("<ul>").appendTo(this.listElement)}this.themeData.forEach(this.renderListItem.bind(this))}$('<button class="button outline white l create-theme"><span class="icon i-plus"></span></button>').on("click",this.createTheme.bind(this)).appendTo(this.listElement),this.updateListDefault()},renderListItem:function(e){var t=this.listElement.find('[data-theme-id="'+e.get("id")+'"]');t.length?t.find(".list-item-label").text(e.get("name")).attr("title",e.get("name")):(t=$(['<li class="list-item" data-theme-id="'+e.get("id")+'">','<div class="list-item-controls-wrapper">','<div class="list-item-controls">','<button class="delete" data-tooltip="'+SL.locale.get("THEME_DELETE_TOOLTIP")+'" data-tooltip-alignment="b">','<span class="icon i-trash-stroke"></span>',"</button>",'<button class="default" data-tooltip="'+SL.locale.get("THEME_MAKE_DEFAULT_TOOLTIP")+'" data-tooltip-alignment="b">','<span class="icon i-checkmark"></span>',"</button>","</div>","</div>",'<span class="list-item-label" title="'+e.get("name")+'">'+e.get("name")+"</span>","</li>"].join("")),e.hasThumbnail()&&t.css("background-image",'url("'+e.get("thumbnail_url")+'")'),t.appendTo(this.listElement.find("ul"))),t.off("click").on("click",function(n){$(n.target).closest(".list-item-controls .delete").length?this.removeTheme(e):$(n.target).closest(".list-item-controls .default").length?t.hasClass("default")?this.unmakeDefaultTheme():this.makeDefaultTheme(e):this.editTheme(e)}.bind(this))},updateListDefault:function(){this.listElement.find(".list-item").each(function(e,t){t=$(t),t.toggleClass("default",t.attr("data-theme-id")==SL.current_team.get("default_theme_id")),t.find(".list-item-controls .default").attr("data-tooltip",SL.locale.get(t.hasClass("default")?"THEME_IS_DEFAULT_TOOLTIP":"THEME_MAKE_DEFAULT_TOOLTIP"))})},editTheme:function(e){return this.panel?(this.panel.close(function(){this.editTheme(e)}.bind(this)),!1):($("html").addClass("panel-open"),this.panel=new SL.views.themes.edit.Panel(this,e),this.panel.destroyed.add(function(){this.setSelectedListItem(null),$("html").removeClass("panel-open"),this.panel=null}.bind(this)),this.setSelectedListItem(e),void this.bindLadda())},createTheme:function(){$.ajax({type:"POST",url:SL.config.AJAX_THEMES_CREATE,context:this}).done(function(e){var t=new SL.models.Theme(e);this.themeData.isEmpty()?(this.themeData.push(t),this.renderList(),this.makeDefaultTheme(t,null,!0)):(this.themeData.push(t),this.renderListItem(t))}).fail(function(){SL.notify(SL.locale.get("THEME_CREATE_ERROR"),"negative")})},saveTheme:function(e,t){$.ajax({type:"PUT",url:SL.config.AJAX_THEMES_UPDATE(e.get("id")),data:{theme:e.toJSON()},context:this}).done(function(e){this.renderListItem(new SL.models.Theme(e)),e&&e.sanitize_messages&&e.sanitize_messages.length?SL.notify(e.sanitize_messages[0],"negative"):SL.notify(SL.locale.get("THEME_SAVE_SUCCESS")),SL.util.callback(t)}).fail(function(){SL.notify(SL.locale.get("THEME_SAVE_ERROR"),"negative")})},removeTheme:function(e,t){var n=this.getListItem(e);SL.prompt({anchor:n,alignment:"r",title:SL.locale.get("THEME_REMOVE_CONFIRM"),type:"select",offsetX:15,data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Delete</h3>",selected:!0,className:"negative",callback:function(){var i=e.get("id");$.ajax({type:"DELETE",url:SL.config.AJAX_THEMES_DELETE(i),context:this}).done(function(){SL.util.anim.collapseListItem(n),SL.util.callback(t),this.themeData.remove({id:i}),this.panel&&this.panel.getTheme().get("id")===i&&this.panel.destroy(),SL.notify(SL.locale.get("THEME_REMOVE_SUCCESS"))}).fail(function(){SL.notify(SL.locale.get("THEME_REMOVE_ERROR"),"negative")})}.bind(this)}]})},makeDefaultTheme:function(e,t,n){$.ajax({type:"PUT",url:SL.config.AJAX_UPDATE_ORGANIZATION,data:{team:{default_theme_id:e.get("id")}},context:this}).done(function(){SL.current_team.set("default_theme_id",e.get("id")),this.updateListDefault(),n||SL.notify(SL.locale.get("THEME_DEFAULT_SAVE_SUCCESS")),SL.util.callback(t)}).fail(function(){n||SL.notify(SL.locale.get("THEME_DEFAULT_SAVE_ERROR"),"negative")})},unmakeDefaultTheme:function(e,t){$.ajax({type:"PUT",url:SL.config.AJAX_UPDATE_ORGANIZATION,data:{team:{default_theme_id:null}},context:this}).done(function(){SL.current_team.set("default_theme_id",null),this.updateListDefault(),t||SL.notify(SL.locale.get("THEME_DEFAULT_SAVE_SUCCESS")),SL.util.callback(e)}).fail(function(){t||SL.notify(SL.locale.get("THEME_DEFAULT_SAVE_ERROR"),"negative")})},getListItem:function(e){return this.listElement.find('[data-theme-id="'+(e?e.get("id"):null)+'"]')},setSelectedListItem:function(e){this.listElement.find(".list-item").removeClass("selected");var t=this.getListItem(e);t.length&&t.addClass("selected")},refreshPreview:function(e){e=e||this.previewTheme;var t=this.getPreviewWindow();t&&e&&(t.SL&&t.SL.helpers&&t.SL.helpers.ThemeController.paint(e),this.previewTheme=e)},reloadPreview:function(){var e=this.getPreviewWindow();e&&e.location.reload()},getPreviewWindow:function(){return this.previewFrame.length?this.previewFrame.get(0).contentWindow:null},onWindowBeforeUnload:function(){return this.panel&&this.panel.hasUnsavedChanges()?SL.locale.get("LEAVE_UNSAVED_THEME"):void 0}}),SL("views.themes.edit.pages").Snippets=Class.extend({init:function(e,t){this.editor=e,this.theme=t,this.changed=new signals.Signal,this.render(),this.bind(),this.syncMoveButtons()},render:function(){this.domElement=$('<div class="page" data-page-id="snippets">'),this.domElement.html(['<div class="page-header">',"<h4>Snippets</h4>",'<p>Snippets are small HTML templates that your team members can use as building blocks when creating decks. These templates can contain placeholder variables that are filled out at the time of insertion. <a class="documentation-link" href="#">More info</a></p>','<div class="documentation">',"<p>Each snippet consist of two values; title and template. The title is what we'll show your teammates so try to keep it descriptive. The template is where you enter your custom HTML.</p>","<h5>Variables</h5>","<p>If you add placeholder variables inside of your templates the user will be prompted to fill them out. The syntax for variables is as follows:</p>","<pre><code>{{Label Value}}</code></pre>","<p>The string between the opening and closing brackets is considered the variable name. This name is shown when the snippet is inserted so that the author knows what value you're expecting.</p>","<p>It's possible to define default values for variables. To do so you'll need to delimit your variable name and default value by two colon characters as shown below.</p>","<pre><code>{{Label Value::Default value}}</code></pre>","<h5>Example</h5>","<p>Here's a basic example template that shows how you could create a snippet for images with captions.</p>","<pre><code>",'&lt;div class="image-with-caption"&gt;\n','  &lt;img src="{{Image URL}}"&gt;\n',"  &lt;p&gt;{{Caption::Untitled}}&lt;/p&gt;\n","&lt;/div&gt;","</code></pre>","</div>","</div>",'<div class="page-body">','<ul class="snippet-list"></ul>','<ul class="snippet-controls snippet-list-item sl-form">','<div class="add-button-wrapper">','<button class="button l add-button">Add Snippet <span class="icon i-plus"></span></button>',"</div>",'<div class="unit text">',"<label>Title</label>",'<input class="title-value" maxlength="200" type="text" readonly>',"</div>",'<div class="unit text">',"<label>Template</label>",'<textarea class="template-value" rows="4" readonly></textarea>',"</div>","</ul>","</div>"].join("")),this.innerElement=this.domElement.find(".page-body"),this.listElement=this.domElement.find(".snippet-list"),this.controlsElement=this.domElement.find(".snippet-controls"),this.addButton=this.domElement.find(".snippet-controls .add-button-wrapper"),this.documentationLinkElement=this.domElement.find(".page-header .documentation-link"),this.documentationElement=this.domElement.find(".page-header .documentation"),this.documentationElement.hide(),this.renderList()
},renderList:function(){this.listElement.empty(),this.theme.get("snippets").forEach(this.renderListItem.bind(this))},renderListItem:function(e){var t=$('<li class="snippet-list-item sl-form">');return t.html(['<div class="unit text">',"<label>Title</label>",'<input class="title-value" maxlength="200" value="'+e.get("title")+'" type="text" spellcheck="false">',"</div>",'<div class="unit text">',"<label>Template</label>",'<textarea class="template-value" rows="4" spellcheck="false">'+e.get("template")+"</textarea>",'<div class="status" data-tooltip="" data-tooltip-maxwidth="400" data-tooltip-align="left"><span class="icon i-info"></span></div>',"</div>",'<div class="snippet-list-item-footer">','<button class="button outline delete-button" data-tooltip="Delete" data-tooltip-delay="1000"><snap class="icon i-trash-stroke"></snap></button>','<button class="button outline preview-button" data-tooltip="Preview" data-tooltip-delay="1000"><snap class="icon i-eye"></snap></button>','<button class="button outline move-up-button" data-tooltip="Move Up" data-tooltip-delay="1000"><snap class="icon i-arrow-up"></snap></button>','<button class="button outline move-down-button" data-tooltip="Move Down" data-tooltip-delay="1000"><snap class="icon i-arrow-down"></snap></button>',"</div>"].join("")),t.appendTo(this.listElement),t.data("model",e),t.find("input, textarea").on("input",this.onSnippetChange.bind(this)),t.find("input, textarea").on("focus",this.onSnippetFocused.bind(this)),t.find(".delete-button").on("click",this.onSnippetDelete.bind(this)),t.find(".preview-button").on("click",this.onSnippetFocused.bind(this)),t.find(".move-up-button").on("click",this.onSnippetMoveUp.bind(this)),t.find(".move-down-button").on("click",this.onSnippetMoveDown.bind(this)),this.validateSnippet(t),t},bind:function(){this.addButton.on("click",this.addSnippet.bind(this)),this.documentationLinkElement.on("click",this.onDocumentationLinkClicked.bind(this))},appendTo:function(e){this.domElement.appendTo(e),this.listElement.find(".snippet-list-item").each(function(e,t){this.layoutSnippet($(t))}.bind(this))},addSnippet:function(){var e=this.theme.get("snippets").create(),t=this.renderListItem(e);t.data("model",e),t.find("input").first().focus(),setTimeout(function(){var e=this.domElement.prop("scrollHeight");e-=this.domElement.outerHeight(!0),e-=this.controlsElement.outerHeight(!0),this.domElement.scrollTop(e)}.bind(this),1),this.changed.dispatch(),this.syncMoveButtons()},layoutSnippet:function(e){var t=e.find(".template-value");t.attr("rows",4);var n=parseFloat(t.css("line-height")),i=t.prop("scrollHeight"),s=t.prop("clientHeight");i>s&&t.attr("rows",Math.min(Math.ceil(i/n),10))},validateSnippet:function(e){var t=e.data("model"),n=[],i=[],s=t.templateHasVariables(),o=t.templateHasSelection();if(s&&o)i.push("Templates can not mix variables and selection tags.");else if(s){var a=t.getTemplateVariables();n.push("Found "+a.length+" variables:"),a.forEach(function(e){n.push(e.defaultValue?"- "+e.label+" (default: "+e.defaultValue+")":"- "+e.label)})}i.length?e.find(".status").addClass("negative").show().attr("data-tooltip",i.join("<br>")):n.length?e.find(".status").removeClass("negative").show().attr("data-tooltip",n.join("<br>")):e.find(".status").removeClass("negative").hide()},previewSnippet:function(e){var t=this.editor.getPreviewWindow(),n=t.$("#snippet-slide");0===n.length&&(n=$('<section id="snippet-slide">').appendTo(t.$(".reveal .slides"))),n.html(e.templatize(e.getTemplateVariables())),t.SL.util.skipCSSTransitions(),t.Reveal.sync(),t.Reveal.slide(n.index())},syncSnippetOrder:function(){var e=this.listElement.find(".snippet-list-item"),t=this.theme.get("snippets");e.sort(function(e,n){var i=t.findByValue($(e).data("model")),s=t.findByValue($(n).data("model"));return i-s}.bind(this)),e.each(function(e,t){this.listElement.append(t)}.bind(this)),this.syncMoveButtons()},syncMoveButtons:function(){this.listElement.find(".snippet-list-item").each(function(e,t){t=$(t),t.find(".move-up-button").toggleClass("disabled",t.is(":first-child")),t.find(".move-down-button").toggleClass("disabled",t.is(":last-child"))})},destroy:function(){this.changed.dispose(),this.listElement.find(".snippet-list-item").off().removeData("model");var e=this.editor.getPreviewWindow();e.$("#snippet-slide").remove(),e.Reveal.sync(),e.Reveal.slide(0),this.editor=null,this.theme=null},onDocumentationLinkClicked:function(e){e.preventDefault(),this.documentationElement.toggle(),this.documentationLinkElement.text(this.documentationElement.is(":visible")?"Less info":"More info")},onSnippetFocused:function(e){var t=$(e.target).closest(".snippet-list-item");t.length&&this.previewSnippet(t.data("model"))},onSnippetChange:function(e){var t=$(e.target).closest(".snippet-list-item");if(t.length){var n=t.data("model");n.set("title",t.find(".title-value").val()),n.set("template",t.find(".template-value").val()),this.layoutSnippet(t),this.validateSnippet(t),this.previewSnippet(n),this.changed.dispatch()}},onSnippetDelete:function(e){var t=$(e.target).closest(".snippet-list-item");if(t.length){var n=t.data("model");n?SL.prompt({anchor:$(e.currentTarget),title:SL.locale.get("THEME_SNIPPET_DELETE_CONFIRM"),type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Remove</h3>",selected:!0,className:"negative",callback:function(){SL.util.anim.collapseListItem(t,function(){t.remove(),this.syncMoveButtons()}.bind(this));var e=this.theme.get("snippets");e.remove(e.findByValue(t.data("model"))),this.changed.dispatch()}.bind(this)}]}):SL.notify("An error occured while deleting this snippet")}else SL.notify("An error occured while deleting this snippet")},onSnippetMoveUp:function(e){var t=$(e.target).closest(".snippet-list-item");if(t.length){var n=t.data("model");if(n){var i=this.theme.get("snippets");i.shiftLeft(i.findByValue(n)),this.changed.dispatch(),this.syncSnippetOrder()}}},onSnippetMoveDown:function(e){var t=$(e.target).closest(".snippet-list-item");if(t.length){var n=t.data("model");if(n){var i=this.theme.get("snippets");i.shiftRight(i.findByValue(n)),this.changed.dispatch(),this.syncSnippetOrder()}}}}),SL("views.themes.edit").Panel=Class.extend({PAGES:[{name:"Settings",id:"settings",factory:"renderSettings"},{name:"CSS",id:"css",factory:"renderCSS"},{name:"HTML",id:"html",factory:"renderHTML"},{name:"JavaScript",id:"js",factory:"renderJS",condition:function(){return SL.current_team.get("allow_scripts")}},{name:"Snippets",id:"snippets",factory:"renderSnippets"}],init:function(e,t){this.editor=e,this.theme=t.clone(),this.previewTimeout=-1,this.destroyed=new signals.Signal,this.updatePreview=this.updatePreview.bind(this),this.paintPreview=this.paintPreview.bind(this),this.render(),this.bind(),this.showPage("settings"),this.paintPreview(),this.savedJSON=JSON.stringify(this.theme.toJSON()),this.checkUnsavedChanges()},render:function(){this.domElement=$('<div class="panel">'),this.domElement.appendTo(this.editor.contentsElement),this.pagesElement=$('<div class="pages">'),this.pagesElement.appendTo(this.domElement),this.renderHeader(),this.renderPages(),this.resetScrollPosition()},renderHeader:function(){this.headerElement=$('<header class="panel-header">').appendTo(this.domElement),this.tabsElement=$('<div class="page-tabs">').appendTo(this.headerElement),this.cancelButton=$('<button class="button l grey cancel-button"><span class="icon i-arrow-left"></span></button>').appendTo(this.headerElement),this.saveButton=$('<button class="button l positive save-button ladda-button" data-style="zoom-out">Save</button>').appendTo(this.headerElement),this.onSaveClicked=this.onSaveClicked.bind(this),this.onCancelClicked=this.onCancelClicked.bind(this),this.saveButton.on("click",this.onSaveClicked),this.cancelButton.on("click",this.onCancelClicked)},renderPages:function(){this.PAGES.forEach(function(e){("function"!=typeof e.condition||e.condition())&&($('<button class="page-tab" data-page-id="'+e.id+'">'+e.name+"</button>").on("click",this.showPage.bind(this,e.id)).appendTo(this.tabsElement),this[e.factory]())}.bind(this))},renderSettings:function(){this.settingsElement=$('<div class="page sl-form" data-page-id="settings">').appendTo(this.pagesElement),this.settingsElement.append('<div class="unit name" data-required><label for="">Name</label><input id="theme-name" placeholder="Theme name" type="text" value="'+(this.theme.get("name")||"Untitled")+'"></div>'),this.settingsElement.find("#theme-name").on("change",this.paintPreview),this.settingsElement.find("#theme-name").on("input",this.onNameInputChanged.bind(this)),this.renderThemeOptions()},renderThemeOptions:function(){var e={model:this.theme,container:this.settingsElement,colors:SL.config.THEME_COLORS,fonts:SL.config.THEME_FONTS};"no-color"!==e.colors[e.colors.length-1].id&&e.colors.push({id:"no-color",tooltip:"Specifies as few color styles as possible, useful if you want to write custom CSS from the ground up."}),"no-font"!==e.fonts[e.fonts.length-1].id&&e.fonts.push({id:"no-font",title:"None",tooltip:"Specifies as few typographic styles as possible, useful if you want to write custom CSS from the ground up."}),this.themeoptions=new SL.components.ThemeOptions(e),this.themeoptions.changed.add(this.paintPreview)},renderCSS:function(){this.cssElement=$('<div class="page" data-page-id="css">').appendTo(this.pagesElement),this.cssElement.append('<div class="editor-wrapper"><div id="ace-less" class="editor"></div><div class="error"></div><div class="info" data-tooltip="'+SL.locale.get("THEME_CSS_DESCRIPTION")+'" data-tooltip-maxwidth="300" data-tooltip-align="left"><span class="icon i-info"></span></div></div>'),this.cssErrorElement=this.cssElement.find(".error");try{this.cssEditor=ace.edit("ace-less"),this.cssEditor.setTheme("ace/theme/monokai"),this.cssEditor.setDisplayIndentGuides(!0),this.cssEditor.setShowPrintMargin(!1),this.cssEditor.getSession().setMode("ace/mode/less"),this.cssEditor.env.document.setValue(this.theme.get("less")||""),this.cssEditor.env.editor.on("change",this.onCSSInputChanged.bind(this)),this.syncCSS()}catch(e){console.log("An error occurred while initializing the Ace CSS editor.")}},syncCSS:function(){var e,t=SL.util.string.getCustomClassesFromLESS(this.cssEditor.env.document.getValue());e=t.length?"Found custom slide classes:<br>- "+t.join("<br>- ")+"<br><br>"+SL.locale.get("THEME_CSS_DESCRIPTION"):SL.locale.get("THEME_CSS_DESCRIPTION"),this.cssElement.find(".info").toggleClass("positive",t.length>0),this.cssElement.find(".info").attr("data-tooltip",e)},renderHTML:function(){this.htmlElement=$('<div class="page" data-page-id="html">').appendTo(this.pagesElement),this.htmlElement.append('<div class="editor-wrapper"><div id="ace-html" class="editor"></div>','<div class="info" data-tooltip="'+SL.locale.get("THEME_HTML_DESCRIPTION")+'" data-tooltip-maxwidth="300" data-tooltip-align="left"><span class="icon i-info"></span></div></div>');try{this.htmlEditor=ace.edit("ace-html"),this.htmlEditor.setTheme("ace/theme/monokai"),this.htmlEditor.setDisplayIndentGuides(!0),this.htmlEditor.setShowPrintMargin(!1),this.htmlEditor.getSession().setMode("ace/mode/html"),this.htmlEditor.env.document.setValue(this.theme.get("html")||""),this.htmlEditor.env.editor.on("change",this.onHTMLInputChanged.bind(this))}catch(e){console.log("An error occurred while initializing the Ace HTML editor.")}},renderJS:function(){this.jsElement=$('<div class="page" data-page-id="js">').appendTo(this.pagesElement),this.jsElement.append('<div class="editor-wrapper"><div id="ace-js" class="editor"></div>','<div class="info" data-tooltip="'+SL.locale.get("THEME_JS_DESCRIPTION")+'" data-tooltip-maxwidth="300" data-tooltip-align="left"><span class="icon i-info"></span></div></div>');try{this.jsEditor=ace.edit("ace-js"),this.jsEditor.setTheme("ace/theme/monokai"),this.jsEditor.setDisplayIndentGuides(!0),this.jsEditor.setShowPrintMargin(!1),this.jsEditor.getSession().setMode("ace/mode/javascript"),this.jsEditor.env.document.setValue(this.theme.get("js")||""),this.jsEditor.env.editor.on("change",this.onJSInputChanged.bind(this))}catch(e){console.log("An error occurred while initializing the Ace JS editor.")}},renderSnippets:function(){this.snippets=new SL.views.themes.edit.pages.Snippets(this.editor,this.theme),this.snippets.appendTo(this.pagesElement),this.snippets.changed.add(this.checkUnsavedChanges.bind(this))},bind:function(){this.onDocumentKeyDown=this.onDocumentKeyDown.bind(this),$(document).on("keydown",this.onDocumentKeyDown)},showPage:function(e){this.domElement.find(".page").removeClass("past present future"),this.domElement.find('.page[data-page-id="'+e+'"]').addClass("present"),this.domElement.find('.page[data-page-id="'+e+'"]').prevAll().addClass("past"),this.domElement.find('.page[data-page-id="'+e+'"]').nextAll().addClass("future"),this.domElement.find(".panel-header .page-tab").removeClass("selected"),this.domElement.find('.panel-header .page-tab[data-page-id="'+e+'"]').addClass("selected"),"css"===e&&this.cssEditor?this.cssEditor.focus():"html"===e&&this.htmlEditor?this.htmlEditor.focus():"js"===e&&this.jsEditor&&this.jsEditor.focus(),setTimeout(function(){this.domElement.find(".page").addClass("transition")}.bind(this),1),this.resetScrollPosition()},resetScrollPosition:function(){this.domElement.scrollLeft(0).scrollTop(0),this.settingsElement.scrollLeft(0).scrollTop(0),$("body, html").scrollLeft(0).scrollTop(0)},updatePreview:function(e){"number"!=typeof e&&(e=250),clearTimeout(this.previewTimeout),this.previewTimeout=setTimeout(function(){this.paintPreview()}.bind(this),e)},paintPreview:function(){this.preprocess(function(){this.editor.refreshPreview(this.theme)}.bind(this),function(){this.editor.refreshPreview(this.theme)}.bind(this))},preprocess:function(e,t){this.theme.set("name",this.domElement.find("#theme-name").val()),this.cssEditor&&this.theme.set("less",this.cssEditor.env.document.getValue()),this.htmlEditor&&this.theme.set("html",this.htmlEditor.env.document.getValue()),this.jsEditor&&this.theme.set("js",this.jsEditor.env.document.getValue()),this.cssParser||(this.cssParser=new less.Parser);var n=this.cssEditor.env.document.getValue();n?this.cssParser.parse(".reveal { "+n+" }",function(i,s){if(i)this.cssErrorElement.addClass("visible"),this.cssErrorElement.html(i.message),SL.util.callback(t,i);else{this.cssErrorElement.removeClass("visible");try{var o=s.toCSS()}catch(a){console.log(a)}o?(this.theme.set("less",n),this.theme.set("css",o),SL.util.callback(e)):SL.util.callback(t)}this.checkUnsavedChanges()}.bind(this)):(this.theme.set("less",""),this.theme.set("css",""),SL.util.callback(e)),this.checkUnsavedChanges()},hasUnsavedChanges:function(){return this.savedJSON!==JSON.stringify(this.theme.toJSON())},checkUnsavedChanges:function(){this.domElement.toggleClass("has-unsaved-changes",this.hasUnsavedChanges())},save:function(e){var t=this.saveButton.data("ladda");t&&t.start(),this.preprocess(function(){this.savedJSON=JSON.stringify(this.theme.toJSON()),this.editor.saveTheme(this.theme,function(){t&&t.stop(),SL.util.callback(e)}.bind(this))}.bind(this),function(){SL.notify("Please fix all CSS errors before saving","negative"),t&&t.stop()}.bind(this))},close:function(e){this.hasUnsavedChanges()?SL.prompt({anchor:this.cancelButton,title:SL.locale.get("WARN_UNSAVED_CHANGES"),alignment:"b",type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Discard</h3>",className:"divider",callback:function(){this.destroy(),SL.util.callback(e)}.bind(this)},{html:"<h3>Save</h3>",className:"positive",selected:!0,callback:function(){SL.util.callback(e),this.save(this.destroy.bind(this))}.bind(this)}]}):(this.destroy(),SL.util.callback(e))},getTheme:function(){return this.theme},onCSSInputChanged:function(){this.syncCSS(),this.updatePreview()},onHTMLInputChanged:function(){this.updatePreview()},onJSInputChanged:function(){this.updatePreview(1e3)},onNameInputChanged:function(){this.theme.set("name",this.domElement.find("#theme-name").val()),this.checkUnsavedChanges()},onSaveClicked:function(){this.save()},onCancelClicked:function(){this.close()},onDocumentKeyDown:function(e){(e.metaKey||e.ctrlKey)&&83===e.keyCode&&(this.hasUnsavedChanges()&&this.save(),e.preventDefault())},destroy:function(){this.isDestroyed||(this.isDestroyed=!0,clearTimeout(this.previewTimeout),this.destroyed.dispatch(),this.destroyed.dispose(),$(document).off("keydown",this.onDocumentKeyDown),setTimeout(function(){this.cssEditor&&(this.cssEditor.destroy(),this.cssEditor=null),this.htmlEditor&&(this.htmlEditor.destroy(),this.htmlEditor=null),this.jsEditor&&(this.jsEditor.destroy(),this.jsEditor=null),this.snippets&&(this.snippets.destroy(),this.snippets=null),this.themeoptions.destroy(),this.domElement.remove()}.bind(this),500))}}),SL("views.themes").Preview=SL.views.Base.extend({init:function(){this._super(),SL.util.setupReveal({openLinksInTabs:!0}),window.parent!==window.self&&window.parent.postMessage({type:"theme-preview-ready"},window.location.origin)}}),SL("views.users").Show=SL.views.Base.extend({init:function(){this._super(),$(".decks li").each(function(e,t){t=$(t),t.on("click",this.onDeckClicked.bind(this,t)),t.find(".edit").on("click",this.onEditClicked.bind(this,t)),t.find(".share").on("click",this.onShareClicked.bind(this,t)),t.find(".fork").on("click",this.onForkClicked.bind(this,t)),t.find(".clone").on("click",this.onCloneClicked.bind(this,t)),t.find(".delete").on("click",this.onDeleteClicked.bind(this,t)),t.find(".lock-icon").on("click",this.onVisibilityClicked.bind(this,t)),t.find(".visibility").on("click",this.onVisibilityClicked.bind(this,t))}.bind(this)),$(".decks li .ladda-button").each(function(e,t){$(t).data("ladda",Ladda.create(t))})},getDeckData:function(e){return{user:SLConfig.current_user,id:e.attr("data-id"),slug:e.attr("data-slug"),title:e.attr("data-title"),access_token:e.attr("data-access_token"),visibility:e.attr("data-visibility")}},saveVisibility:function(e,t){var n=this.getDeckData(e),i={type:"POST",url:SL.config.AJAX_PUBLISH_DECK(n.id),context:this,data:{visibility:t}},s=e.find(".visibility").data("ladda");s&&s.start(),$.ajax(i).done(function(t){t.deck.visibility===SL.models.Deck.VISIBILITY_SELF?SL.notify(SL.locale.get("DECK_VISIBILITY_CHANGED_SELF")):t.deck.visibility===SL.models.Deck.VISIBILITY_TEAM?SL.notify(SL.locale.get("DECK_VISIBILITY_CHANGED_TEAM")):t.deck.visibility===SL.models.Deck.VISIBILITY_ALL&&SL.notify(SL.locale.get("DECK_VISIBILITY_CHANGED_ALL")),"string"==typeof t.deck.slug&&e.attr("data-slug",t.deck.slug),"string"==typeof t.deck.visibility&&e.attr("data-visibility",t.deck.visibility),s&&s.stop()}).fail(function(){SL.notify(SL.locale.get("DECK_VISIBILITY_CHANGED_ERROR"),"negative"),s&&s.stop()})},cloneDeck:function(e,t){var n=this.getDeckData(e),i=e.find(".clone.ladda-button").data("ladda");i&&i.start(),$.ajax({type:"POST",url:SL.config.AJAX_FORK_DECK(n.id),context:this}).done(function(){SL.util.callback(t)}).fail(function(){SL.notify(SL.locale.get("GENERIC_ERROR"),"negative"),i&&i.stop()})},onDeckClicked:function(e,t){var n=$(t.target).parents(".controls").length>0,i=$(t.target).hasClass("lock-icon"),s=$(t.target).closest(".details-item-link").length>0;n||i||s||(t.preventDefault(),window.location=e.find(">h2 a").attr("href"))},onEditClicked:function(e){window.location=e.attr("data-url")+"/edit"},onDeleteClicked:function(e,t){var n=this.getDeckData(e);SL.prompt({anchor:$(t.currentTarget),title:SL.locale.get("DECK_DELETE_CONFIRM",{title:n.title}),type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Delete</h3>",selected:!0,className:"negative",callback:function(){e.find(".details .status").text("Deleting...");var t=e.find(".delete.ladda-button").data("ladda");t&&t.start(),$.ajax({type:"DELETE",url:SL.config.AJAX_UPDATE_DECK(n.id),data:{},context:this}).done(function(){SL.util.anim.collapseListItem(e,function(){t&&t.stop(),e.remove()}.bind(this)),SL.notify(SL.locale.get("DECK_DELETE_SUCCESS"))}).fail(function(){SL.notify(SL.locale.get("DECK_DELETE_ERROR"),"negative"),t&&t.stop()})}.bind(this)}]}),SL.analytics.track("User.show: Delete clicked")},onVisibilityClicked:function(e,t){var n=this.getDeckData(e),i=[];i.push({html:SL.locale.get("DECK_VISIBILITY_CHANGE_SELF"),selected:n.visibility===SL.models.Deck.VISIBILITY_SELF,callback:function(){this.saveVisibility(e,SL.models.Deck.VISIBILITY_SELF),SL.analytics.track("User.show: Visibility click (SELF)")}.bind(this)}),SL.current_user.isEnterprise()&&i.push({html:SL.locale.get("DECK_VISIBILITY_CHANGE_TEAM"),selected:n.visibility===SL.models.Deck.VISIBILITY_TEAM,className:"divider",callback:function(){this.saveVisibility(e,SL.models.Deck.VISIBILITY_TEAM),SL.analytics.track("User.show: Visibility click (TEAM)")}.bind(this)}),i.push({html:SL.locale.get("DECK_VISIBILITY_CHANGE_ALL"),selected:n.visibility===SL.models.Deck.VISIBILITY_ALL,callback:function(){this.saveVisibility(e,SL.models.Deck.VISIBILITY_ALL),SL.analytics.track("User.show: Visibility click (ALL)")}.bind(this)}),SL.prompt({anchor:$(t.currentTarget),type:"select",data:i}),SL.analytics.track("User.show: Visibility menu opened ("+n.visibility+")")},onShareClicked:function(e){var t=this.getDeckData(e);return"string"!=typeof t.user.username||"string"!=typeof t.slug&&"string"!=typeof t.id?SL.notify(SL.locale.get("GENERIC_ERROR"),"negative"):SL.modal.open("share-deck",t),!1},onCloneClicked:function(e){return this.cloneDeck(e,function(){window.location.reload()}),!1},onForkClicked:function(e){return this.cloneDeck(e,function(){window.location=SL.current_user.getProfileURL()}),!1}});